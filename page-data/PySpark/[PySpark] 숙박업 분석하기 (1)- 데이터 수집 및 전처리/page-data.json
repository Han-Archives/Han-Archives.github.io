{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/",
    "result": {"data":{"cur":{"id":"16b04a9c-e9ed-5a95-9ff7-b55f23dd2013","html":"<h3 id=\"진행-과정\" style=\"position:relative;\"><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\" aria-label=\"진행 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>진행 과정</h3>\n<ol>\n<li>SparkSession 생성</li>\n<li>데이터 불러오기</li>\n</ol>\n<ul>\n<li>Union 하여 하나의 DataFrame으로 만들기</li>\n</ul>\n<ol start=\"3\">\n<li>Schema로 확인</li>\n<li>결측값 처리하기</li>\n<li>Parquet으로 저장하기</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h3 id=\"sparksession-생성\" style=\"position:relative;\"><a href=\"#sparksession-%EC%83%9D%EC%84%B1\" aria-label=\"sparksession 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkSession 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"데이터-불러오기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"데이터 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 불러오기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#파일 읽기</span>\nlodge_df1 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_01_P_관광숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df2 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_02_P_관광펜션업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_03_P_숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df4 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_04_P_외국인관광도시민박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df5 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_05_P_자동차야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df6 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_06_P_한옥체험업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df7 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_07_P_일반야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># printSchema()로 스키마 구조 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 개방서비스아이디: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 관리번호: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 인허가취소일자: integer (nullable = true)\n |-- 영업상태구분코드: integer (nullable = true)\n |-- 영업상태명: string (nullable = true)\n |-- 상세영업상태코드: double (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 휴업시작일자: integer (nullable = true)\n |-- 휴업종료일자: integer (nullable = true)\n |-- 재개업일자: string (nullable = true)\n |-- 소재지전화: string (nullable = true)\n |-- 소재지면적: string (nullable = true)\n |-- 소재지우편번호: integer (nullable = true)\n |-- 소재지전체주소: string (nullable = true)\n |-- 도로명전체주소: string (nullable = true)\n |-- 도로명우편번호: integer (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 최종수정시점: string (nullable = true)\n |-- 데이터갱신구분: string (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 업태구분명: string (nullable = true)\n |-- 좌표정보(x): double (nullable = true)\n |-- 좌표정보(y): double (nullable = true)\n |-- 문화체육업종명: string (nullable = true)\n |-- 문화사업자구분명: string (nullable = true)\n |-- 지역구분명: string (nullable = true)\n |-- 총층수: integer (nullable = true)\n |-- 주변환경명: string (nullable = true)\n |-- 제작취급품목내용: string (nullable = true)\n |-- 보험기관명: string (nullable = true)\n |-- 건물용도명: string (nullable = true)\n |-- 지상층수: integer (nullable = true)\n |-- 지하층수: integer (nullable = true)\n |-- 객실수: integer (nullable = true)\n |-- 건축연면적: integer (nullable = true)\n |-- 영문상호명: string (nullable = true)\n |-- 영문상호주소: string (nullable = true)\n |-- 선박총톤수: integer (nullable = true)\n |-- 선박척수: integer (nullable = true)\n |-- 선박제원: string (nullable = true)\n |-- 무대면적: integer (nullable = true)\n |-- 좌석수: integer (nullable = true)\n |-- 기념품종류: string (nullable = true)\n |-- 회의실별동시수용인원: integer (nullable = true)\n |-- 시설면적: double (nullable = true)\n |-- 놀이기구수내역: string (nullable = true)\n |-- 놀이시설수: integer (nullable = true)\n |-- 방송시설유무: string (nullable = true)\n |-- 발전시설유무: string (nullable = true)\n |-- 의무실유무: string (nullable = true)\n |-- 안내소유무: string (nullable = true)\n |-- 기획여행보험시작일자: string (nullable = true)\n |-- 기획여행보험종료일자: string (nullable = true)\n |-- 자본금: long (nullable = true)\n |-- 보험시작일자: integer (nullable = true)\n |-- 보험종료일자: integer (nullable = true)\n |-- 부대시설내역: string (nullable = true)\n |-- 시설규모: integer (nullable = true)\n |-- 관광숙박업상세명: string (nullable = true)\n |-- _c64: string (nullable = true)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># lodge_df 데이터 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|번호|개방서비스명|개방서비스아이디|개방자치단체코드|            관리번호|인허가일자|인허가취소일자|영업상태구분코드|영업상태명|상세영업상태코드|상세영업상태명|폐업일자|휴업시작일자|휴업종료일자|재개업일자|  소재지전화|소재지면적|소재지우편번호|                   소재지전체주소|                    도로명전체주소|도로명우편번호|                  사업장명|  최종수정시점|데이터갱신구분|      데이터갱신일자|업태구분명|     좌표정보(x)|   좌표정보(y)|문화체육업종명|문화사업자구분명|  지역구분명|총층수|주변환경명|제작취급품목내용|보험기관명|건물용도명|지상층수|지하층수|객실수|건축연면적|          영문상호명| 영문상호주소|선박총톤수|선박척수|선박제원|무대면적|좌석수|기념품종류|회의실별동시수용인원|시설면적|놀이기구수내역|놀이시설수|방송시설유무|발전시설유무|의무실유무|안내소유무|기획여행보험시작일자|기획여행보험종료일자|    자본금|보험시작일자|보험종료일자|부대시설내역|시설규모|관광숙박업상세명|_c64|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|   1|  관광숙박업|      03_11_01_P|         4530000|CDFI2260032018000001|  20180511|          null|               2|      휴업|             2.0|          휴업|    null|    20220101|    20221231|      null|041-666-8114|      null|          null|   충청남도 서산시 갈산동 181 ...|    충청남도 서산시 안견로 465,...|         31987|         베니키아호텔 서산|20220126112352|             U|2022-01-28 02:40:...|      null|   149762.965546| 364903.326481|    관광숙박업|            null|        null|  null|      null|            null|      null|      null|      13|       3|  null|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    null|      관광호텔업|null|\n|   2|  관광숙박업|      03_11_01_P|         3590000|CDFI2260031981000001|  19811129|          null|               2|      휴업|             2.0|          휴업|    null|    20210607|    20220606|      null|    228-8000|      null|        501835|      광주광역시 동구 지산동 20-8|    광주광역시 동구 지호로 214-...|          null|              신양파크호텔|20220121085653|             U|2022-01-23 02:40:...|      null|   194823.265738| 183819.247909|    관광숙박업|        관광사업|        null|     0|      null|            null|      null|      null|       0|       0|     0|         0|                null|         null|         0|       0|    null|       0|     0|      null|                   0|     0.0|          null|         0|        null|        null|      null|      null|                null|                null|         0|        null|        null|        null|       0|            null|null|\n|   3|  관광숙박업|      03_11_01_P|         3480000|CDFI2260032004000001|  20041015|          null|               2|      휴업|             2.0|          휴업|    null|    20210218|    20220217|      null|053-555-7221|      null|        711858|대구광역시 달성군 논공읍 하리 509|대구광역시 달성군 논공읍 약산덧...|        711856|   (주)파라다이스 온천호텔|20210305175930|             U|2021-03-07 02:40:...|      null|   328965.130661| 250161.463857|    관광숙박업|        관광사업|        null|     4|      null|            null|      null|      null|       3|       1|  null|      null|Yaksan Spa Touris...|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|2000000000|        null|        null|        null|    null|      관광호텔업|null|\n|   4|  관광숙박업|      03_11_01_P|         3410000|CDFI2260031989000001|  19890131|          null|               2|      휴업|             2.0|          휴업|    null|    20210701|    20220630|      null|053-252-2221|      null|        700112|    대구광역시 중구 태평로2가 1-9|    대구광역시 중구 태평로 117 ...|         41902|            유니온관광호텔|20210720154000|             U|2021-07-22 02:40:...|      null|   343594.783952| 265157.612523|    관광숙박업|        관광사업|중심상업지역|    13|      null|            null|      null|  숙박시설|      11|       2|    65|      null| Union Tourist Hotel|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null| 4231.63|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    4232|      관광호텔업|null|\n|   5|  관광숙박업|      03_11_01_P|         5250000|CDFI2260031983000001|  19830930|          null|               2|      휴업|             2.0|          휴업|    null|    20210401|    20220331|      null|        null|      null|        767841|경상북도 울진군 온정면 온정리 964|  경상북도 울진군 온정면 온천로 84|          null|에스이엔비(주)백암관광호텔|20210405183956|             U|2021-04-07 02:40:...|      null|408835.060132522|360261.2355428|    관광숙박업|        관광사업|일반상업지역|     8|      기타|            null|      null|      호텔|       7|       1|   127|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|12081.29|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|   12081|      관광호텔업|null|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\nonly showing top 5 rows</code></pre></div>\n<p>각 csv파일마다 컬럼 목록이 다르므로 csv파일마다 공통된 컬럼과 분석에 적합한 항목들을 선택한 뒤 진행</p>\n<p>번호|개방자치단체코드|사업자명|인허가일자|상세영업상태명|폐업일자|소재지면적|데이터갱신일자|건물지상층수|건물소유구분명|</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 위의 칼럼만 담은 새로운 DataFrame 생성 -- Select</span>\nlodge_df1 <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df2 <span class=\"token operator\">=</span> lodge_df2<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df4 <span class=\"token operator\">=</span> lodge_df4<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df5 <span class=\"token operator\">=</span> lodge_df5<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df6 <span class=\"token operator\">=</span> lodge_df6<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df7 <span class=\"token operator\">=</span> lodge_df7<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 칼럼명 변경 및 기존 칼럼 삭제</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"소재지면적\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"union-하여-하나의-dataframe으로-합치기\" style=\"position:relative;\"><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\" aria-label=\"union 하여 하나의 dataframe으로 합치기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Union 하여 하나의 DataFrame으로 합치기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># merge 하기</span>\nlodge <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df2<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df3<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df4<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df5<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df6<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df7<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|번호|개방서비스명|                        사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|      데이터갱신일자|시설면적|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|   1|  관광숙박업|               베니키아호텔 서산|         4530000|          휴업|  20180511|    null|2022-01-28 02:40:...|    null|\n|   2|  관광숙박업|                    신양파크호텔|         3590000|          휴업|  19811129|    null|2022-01-23 02:40:...|     0.0|\n|   3|  관광숙박업|         (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|    null|2021-03-07 02:40:...|    null|\n|   4|  관광숙박업|                  유니온관광호텔|         3410000|          휴업|  19890131|    null|2021-07-22 02:40:...| 4231.63|\n|   5|  관광숙박업|      에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|    null|2021-04-07 02:40:...|12081.29|\n|   6|  관광숙박업|            파크비지니스관광호텔|         5080000|          휴업|  20021230|    null|2021-11-24 02:40:...| 1029.11|\n|   7|  관광숙박업|                     호텔 비에스|         5080000|          휴업|  20140818|    null|2021-10-30 02:40:...| 4292.48|\n|   8|  관광숙박업|                (주)하일라리조트|         5180000|          휴업|  20061031|    null|2018-08-31 23:59:...|    null|\n|   9|  관광숙박업|(주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|    null|2021-04-23 02:40:...|    null|\n|  10|  관광숙박업|                그랜드 호텔 경주|         5050000|          휴업|  19880622|    null|2021-09-12 02:40:...|     0.0|\n|  11|  관광숙박업|                경주조선온천호텔|         5050000|          휴업|  20120815|    null|2021-11-13 02:40:...|14134.49|\n|  12|  관광숙박업|                  마린프라자(주)|         3580000|          휴업|  19980601|    null|2019-04-24 02:40:...| 11774.9|\n|  13|  관광숙박업|                    인썸관광호텔|         3580000|          휴업|  20171130|    null|2021-05-01 02:40:...|  1370.0|\n|  14|  관광숙박업|                    이츠관광호텔|         3490000|          휴업|  20031201|    null|2022-01-15 02:40:...| 2498.58|\n|  15|  관광숙박업|                인천비치관광호텔|         3490000|          휴업|  20070618|    null|2021-10-20 02:40:...|     0.0|\n|  16|  관광숙박업|   (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|    null|2019-12-04 02:40:...| 9316.17|\n|  17|  관광숙박업|(주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|    null|2021-05-26 02:40:...|23008.37|\n|  18|  관광숙박업|                  엠페러관광호텔|         3640000|          휴업|  19950104|    null|2018-08-31 23:59:...|  4405.9|\n|  19|  관광숙박업|                   올림포스 호텔|         3490000|          휴업|  19651203|    null|2021-07-11 02:40:...|21322.57|\n|  20|  관광숙박업|     (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|    null|2020-11-04 02:40:...| 12014.0|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"schema-확인하기\" style=\"position:relative;\"><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"schema 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Schema 확인하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 시설면적: string (nullable = true)</code></pre></div>\n<h3 id=\"결측치-처리하기\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"결측치 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결측치 처리하기</h3>\n<p>Null 값이 있는 칼럼은 아래와 같이 처리</p>\n<p>개방서비스명 - ‘숙박업’으로 대체 (제일 많은 비율을 차지)</p>\n<p>사업자명 - ‘알수없음’으로 대체</p>\n<p>개방자치단체코드 - ‘999’로 대체. 추후 알수없음으로 교체</p>\n<p>상세영업상태명 - ‘영업중’으로 대체</p>\n<p>인허가일자 - 데이터의 평균을 구한 뒤 근접한 날짜로 대체</p>\n<p>폐업일자 - 데이터 기준 날짜로 변경 (2022.03.11)</p>\n<p>시설면적 - ‘0’으로 대체. 추후 알수없음으로 교체</p>\n<p>갱신일자 - 데이터 기준 날짜로 대체 (2022-03)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 결측치 확인</span>\nlodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|데이터갱신일자|시설면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|   0|          28|      15|              38|            35|        33|   39666|            40|    3062|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>avg<span class=\"token punctuation\">(</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+--------------------+\n|     avg(인허가일자)|\n+--------------------+\n|1.9993372109428637E7|\n+--------------------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># na 값 위의 값으로 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'숙박업'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'알수없음'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"사업장명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방자치단체코드\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'영업중'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"상세영업상태명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">19991231</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">20220311</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"폐업일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 갱신일자</span>\nlodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 칼럼 삭제하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># na 값 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'2022-03'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>regexp_replace<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'[\\s,]'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|번호|개방서비스명|                          사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|    면적|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|   1|  관광숙박업|                 베니키아호텔 서산|         4530000|          휴업|  20180511|20220311| 2022-01|       0|\n|   2|  관광숙박업|                      신양파크호텔|         3590000|          휴업|  19811129|20220311| 2022-01|     0.0|\n|   3|  관광숙박업|           (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|20220311| 2021-03|       0|\n|   4|  관광숙박업|                    유니온관광호텔|         3410000|          휴업|  19890131|20220311| 2021-07| 4231.63|\n|   5|  관광숙박업|        에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|20220311| 2021-04|12081.29|\n|   6|  관광숙박업|              파크비지니스관광호텔|         5080000|          휴업|  20021230|20220311| 2021-11| 1029.11|\n|   7|  관광숙박업|                       호텔 비에스|         5080000|          휴업|  20140818|20220311| 2021-10| 4292.48|\n|   8|  관광숙박업|                  (주)하일라리조트|         5180000|          휴업|  20061031|20220311| 2018-08|       0|\n|   9|  관광숙박업|  (주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|20220311| 2021-04|       0|\n|  10|  관광숙박업|                  그랜드 호텔 경주|         5050000|          휴업|  19880622|20220311| 2021-09|     0.0|\n|  11|  관광숙박업|                  경주조선온천호텔|         5050000|          휴업|  20120815|20220311| 2021-11|14134.49|\n|  12|  관광숙박업|                    마린프라자(주)|         3580000|          휴업|  19980601|20220311| 2019-04| 11774.9|\n|  13|  관광숙박업|                      인썸관광호텔|         3580000|          휴업|  20171130|20220311| 2021-05|  1370.0|\n|  14|  관광숙박업|                      이츠관광호텔|         3490000|          휴업|  20031201|20220311| 2022-01| 2498.58|\n|  15|  관광숙박업|                  인천비치관광호텔|         3490000|          휴업|  20070618|20220311| 2021-10|     0.0|\n|  16|  관광숙박업|     (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|20220311| 2019-12| 9316.17|\n|  17|  관광숙박업|  (주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|20220311| 2021-05|23008.37|\n|  18|  관광숙박업|                    엠페러관광호텔|         3640000|          휴업|  19950104|20220311| 2018-08|  4405.9|\n|  19|  관광숙박업|                     올림포스 호텔|         3490000|          휴업|  19651203|20220311| 2021-07|21322.57|\n|  20|  관광숙박업|       (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|20220311| 2020-11| 12014.0|\n|  21|  관광숙박업|             째즈어라운드 관광호텔|         4640000|          휴업|  20120404|20220311| 2021-07| 2774.48|\n|  22|  관광숙박업|                군산리버힐관광호텔|         4670000|          휴업|  19961224|20220311| 2022-01|       0|\n|  23|  관광숙박업|                      폭스관광호텔|         4670000|          휴업|  20090730|20220311| 2021-06| 1836.24|\n|  24|  관광숙박업|                    오스카관광호텔|         4670000|          휴업|  20110407|20220311| 2021-12| 2961.87|\n|  25|  관광숙박업|              (주)무주덕유산리조트|         4740000|          휴업|  19970121|20220311| 2021-04|       0|\n|  26|  관광숙박업|                   예그리나 호스텔|         6510000|          휴업|  20140501|20220311| 2021-01| 1004.18|\n|  27|  관광숙박업|       더 쇼어 호텔 제주(The Sh...|         6520000|          휴업|  19850115|20220311| 2021-02|     0.0|\n|  28|  관광숙박업|                    CASALOMA HOTEL|         6520000|          휴업|  19860915|20220311| 2019-09|  7220.2|\n|  29|  관광숙박업|                            WE호텔|         6520000|          휴업|  19920325|20220311| 2019-04|       0|\n|  30|  관광숙박업|                       헤이 서귀포|         6520000|          휴업|  19921002|20220311| 2021-05| 12136.0|\n|  31|  관광숙박업|             주식회사 호텔크리스탈|         6520000|          휴업|  19920618|20220311| 2021-12| 3647.35|\n|  32|  관광숙박업|                서귀포월드컵리조트|         6520000|          휴업|  20101027|20220311| 2020-09| 8481.52|\n|  33|  관광숙박업|             휴식호텔 중문오션블루|         6520000|          휴업|  20160120|20220311| 2022-01| 1530.99|\n|  34|  관광숙박업|                          뜨레피아|         6520000|          휴업|  20130909|20220311| 2019-04| 1266.74|\n|  35|  관광숙박업|                          호텔화인|         6520000|          휴업|  20150611|20220311| 2022-01| 5268.63|\n|  36|  관광숙박업|                      엔파제주호텔|         6520000|          휴업|  20121106|20220311| 2021-01| 2984.95|\n|  37|  관광숙박업|                  제주세인트하우스|         6520000|          휴업|  20140227|20220311| 2020-11|     0.0|\n|  38|  관광숙박업|                  제주항공우주호텔|         6520000|          휴업|  20140328|20220311| 2021-08| 21359.0|\n|  39|  관광숙박업|                        양평리조트|         4170000|          휴업|  20030325|20220311| 2020-12|  2016.8|\n|  40|  관광숙박업|                  윈져캐슬관광호텔|         4050000|          휴업|  20080313|20220311| 2020-04|  423.47|\n|  41|  관광숙박업|                        루스톤호텔|         6510000|          휴업|  20140822|20220311| 2022-01| 3793.94|\n|  42|  관광숙박업|(주)이랜드파크 켄싱턴리조트 해운대|         3330000|          휴업|  19840801|20220311| 2022-02|       0|\n|  43|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020719|20220311| 2018-08|       0|\n|  44|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020720|20220311| 2018-08|       0|\n|  45|  관광숙박업|          동남해상관광호텔주식회사|         3330000|          휴업|  20020914|20220311| 2018-08|       0|\n|  46|  관광숙박업|                     보나트리 호텔|         3380000|          휴업|  20170616|20220311| 2022-01| 1496.07|\n|  47|  관광숙박업|                 호텔포레 부산역점|         3270000|          휴업|  20150205|20220311| 2022-02| 2581.86|\n|  48|  관광숙박업|                라스베가스관광호텔|         3340000|          휴업|  20010305|20220311| 2022-01|10627.57|\n|  49|  관광숙박업|                   인더스트리 호텔|         3330000|          휴업|  20140710|20220311| 2022-01|  1938.1|\n|  50|  관광숙박업|                사보이관광호텔(주)|         5670000|          휴업|  19901011|20220311| 2021-12|11856.78|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\nonly showing top 50 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|   0|           0|       0|               0|             0|         0|       0|       0|   0|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>toPandas<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nlodge_df<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;class 'pandas.core.frame.DataFrame'>\nRangeIndex: 67328 entries, 0 to 67327\nData columns (total 9 columns):\n #   Column    Non-Null Count  Dtype \n---  ------    --------------  ----- \n 0   번호        67328 non-null  object\n 1   개방서비스명    67328 non-null  object\n 2   사업장명      67328 non-null  object\n 3   개방자치단체코드  67328 non-null  int32 \n 4   상세영업상태명   67328 non-null  object\n 5   인허가일자     67328 non-null  int32 \n 6   폐업일자      67328 non-null  int32 \n 7   갱신일자      67328 non-null  object\n 8   면적        67328 non-null  object\ndtypes: int32(3), object(6)\nmemory usage: 3.9+ MB</code></pre></div>\n<h3 id=\"parquet으로-저장하기\" style=\"position:relative;\"><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"parquet으로 저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet으로 저장하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Parquet로 저장하기</span>\nlodge<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"에러-발생-시\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\" aria-label=\"에러 발생 시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>에러 발생 시</h3>\n<p>Hadoop이 설치가 안되있는 경우 아래와 같이 에러가 발생할 수 있습니다. 에러가 발생한 경우 아래 사이트대로 설치하여 문제 해결하시길 바랍니다.</p>\n<p><img src=\"/6bf868183caeb77f3ce5c55f85e4c12b/1.png\" alt=\"1.PNG\"></p>\n<p>Trouble Shooting</p>\n<p><a href=\"https://codedragon.tistory.com/9582\">https://codedragon.tistory.com/9582</a></p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html\">https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html</a></p>\n<p><a href=\"https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/\">https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\">진행 과정</a></li>\n<li><a href=\"#sparksession-%EC%83%9D%EC%84%B1\">SparkSession 생성</a></li>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">데이터 불러오기</a></li>\n<li><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\">Union 하여 하나의 DataFrame으로 합치기</a></li>\n<li><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">Schema 확인하기</a></li>\n<li><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">결측치 처리하기</a></li>\n<li><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">Parquet으로 저장하기</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\">에러 발생 시</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","excerpt":"진행 과정 SparkSession 생성 데이터 불러오기 Union 하여 하나의 DataFrame으로 만들기 Schema로 확인 결측값 처리하기 Parquet으로 저장하기 SparkSession 생성 데이터 불러오기 각 csv파일마다 컬럼 목록이 다르므로 csv파일마다 공통된 컬럼과 분석에 적합한 항목들을 선택한 뒤 진행 번호|개방자치단체코드|사업자명|인허가일자|상세영업상태명|폐업일자|소재지면적|데이터갱신일자|건물지상층수|건물소유구분명| Union 하여 하나의 DataFrame으로 합치기 Schema 확인하기 결측치 처리하기 Null 값이 있는 칼럼은 아래와 같이 처리 개방서비스명 - ‘숙박업’으로 대체 (제일 많은 비율을 차지) 사업자명 - ‘알수없음’으로 대체 개방자치단체코드 - ‘999’로 대체. 추후 알수없음으로 교체 상세영업상태명 - ‘영업중’으로 대체 인허가일자 - 데이터의 평균을 구한 뒤 근접한 날짜로 대체 폐업일자 - 데이터 기준 날짜로 변경 (2022.03.11) 시…","frontmatter":{"date":"April 20, 2022","title":"숙박업 분석하기 (1) - 데이터 수집 및 전처리","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/"}},"next":{"id":"a4f830e4-5329-527c-931f-59127371d16c","html":"<h2 id=\"datastudio-사용하기\" style=\"position:relative;\"><a href=\"#datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"datastudio 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataStudio 사용하기</h2>\n<p><img src=\"/7771d5baf4d2b56718481df6c544c61b/logo.png\" alt=\"logo.PNG\"></p>\n<h3 id=\"datastudio란\" style=\"position:relative;\"><a href=\"#datastudio%EB%9E%80\" aria-label=\"datastudio란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataStudio란?</h3>\n<p>구글에서 제공하는 시각화 도구로 양방향 대시보드와 데이터 시각화 보고서를 제작하는데 사용된다.</p>\n<ul>\n<li>특징</li>\n</ul>\n<ol>\n<li>무료</li>\n<li>쉬운 사용법</li>\n<li>여러가지 플랫폼과 연결이 쉬움 (다양한 방법으로 데이터소스 사용가능)</li>\n<li>복잡한 조건도 사용 가능</li>\n<li>데이터 양이 많아지는 경우 프로그램 속도가 느려짐</li>\n</ol>\n<h3 id=\"1-사이트-접속하기\" style=\"position:relative;\"><a href=\"#1-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\" aria-label=\"1 사이트 접속하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 사이트 접속하기</h3>\n<p>아래의 사이트를 통해 접속할 수 있으며 구글 계정을 로그인 하는 것으로 사용이 가능하다.</p>\n<p><a href=\"https://datastudio.google.com/\">https://datastudio.google.com/</a></p>\n<p><img src=\"/105bf8bb2ab67e9869a17c85a81e4ab0/2_1.png\" alt=\"2_1.PNG\"></p>\n<p>DataStudio는 위와 같이 다양한 형태의 보고서 형식을 제공하며 아래와 같이 다양한 플랫폼을 통해 데이터를 연결할 수 있다.</p>\n<p><img src=\"/254ef845e18903176f9abb108bf67f02/2_2.png\" alt=\"2_2.PNG\"></p>\n<h3 id=\"2-datastudio-살펴보기\" style=\"position:relative;\"><a href=\"#2-datastudio-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"2 datastudio 살펴보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DataStudio 살펴보기</h3>\n<p>DataStudio에서 제공하는 Sample 데이터의 구조를 파악한 뒤 보유하고 있는 데이터로 DataStudio를 사용하자.</p>\n<ul>\n<li>Sample 데이터 구조 확인하기 (World Population)</li>\n</ul>\n<p><img src=\"/a23b3baa7ed19383a826e94e9fd492db/3_3.png\" alt=\"3_3.PNG\"></p>\n<p>위와 같이 복잡하지 않은 구조의 데이터로 구성된 것을 알 수 있다.</p>\n<ul>\n<li>데이터 활용하기</li>\n</ul>\n<p>sample 데이터를 통해 대쉬보드 및 보고서를 제작할 수 있지만 직접 본인의 보유한 데이터를 사용해보는 것이 여러모로 DataStudio를 이해하는 데 도움이 된다. 이 과정에 사용될 데이터는 사람들이 이 블로그에 많이 방문한 GDP 관련한 데이터를 활용하여 진행하겠다.</p>\n<ul>\n<li>데</li>\n</ul>\n<h3 id=\"3-데이터-추출-및-전처리하기\" style=\"position:relative;\"><a href=\"#3-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%EC%A0%84%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"3 데이터 추출 및 전처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 데이터 추출 및 전처리하기</h3>\n<ul>\n<li>사용될 데이터</li>\n</ul>\n<p>이 과정에 사용될 데이터로 사람들이 이 블로그에 많이 방문한 GDP 데이터를 활용하여 진행하며 G7+Brics+한국등 총 13개 국가의 GDP를 1980,1990,2000,2011~2020년도의 변화를 대쉬보드를 통해 시각화하자.</p>\n<ul>\n<li>데이터 추출과정</li>\n</ul>\n<ol>\n<li>세계은행 데이터베이스에서 데이터 선택</li>\n</ol>\n<p><img src=\"/c7c5c1048e56f73964fcf32a271b5f84/1_1.png\" alt=\"1_1.PNG\"></p>\n<ol start=\"2\">\n<li>csv 파일상에서 전처리</li>\n</ol>\n<p>불필요한 칼럼 제거 및 달러 -> billion$로 값을 변환</p>\n<ol start=\"3\">\n<li>(2)에서 본 샘플 데이터 구조와 같이 변환</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Sample 데이터 구조로 데이터 변환</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\norigin_data <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'gdp_data.csv'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">origin_data</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Series Name</th>\n      <th>Country Name</th>\n      <th>Country Code</th>\n      <th>1980</th>\n      <th>1990</th>\n      <th>2000</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>GDP (current US billion$)</td>\n      <td>Canada</td>\n      <td>CAN</td>\n      <td>273.8540</td>\n      <td>593.930</td>\n      <td>744.773</td>\n      <td>1793.330</td>\n      <td>1828.370</td>\n      <td>1846.600</td>\n      <td>1805.750</td>\n      <td>1556.51</td>\n      <td>1527.990</td>\n      <td>1649.270</td>\n      <td>1725.330</td>\n      <td>1742.020</td>\n      <td>1645.420</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>GDP (current US billion$)</td>\n      <td>China</td>\n      <td>CHN</td>\n      <td>191.1490</td>\n      <td>360.858</td>\n      <td>1211.350</td>\n      <td>7551.500</td>\n      <td>8532.230</td>\n      <td>9570.410</td>\n      <td>10475.700</td>\n      <td>11061.60</td>\n      <td>11233.300</td>\n      <td>12310.400</td>\n      <td>13894.800</td>\n      <td>14279.900</td>\n      <td>14722.700</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>GDP (current US billion$)</td>\n      <td>France</td>\n      <td>FRA</td>\n      <td>701.2880</td>\n      <td>1269.180</td>\n      <td>1362.250</td>\n      <td>2861.410</td>\n      <td>2683.830</td>\n      <td>2811.080</td>\n      <td>2852.170</td>\n      <td>2438.21</td>\n      <td>2471.290</td>\n      <td>2588.740</td>\n      <td>2789.590</td>\n      <td>2728.870</td>\n      <td>2630.320</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>GDP (current US billion$)</td>\n      <td>Germany</td>\n      <td>DEU</td>\n      <td>950.2910</td>\n      <td>1771.670</td>\n      <td>1943.150</td>\n      <td>3744.410</td>\n      <td>3527.340</td>\n      <td>3732.740</td>\n      <td>3883.920</td>\n      <td>3356.24</td>\n      <td>3467.500</td>\n      <td>3681.730</td>\n      <td>3975.350</td>\n      <td>3888.330</td>\n      <td>3846.410</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>GDP (current US billion$)</td>\n      <td>Korea, Rep.</td>\n      <td>KOR</td>\n      <td>65.3986</td>\n      <td>283.368</td>\n      <td>576.178</td>\n      <td>1253.220</td>\n      <td>1278.430</td>\n      <td>1370.800</td>\n      <td>1484.320</td>\n      <td>1465.77</td>\n      <td>1500.110</td>\n      <td>1623.900</td>\n      <td>1724.850</td>\n      <td>1651.420</td>\n      <td>1637.900</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>GDP (current US billion$)</td>\n      <td>United States</td>\n      <td>USA</td>\n      <td>2857.3100</td>\n      <td>5963.140</td>\n      <td>10252.300</td>\n      <td>15542.600</td>\n      <td>16197.000</td>\n      <td>16784.800</td>\n      <td>17527.200</td>\n      <td>18238.30</td>\n      <td>18745.100</td>\n      <td>19543.000</td>\n      <td>20611.900</td>\n      <td>21433.200</td>\n      <td>20953.000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>GDP (current US billion$)</td>\n      <td>United Kingdom</td>\n      <td>GBR</td>\n      <td>564.9480</td>\n      <td>1093.170</td>\n      <td>1662.130</td>\n      <td>2674.890</td>\n      <td>2719.160</td>\n      <td>2803.290</td>\n      <td>3087.170</td>\n      <td>2956.57</td>\n      <td>2722.850</td>\n      <td>2699.020</td>\n      <td>2900.790</td>\n      <td>2878.670</td>\n      <td>2759.800</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>GDP (current US billion$)</td>\n      <td>Japan</td>\n      <td>JPN</td>\n      <td>1105.3900</td>\n      <td>3132.820</td>\n      <td>4968.360</td>\n      <td>6233.150</td>\n      <td>6272.360</td>\n      <td>5212.330</td>\n      <td>4896.990</td>\n      <td>4444.93</td>\n      <td>5003.680</td>\n      <td>4930.840</td>\n      <td>5036.890</td>\n      <td>5148.780</td>\n      <td>5057.760</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>GDP (current US billion$)</td>\n      <td>Italy</td>\n      <td>ITA</td>\n      <td>477.2570</td>\n      <td>1181.220</td>\n      <td>1143.830</td>\n      <td>2291.990</td>\n      <td>2087.080</td>\n      <td>2141.320</td>\n      <td>2159.130</td>\n      <td>1835.90</td>\n      <td>1875.800</td>\n      <td>1956.950</td>\n      <td>2090.910</td>\n      <td>2009.380</td>\n      <td>1888.710</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>GDP (current US billion$)</td>\n      <td>India</td>\n      <td>IND</td>\n      <td>186.3250</td>\n      <td>320.979</td>\n      <td>468.395</td>\n      <td>1823.050</td>\n      <td>1827.640</td>\n      <td>1856.720</td>\n      <td>2039.130</td>\n      <td>2103.59</td>\n      <td>2294.800</td>\n      <td>2651.470</td>\n      <td>2701.110</td>\n      <td>2870.500</td>\n      <td>2660.250</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>GDP (current US billion$)</td>\n      <td>Brazil</td>\n      <td>BRA</td>\n      <td>237.3930</td>\n      <td>390.726</td>\n      <td>655.448</td>\n      <td>2616.160</td>\n      <td>2465.230</td>\n      <td>2472.820</td>\n      <td>2456.040</td>\n      <td>1802.21</td>\n      <td>1795.690</td>\n      <td>2063.510</td>\n      <td>1916.930</td>\n      <td>1877.820</td>\n      <td>1444.730</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>GDP (current US billion$)</td>\n      <td>South Africa</td>\n      <td>ZAF</td>\n      <td>82.9805</td>\n      <td>115.552</td>\n      <td>151.753</td>\n      <td>458.202</td>\n      <td>434.401</td>\n      <td>400.886</td>\n      <td>381.199</td>\n      <td>346.71</td>\n      <td>323.586</td>\n      <td>381.449</td>\n      <td>404.842</td>\n      <td>387.935</td>\n      <td>335.442</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>GDP (current US billion$)</td>\n      <td>Russian Federation</td>\n      <td>RUS</td>\n      <td>0.0000</td>\n      <td>516.814</td>\n      <td>259.710</td>\n      <td>2045.930</td>\n      <td>2208.300</td>\n      <td>2292.470</td>\n      <td>2059.240</td>\n      <td>1363.48</td>\n      <td>1276.790</td>\n      <td>1574.200</td>\n      <td>1657.330</td>\n      <td>1687.450</td>\n      <td>1483.500</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">year_list <span class=\"token operator\">=</span> origin_data<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># melt 기능을 사용해 구조를 맞춤</span>\ndata<span class=\"token operator\">=</span> origin_data<span class=\"token punctuation\">.</span>melt<span class=\"token punctuation\">(</span>id_vars<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Country Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Country Code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> value_vars<span class=\"token operator\">=</span>year_list<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Nan 값 제거</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 칼럼 명 변경</span>\ndata<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Country'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Contry Code'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Year'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'GDP(billion$)'</span><span class=\"token punctuation\">]</span>\n\ndata</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Country</th>\n      <th>Contry Code</th>\n      <th>Year</th>\n      <th>GDP(billion$)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Canada</td>\n      <td>CAN</td>\n      <td>1980</td>\n      <td>273.8540</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>China</td>\n      <td>CHN</td>\n      <td>1980</td>\n      <td>191.1490</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>France</td>\n      <td>FRA</td>\n      <td>1980</td>\n      <td>701.2880</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Germany</td>\n      <td>DEU</td>\n      <td>1980</td>\n      <td>950.2910</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Korea, Rep.</td>\n      <td>KOR</td>\n      <td>1980</td>\n      <td>65.3986</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>164</th>\n      <td>Italy</td>\n      <td>ITA</td>\n      <td>2020</td>\n      <td>1888.7100</td>\n    </tr>\n    <tr>\n      <th>165</th>\n      <td>India</td>\n      <td>IND</td>\n      <td>2020</td>\n      <td>2660.2500</td>\n    </tr>\n    <tr>\n      <th>166</th>\n      <td>Brazil</td>\n      <td>BRA</td>\n      <td>2020</td>\n      <td>1444.7300</td>\n    </tr>\n    <tr>\n      <th>167</th>\n      <td>South Africa</td>\n      <td>ZAF</td>\n      <td>2020</td>\n      <td>335.4420</td>\n    </tr>\n    <tr>\n      <th>168</th>\n      <td>Russian Federation</td>\n      <td>RUS</td>\n      <td>2020</td>\n      <td>1483.5000</td>\n    </tr>\n  </tbody>\n</table>\n<p>169 rows × 4 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 변환된 데이터 저장</span>\ndata<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"gdp_data.csv\"</span><span class=\"token punctuation\">,</span>header<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"4-datastudio-사용하기\" style=\"position:relative;\"><a href=\"#4-datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"4 datastudio 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. DataStudio 사용하기</h3>\n<p>DataStudio 접속 -> 데이터 연결 -> 파일 업로드 선택 후 아래와 같이 변환된 데이터를 input한다.</p>\n<p><img src=\"/f5540cbcde75b8af73699d74aa023875/2_3.png\" alt=\"2_3.PNG\"></p>\n<p><img src=\"/1e2cc2975c4862d2dbf61c2c85f33dcd/2_4.png\" alt=\"2_4.PNG\"></p>\n<p>그 뒤 추가버튼을 누르면 된다.</p>\n<p>DataStudio에서는 아래와 같이 다양한 차트를 제공한다.</p>\n<p><img src=\"/77d892b76b04328ac7ded7025c0abb83/3_4.png\" alt=\"3_4.PNG\"></p>\n<p>각 차트를 사용할때 데이터 소스, 측정기준, 측정항목을 선택하여 원하는 형태로 차트 제작이 가능하다.</p>\n<p>몇몇 차트 (ex) 구글 지도 차트)를 사용하려면 데이터 유형을 변경해야 사용 가능하다.</p>\n<p>변경 방법은 리소스 -> 추가된 데이터 소스 관리를 누른 후 아래의 그림과 같이 수정버튼을 클릭한 뒤 직접 데이터 유형을 변경할 수 있다.</p>\n<p><img src=\"/d3190be4adb83ea9734b80167c56fc84/3_5.png\" alt=\"3_5.PNG\"></p>\n<p><img src=\"/e8b3ea034a23b92a5ab0ea93a3bbca62/3_2.png\" alt=\"3_2.PNG\"></p>\n<h3 id=\"5-보고서-제작하기\" style=\"position:relative;\"><a href=\"#5-%EB%B3%B4%EA%B3%A0%EC%84%9C-%EC%A0%9C%EC%9E%91%ED%95%98%EA%B8%B0\" aria-label=\"5 보고서 제작하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 보고서 제작하기</h3>\n<p>다양한 차트를 사용하여 아래와 같이 시각화된 보고서를 제작할 수 있다.</p>\n<p><img src=\"/3122de0961480cf61f83df35fbf5504f/5_1.png\" alt=\"5_1.PNG\"></p>\n<p>조건에 맞게 검색하는 기능도 있어 원하는 항목에 그 조건에 맞는 데이터도 파악할 수 있다.</p>\n<p><img src=\"/7be7d2bccee43648941becea3dcd3e3d/5_2.png\" alt=\"5_2.PNG\"></p>\n<p><img src=\"/0cef0cacf5733a84e4e447d0eed3c397/5_3.png\" alt=\"5_3.PNG\"></p>\n<h3 id=\"저장하기\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>저장하기</h3>\n<p>보고서가 완성되면 공유버튼을 통해 저장, 공유 등이 가능하며 링크 버튼을 이용하면 직접 대시보드의 검색 기능을 사용하여 검색 조건에 맞는 데이터를 보일 수 있다. 아래와 같이 공유 링크를 남기더라도 지정된 특정 사용자만 링크에 접속해 볼 수 있다.</p>\n<p><img src=\"/84f2f8d533d72da84f3b13a8630523f3/5_4.png\" alt=\"5_4.PNG\"></p>\n<p><a href=\"https://datastudio.google.com/s/iUfBcwkr0z4\">https://datastudio.google.com/s/iUfBcwkr0z4</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">DataStudio 사용하기</a></p>\n<ul>\n<li><a href=\"#datastudio%EB%9E%80\">DataStudio란?</a></li>\n<li><a href=\"#1-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\">1. 사이트 접속하기</a></li>\n<li><a href=\"#2-datastudio-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\">2. DataStudio 살펴보기</a></li>\n<li><a href=\"#3-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%EC%A0%84%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">3. 데이터 추출 및 전처리하기</a></li>\n<li><a href=\"#4-datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">4. DataStudio 사용하기</a></li>\n<li><a href=\"#5-%EB%B3%B4%EA%B3%A0%EC%84%9C-%EC%A0%9C%EC%9E%91%ED%95%98%EA%B8%B0\">5. 보고서 제작하기</a></li>\n<li><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">저장하기</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"March 01, 2022","title":"DataStudio 사용하기","categories":"Analysis_Tools","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/DataStudio/DataStudio 사용하기/"}},"prev":{"id":"e0151f47-d704-5b50-b1e8-ba698656e3a4","html":"<p>아래의 과정에 대한 자세한 내용은 아래의 사이트를 참조 바랍니다.</p>\n<p><a href=\"https://han-depository.tistory.com/47\">https://han-depository.tistory.com/47</a></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd</code></pre></div>\n<h3 id=\"postgresql-접속-정보\" style=\"position:relative;\"><a href=\"#postgresql-%EC%A0%91%EC%86%8D-%EC%A0%95%EB%B3%B4\" aria-label=\"postgresql 접속 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PostgreSQL 접속 정보</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># localhost</span>\nip <span class=\"token operator\">=</span> <span class=\"token string\">\"127.0.0.1\"</span>\n<span class=\"token comment\"># port</span>\nport <span class=\"token operator\">=</span> <span class=\"token number\">5432</span> \n<span class=\"token comment\"># username</span>\nuser <span class=\"token operator\">=</span> <span class=\"token string\">\"ID\"</span>\n<span class=\"token comment\"># password</span>\npasswd <span class=\"token operator\">=</span> <span class=\"token string\">\"비밀번호\"</span>\n<span class=\"token comment\"># database</span>\ndb <span class=\"token operator\">=</span> <span class=\"token string\">\"dvdrental\"</span></code></pre></div>\n<h3 id=\"sparksession-연동하기\" style=\"position:relative;\"><a href=\"#sparksession-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\" aria-label=\"sparksession 연동하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkSession 연동하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"db-속-table-호출하기\" style=\"position:relative;\"><a href=\"#db-%EC%86%8D-table-%ED%98%B8%EC%B6%9C%ED%95%98%EA%B8%B0\" aria-label=\"db 속 table 호출하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DB 속 table 호출하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SQL query 작성</span>\nsql <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"\nselect * from actor\n\"\"\"</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc\"</span><span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jdbc:postgresql://{0}:{1}/{2}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span> ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> db <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"driver\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.postgresql.Driver\"</span><span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"query\"</span><span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> passwd<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/7b62caf89ca6fe9f92c55d07bcdf37a7/2.png\" alt=\"2.PNG\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor<span class=\"token punctuation\">.</span>createOrReplaceTempView<span class=\"token punctuation\">(</span> <span class=\"token string\">\"dvdrental_actor\"</span> <span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SQL 쿼리 작성</span>\nspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">(</span> <span class=\"token triple-quoted-string string\">\"\"\"\n    select *\n    from dvdrental_actor\n    limit 5\n\"\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/16e87c093a5b383bfbb64bb68ada4ca4/3.png\" alt=\"3.PNG\"></p>\n<h3 id=\"parquet-불러오기\" style=\"position:relative;\"><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"parquet 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet 불러오기</h3>\n<p>숙박업 분석 과정에서 저장된 parquet을 호출하여 PostgreSQL에 저장하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/1e4a632c3ce0ede2d32fa3dae12c8f51/4.png\" alt=\"4.PNG\"></p>\n<h3 id=\"db에-table-업로드하기\" style=\"position:relative;\"><a href=\"#db%EC%97%90-table-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0\" aria-label=\"db에 table 업로드하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DB에 table 업로드하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># JDBC 소스로 데이터 저장하기</span>\nlodge<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jdbc:postgresql://{0}:{1}/{2}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span> ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> db <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"driver\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.postgresql.Driver\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"dbtable\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lodge\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> passwd<span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/d5fb0cc248ee113cdbeec8a8ef20a00d/5.png\" alt=\"5.PNG\"></p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://urame.tistory.com/entry/Spark-PostgreSQL-%EC%97%B0%EB%8F%99-%EB%B0%A9%EB%B2%95-jdbc-spark-sql\">https://urame.tistory.com/entry/Spark-PostgreSQL-%EC%97%B0%EB%8F%99-%EB%B0%A9%EB%B2%95-jdbc-spark-sql</a></p>\n<p><a href=\"https://spark-korea.github.io/docs/sql-data-sources-jdbc.html\">https://spark-korea.github.io/docs/sql-data-sources-jdbc.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#postgresql-%EC%A0%91%EC%86%8D-%EC%A0%95%EB%B3%B4\">PostgreSQL 접속 정보</a></li>\n<li><a href=\"#sparksession-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\">SparkSession 연동하기</a></li>\n<li><a href=\"#db-%EC%86%8D-table-%ED%98%B8%EC%B6%9C%ED%95%98%EA%B8%B0\">DB 속 table 호출하기</a></li>\n<li><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">Parquet 불러오기</a></li>\n<li><a href=\"#db%EC%97%90-table-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0\">DB에 table 업로드하기</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 21, 2022","title":"PostgreSQL 연동하기","categories":"Anaylsis_tools","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/PostgreSQL과 연동하기/"}},"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/","nextSlug":"/DataStudio/DataStudio 사용하기/","prevSlug":"/PySpark/PostgreSQL과 연동하기/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}