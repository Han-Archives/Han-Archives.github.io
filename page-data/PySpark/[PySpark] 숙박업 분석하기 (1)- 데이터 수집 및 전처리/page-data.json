{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/",
    "result": {"data":{"cur":{"id":"16b04a9c-e9ed-5a95-9ff7-b55f23dd2013","html":"<h3 id=\"진행-과정\" style=\"position:relative;\"><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\" aria-label=\"진행 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>진행 과정</h3>\n<ol>\n<li>SparkSession 생성</li>\n<li>데이터 불러오기</li>\n</ol>\n<ul>\n<li>Union 하여 하나의 DataFrame으로 만들기</li>\n</ul>\n<ol start=\"3\">\n<li>Schema로 확인</li>\n<li>결측값 처리하기</li>\n<li>Parquet으로 저장하기</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h3 id=\"sparksession-생성\" style=\"position:relative;\"><a href=\"#sparksession-%EC%83%9D%EC%84%B1\" aria-label=\"sparksession 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkSession 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"데이터-불러오기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"데이터 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 불러오기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#파일 읽기</span>\nlodge_df1 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_01_P_관광숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df2 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_02_P_관광펜션업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_03_P_숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df4 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_04_P_외국인관광도시민박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df5 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_05_P_자동차야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df6 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_06_P_한옥체험업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df7 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_07_P_일반야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># printSchema()로 스키마 구조 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 개방서비스아이디: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 관리번호: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 인허가취소일자: integer (nullable = true)\n |-- 영업상태구분코드: integer (nullable = true)\n |-- 영업상태명: string (nullable = true)\n |-- 상세영업상태코드: double (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 휴업시작일자: integer (nullable = true)\n |-- 휴업종료일자: integer (nullable = true)\n |-- 재개업일자: string (nullable = true)\n |-- 소재지전화: string (nullable = true)\n |-- 소재지면적: string (nullable = true)\n |-- 소재지우편번호: integer (nullable = true)\n |-- 소재지전체주소: string (nullable = true)\n |-- 도로명전체주소: string (nullable = true)\n |-- 도로명우편번호: integer (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 최종수정시점: string (nullable = true)\n |-- 데이터갱신구분: string (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 업태구분명: string (nullable = true)\n |-- 좌표정보(x): double (nullable = true)\n |-- 좌표정보(y): double (nullable = true)\n |-- 문화체육업종명: string (nullable = true)\n |-- 문화사업자구분명: string (nullable = true)\n |-- 지역구분명: string (nullable = true)\n |-- 총층수: integer (nullable = true)\n |-- 주변환경명: string (nullable = true)\n |-- 제작취급품목내용: string (nullable = true)\n |-- 보험기관명: string (nullable = true)\n |-- 건물용도명: string (nullable = true)\n |-- 지상층수: integer (nullable = true)\n |-- 지하층수: integer (nullable = true)\n |-- 객실수: integer (nullable = true)\n |-- 건축연면적: integer (nullable = true)\n |-- 영문상호명: string (nullable = true)\n |-- 영문상호주소: string (nullable = true)\n |-- 선박총톤수: integer (nullable = true)\n |-- 선박척수: integer (nullable = true)\n |-- 선박제원: string (nullable = true)\n |-- 무대면적: integer (nullable = true)\n |-- 좌석수: integer (nullable = true)\n |-- 기념품종류: string (nullable = true)\n |-- 회의실별동시수용인원: integer (nullable = true)\n |-- 시설면적: double (nullable = true)\n |-- 놀이기구수내역: string (nullable = true)\n |-- 놀이시설수: integer (nullable = true)\n |-- 방송시설유무: string (nullable = true)\n |-- 발전시설유무: string (nullable = true)\n |-- 의무실유무: string (nullable = true)\n |-- 안내소유무: string (nullable = true)\n |-- 기획여행보험시작일자: string (nullable = true)\n |-- 기획여행보험종료일자: string (nullable = true)\n |-- 자본금: long (nullable = true)\n |-- 보험시작일자: integer (nullable = true)\n |-- 보험종료일자: integer (nullable = true)\n |-- 부대시설내역: string (nullable = true)\n |-- 시설규모: integer (nullable = true)\n |-- 관광숙박업상세명: string (nullable = true)\n |-- _c64: string (nullable = true)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># lodge_df 데이터 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|번호|개방서비스명|개방서비스아이디|개방자치단체코드|            관리번호|인허가일자|인허가취소일자|영업상태구분코드|영업상태명|상세영업상태코드|상세영업상태명|폐업일자|휴업시작일자|휴업종료일자|재개업일자|  소재지전화|소재지면적|소재지우편번호|                   소재지전체주소|                    도로명전체주소|도로명우편번호|                  사업장명|  최종수정시점|데이터갱신구분|      데이터갱신일자|업태구분명|     좌표정보(x)|   좌표정보(y)|문화체육업종명|문화사업자구분명|  지역구분명|총층수|주변환경명|제작취급품목내용|보험기관명|건물용도명|지상층수|지하층수|객실수|건축연면적|          영문상호명| 영문상호주소|선박총톤수|선박척수|선박제원|무대면적|좌석수|기념품종류|회의실별동시수용인원|시설면적|놀이기구수내역|놀이시설수|방송시설유무|발전시설유무|의무실유무|안내소유무|기획여행보험시작일자|기획여행보험종료일자|    자본금|보험시작일자|보험종료일자|부대시설내역|시설규모|관광숙박업상세명|_c64|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|   1|  관광숙박업|      03_11_01_P|         4530000|CDFI2260032018000001|  20180511|          null|               2|      휴업|             2.0|          휴업|    null|    20220101|    20221231|      null|041-666-8114|      null|          null|   충청남도 서산시 갈산동 181 ...|    충청남도 서산시 안견로 465,...|         31987|         베니키아호텔 서산|20220126112352|             U|2022-01-28 02:40:...|      null|   149762.965546| 364903.326481|    관광숙박업|            null|        null|  null|      null|            null|      null|      null|      13|       3|  null|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    null|      관광호텔업|null|\n|   2|  관광숙박업|      03_11_01_P|         3590000|CDFI2260031981000001|  19811129|          null|               2|      휴업|             2.0|          휴업|    null|    20210607|    20220606|      null|    228-8000|      null|        501835|      광주광역시 동구 지산동 20-8|    광주광역시 동구 지호로 214-...|          null|              신양파크호텔|20220121085653|             U|2022-01-23 02:40:...|      null|   194823.265738| 183819.247909|    관광숙박업|        관광사업|        null|     0|      null|            null|      null|      null|       0|       0|     0|         0|                null|         null|         0|       0|    null|       0|     0|      null|                   0|     0.0|          null|         0|        null|        null|      null|      null|                null|                null|         0|        null|        null|        null|       0|            null|null|\n|   3|  관광숙박업|      03_11_01_P|         3480000|CDFI2260032004000001|  20041015|          null|               2|      휴업|             2.0|          휴업|    null|    20210218|    20220217|      null|053-555-7221|      null|        711858|대구광역시 달성군 논공읍 하리 509|대구광역시 달성군 논공읍 약산덧...|        711856|   (주)파라다이스 온천호텔|20210305175930|             U|2021-03-07 02:40:...|      null|   328965.130661| 250161.463857|    관광숙박업|        관광사업|        null|     4|      null|            null|      null|      null|       3|       1|  null|      null|Yaksan Spa Touris...|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|2000000000|        null|        null|        null|    null|      관광호텔업|null|\n|   4|  관광숙박업|      03_11_01_P|         3410000|CDFI2260031989000001|  19890131|          null|               2|      휴업|             2.0|          휴업|    null|    20210701|    20220630|      null|053-252-2221|      null|        700112|    대구광역시 중구 태평로2가 1-9|    대구광역시 중구 태평로 117 ...|         41902|            유니온관광호텔|20210720154000|             U|2021-07-22 02:40:...|      null|   343594.783952| 265157.612523|    관광숙박업|        관광사업|중심상업지역|    13|      null|            null|      null|  숙박시설|      11|       2|    65|      null| Union Tourist Hotel|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null| 4231.63|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    4232|      관광호텔업|null|\n|   5|  관광숙박업|      03_11_01_P|         5250000|CDFI2260031983000001|  19830930|          null|               2|      휴업|             2.0|          휴업|    null|    20210401|    20220331|      null|        null|      null|        767841|경상북도 울진군 온정면 온정리 964|  경상북도 울진군 온정면 온천로 84|          null|에스이엔비(주)백암관광호텔|20210405183956|             U|2021-04-07 02:40:...|      null|408835.060132522|360261.2355428|    관광숙박업|        관광사업|일반상업지역|     8|      기타|            null|      null|      호텔|       7|       1|   127|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|12081.29|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|   12081|      관광호텔업|null|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\nonly showing top 5 rows</code></pre></div>\n<p>각 csv파일마다 컬럼 목록이 다르므로 csv파일마다 공통된 컬럼과 분석에 적합한 항목들을 선택한 뒤 진행</p>\n<p>번호|개방자치단체코드|사업자명|인허가일자|상세영업상태명|폐업일자|소재지면적|데이터갱신일자|건물지상층수|건물소유구분명|</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 위의 칼럼만 담은 새로운 DataFrame 생성 -- Select</span>\nlodge_df1 <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df2 <span class=\"token operator\">=</span> lodge_df2<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df4 <span class=\"token operator\">=</span> lodge_df4<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df5 <span class=\"token operator\">=</span> lodge_df5<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df6 <span class=\"token operator\">=</span> lodge_df6<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df7 <span class=\"token operator\">=</span> lodge_df7<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 칼럼명 변경 및 기존 칼럼 삭제</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"소재지면적\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"union-하여-하나의-dataframe으로-합치기\" style=\"position:relative;\"><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\" aria-label=\"union 하여 하나의 dataframe으로 합치기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Union 하여 하나의 DataFrame으로 합치기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># merge 하기</span>\nlodge <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df2<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df3<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df4<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df5<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df6<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df7<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|번호|개방서비스명|                        사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|      데이터갱신일자|시설면적|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|   1|  관광숙박업|               베니키아호텔 서산|         4530000|          휴업|  20180511|    null|2022-01-28 02:40:...|    null|\n|   2|  관광숙박업|                    신양파크호텔|         3590000|          휴업|  19811129|    null|2022-01-23 02:40:...|     0.0|\n|   3|  관광숙박업|         (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|    null|2021-03-07 02:40:...|    null|\n|   4|  관광숙박업|                  유니온관광호텔|         3410000|          휴업|  19890131|    null|2021-07-22 02:40:...| 4231.63|\n|   5|  관광숙박업|      에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|    null|2021-04-07 02:40:...|12081.29|\n|   6|  관광숙박업|            파크비지니스관광호텔|         5080000|          휴업|  20021230|    null|2021-11-24 02:40:...| 1029.11|\n|   7|  관광숙박업|                     호텔 비에스|         5080000|          휴업|  20140818|    null|2021-10-30 02:40:...| 4292.48|\n|   8|  관광숙박업|                (주)하일라리조트|         5180000|          휴업|  20061031|    null|2018-08-31 23:59:...|    null|\n|   9|  관광숙박업|(주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|    null|2021-04-23 02:40:...|    null|\n|  10|  관광숙박업|                그랜드 호텔 경주|         5050000|          휴업|  19880622|    null|2021-09-12 02:40:...|     0.0|\n|  11|  관광숙박업|                경주조선온천호텔|         5050000|          휴업|  20120815|    null|2021-11-13 02:40:...|14134.49|\n|  12|  관광숙박업|                  마린프라자(주)|         3580000|          휴업|  19980601|    null|2019-04-24 02:40:...| 11774.9|\n|  13|  관광숙박업|                    인썸관광호텔|         3580000|          휴업|  20171130|    null|2021-05-01 02:40:...|  1370.0|\n|  14|  관광숙박업|                    이츠관광호텔|         3490000|          휴업|  20031201|    null|2022-01-15 02:40:...| 2498.58|\n|  15|  관광숙박업|                인천비치관광호텔|         3490000|          휴업|  20070618|    null|2021-10-20 02:40:...|     0.0|\n|  16|  관광숙박업|   (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|    null|2019-12-04 02:40:...| 9316.17|\n|  17|  관광숙박업|(주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|    null|2021-05-26 02:40:...|23008.37|\n|  18|  관광숙박업|                  엠페러관광호텔|         3640000|          휴업|  19950104|    null|2018-08-31 23:59:...|  4405.9|\n|  19|  관광숙박업|                   올림포스 호텔|         3490000|          휴업|  19651203|    null|2021-07-11 02:40:...|21322.57|\n|  20|  관광숙박업|     (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|    null|2020-11-04 02:40:...| 12014.0|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"schema-확인하기\" style=\"position:relative;\"><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"schema 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Schema 확인하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 시설면적: string (nullable = true)</code></pre></div>\n<h3 id=\"결측치-처리하기\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"결측치 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결측치 처리하기</h3>\n<p>Null 값이 있는 칼럼은 아래와 같이 처리</p>\n<p>개방서비스명 - ‘숙박업’으로 대체 (제일 많은 비율을 차지)</p>\n<p>사업자명 - ‘알수없음’으로 대체</p>\n<p>개방자치단체코드 - ‘999’로 대체. 추후 알수없음으로 교체</p>\n<p>상세영업상태명 - ‘영업중’으로 대체</p>\n<p>인허가일자 - 데이터의 평균을 구한 뒤 근접한 날짜로 대체</p>\n<p>폐업일자 - 데이터 기준 날짜로 변경 (2022.03.11)</p>\n<p>시설면적 - ‘0’으로 대체. 추후 알수없음으로 교체</p>\n<p>갱신일자 - 데이터 기준 날짜로 대체 (2022-03)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 결측치 확인</span>\nlodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|데이터갱신일자|시설면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|   0|          28|      15|              38|            35|        33|   39666|            40|    3062|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>avg<span class=\"token punctuation\">(</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+--------------------+\n|     avg(인허가일자)|\n+--------------------+\n|1.9993372109428637E7|\n+--------------------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># na 값 위의 값으로 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'숙박업'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'알수없음'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"사업장명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방자치단체코드\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'영업중'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"상세영업상태명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">19991231</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">20220311</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"폐업일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 갱신일자</span>\nlodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 칼럼 삭제하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># na 값 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'2022-03'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>regexp_replace<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'[\\s,]'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|번호|개방서비스명|                          사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|    면적|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|   1|  관광숙박업|                 베니키아호텔 서산|         4530000|          휴업|  20180511|20220311| 2022-01|       0|\n|   2|  관광숙박업|                      신양파크호텔|         3590000|          휴업|  19811129|20220311| 2022-01|     0.0|\n|   3|  관광숙박업|           (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|20220311| 2021-03|       0|\n|   4|  관광숙박업|                    유니온관광호텔|         3410000|          휴업|  19890131|20220311| 2021-07| 4231.63|\n|   5|  관광숙박업|        에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|20220311| 2021-04|12081.29|\n|   6|  관광숙박업|              파크비지니스관광호텔|         5080000|          휴업|  20021230|20220311| 2021-11| 1029.11|\n|   7|  관광숙박업|                       호텔 비에스|         5080000|          휴업|  20140818|20220311| 2021-10| 4292.48|\n|   8|  관광숙박업|                  (주)하일라리조트|         5180000|          휴업|  20061031|20220311| 2018-08|       0|\n|   9|  관광숙박업|  (주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|20220311| 2021-04|       0|\n|  10|  관광숙박업|                  그랜드 호텔 경주|         5050000|          휴업|  19880622|20220311| 2021-09|     0.0|\n|  11|  관광숙박업|                  경주조선온천호텔|         5050000|          휴업|  20120815|20220311| 2021-11|14134.49|\n|  12|  관광숙박업|                    마린프라자(주)|         3580000|          휴업|  19980601|20220311| 2019-04| 11774.9|\n|  13|  관광숙박업|                      인썸관광호텔|         3580000|          휴업|  20171130|20220311| 2021-05|  1370.0|\n|  14|  관광숙박업|                      이츠관광호텔|         3490000|          휴업|  20031201|20220311| 2022-01| 2498.58|\n|  15|  관광숙박업|                  인천비치관광호텔|         3490000|          휴업|  20070618|20220311| 2021-10|     0.0|\n|  16|  관광숙박업|     (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|20220311| 2019-12| 9316.17|\n|  17|  관광숙박업|  (주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|20220311| 2021-05|23008.37|\n|  18|  관광숙박업|                    엠페러관광호텔|         3640000|          휴업|  19950104|20220311| 2018-08|  4405.9|\n|  19|  관광숙박업|                     올림포스 호텔|         3490000|          휴업|  19651203|20220311| 2021-07|21322.57|\n|  20|  관광숙박업|       (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|20220311| 2020-11| 12014.0|\n|  21|  관광숙박업|             째즈어라운드 관광호텔|         4640000|          휴업|  20120404|20220311| 2021-07| 2774.48|\n|  22|  관광숙박업|                군산리버힐관광호텔|         4670000|          휴업|  19961224|20220311| 2022-01|       0|\n|  23|  관광숙박업|                      폭스관광호텔|         4670000|          휴업|  20090730|20220311| 2021-06| 1836.24|\n|  24|  관광숙박업|                    오스카관광호텔|         4670000|          휴업|  20110407|20220311| 2021-12| 2961.87|\n|  25|  관광숙박업|              (주)무주덕유산리조트|         4740000|          휴업|  19970121|20220311| 2021-04|       0|\n|  26|  관광숙박업|                   예그리나 호스텔|         6510000|          휴업|  20140501|20220311| 2021-01| 1004.18|\n|  27|  관광숙박업|       더 쇼어 호텔 제주(The Sh...|         6520000|          휴업|  19850115|20220311| 2021-02|     0.0|\n|  28|  관광숙박업|                    CASALOMA HOTEL|         6520000|          휴업|  19860915|20220311| 2019-09|  7220.2|\n|  29|  관광숙박업|                            WE호텔|         6520000|          휴업|  19920325|20220311| 2019-04|       0|\n|  30|  관광숙박업|                       헤이 서귀포|         6520000|          휴업|  19921002|20220311| 2021-05| 12136.0|\n|  31|  관광숙박업|             주식회사 호텔크리스탈|         6520000|          휴업|  19920618|20220311| 2021-12| 3647.35|\n|  32|  관광숙박업|                서귀포월드컵리조트|         6520000|          휴업|  20101027|20220311| 2020-09| 8481.52|\n|  33|  관광숙박업|             휴식호텔 중문오션블루|         6520000|          휴업|  20160120|20220311| 2022-01| 1530.99|\n|  34|  관광숙박업|                          뜨레피아|         6520000|          휴업|  20130909|20220311| 2019-04| 1266.74|\n|  35|  관광숙박업|                          호텔화인|         6520000|          휴업|  20150611|20220311| 2022-01| 5268.63|\n|  36|  관광숙박업|                      엔파제주호텔|         6520000|          휴업|  20121106|20220311| 2021-01| 2984.95|\n|  37|  관광숙박업|                  제주세인트하우스|         6520000|          휴업|  20140227|20220311| 2020-11|     0.0|\n|  38|  관광숙박업|                  제주항공우주호텔|         6520000|          휴업|  20140328|20220311| 2021-08| 21359.0|\n|  39|  관광숙박업|                        양평리조트|         4170000|          휴업|  20030325|20220311| 2020-12|  2016.8|\n|  40|  관광숙박업|                  윈져캐슬관광호텔|         4050000|          휴업|  20080313|20220311| 2020-04|  423.47|\n|  41|  관광숙박업|                        루스톤호텔|         6510000|          휴업|  20140822|20220311| 2022-01| 3793.94|\n|  42|  관광숙박업|(주)이랜드파크 켄싱턴리조트 해운대|         3330000|          휴업|  19840801|20220311| 2022-02|       0|\n|  43|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020719|20220311| 2018-08|       0|\n|  44|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020720|20220311| 2018-08|       0|\n|  45|  관광숙박업|          동남해상관광호텔주식회사|         3330000|          휴업|  20020914|20220311| 2018-08|       0|\n|  46|  관광숙박업|                     보나트리 호텔|         3380000|          휴업|  20170616|20220311| 2022-01| 1496.07|\n|  47|  관광숙박업|                 호텔포레 부산역점|         3270000|          휴업|  20150205|20220311| 2022-02| 2581.86|\n|  48|  관광숙박업|                라스베가스관광호텔|         3340000|          휴업|  20010305|20220311| 2022-01|10627.57|\n|  49|  관광숙박업|                   인더스트리 호텔|         3330000|          휴업|  20140710|20220311| 2022-01|  1938.1|\n|  50|  관광숙박업|                사보이관광호텔(주)|         5670000|          휴업|  19901011|20220311| 2021-12|11856.78|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\nonly showing top 50 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|   0|           0|       0|               0|             0|         0|       0|       0|   0|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>toPandas<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nlodge_df<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;class 'pandas.core.frame.DataFrame'>\nRangeIndex: 67328 entries, 0 to 67327\nData columns (total 9 columns):\n #   Column    Non-Null Count  Dtype \n---  ------    --------------  ----- \n 0   번호        67328 non-null  object\n 1   개방서비스명    67328 non-null  object\n 2   사업장명      67328 non-null  object\n 3   개방자치단체코드  67328 non-null  int32 \n 4   상세영업상태명   67328 non-null  object\n 5   인허가일자     67328 non-null  int32 \n 6   폐업일자      67328 non-null  int32 \n 7   갱신일자      67328 non-null  object\n 8   면적        67328 non-null  object\ndtypes: int32(3), object(6)\nmemory usage: 3.9+ MB</code></pre></div>\n<h3 id=\"parquet으로-저장하기\" style=\"position:relative;\"><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"parquet으로 저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet으로 저장하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Parquet로 저장하기</span>\nlodge<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"에러-발생-시\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\" aria-label=\"에러 발생 시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>에러 발생 시</h3>\n<p>Hadoop이 설치가 안되있는 경우 아래와 같이 에러가 발생할 수 있습니다. 에러가 발생한 경우 아래 사이트대로 설치하여 문제 해결하시길 바랍니다.</p>\n<p><img src=\"6_14.png\" alt=\"png\"></p>\n<p>Trouble Shooting</p>\n<p><a href=\"https://codedragon.tistory.com/9582\">https://codedragon.tistory.com/9582</a></p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html\">https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html</a></p>\n<p><a href=\"https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/\">https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/</a></p>\n<p>Trouble Shooting</p>\n<p><a href=\"https://codedragon.tistory.com/9582\">https://codedragon.tistory.com/9582</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\">진행 과정</a></li>\n<li><a href=\"#sparksession-%EC%83%9D%EC%84%B1\">SparkSession 생성</a></li>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">데이터 불러오기</a></li>\n<li><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\">Union 하여 하나의 DataFrame으로 합치기</a></li>\n<li><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">Schema 확인하기</a></li>\n<li><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">결측치 처리하기</a></li>\n<li><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">Parquet으로 저장하기</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\">에러 발생 시</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","excerpt":"진행 과정 SparkSession 생성 데이터 불러오기 Union 하여 하나의 DataFrame으로 만들기 Schema로 확인 결측값 처리하기 Parquet으로 저장하기 SparkSession 생성 데이터 불러오기 각 csv파일마다 컬럼 목록이 다르므로 csv파일마다 공통된 컬럼과 분석에 적합한 항목들을 선택한 뒤 진행 번호|개방자치단체코드|사업자명|인허가일자|상세영업상태명|폐업일자|소재지면적|데이터갱신일자|건물지상층수|건물소유구분명| Union 하여 하나의 DataFrame으로 합치기 Schema 확인하기 결측치 처리하기 Null 값이 있는 칼럼은 아래와 같이 처리 개방서비스명 - ‘숙박업’으로 대체 (제일 많은 비율을 차지) 사업자명 - ‘알수없음’으로 대체 개방자치단체코드 - ‘999’로 대체. 추후 알수없음으로 교체 상세영업상태명 - ‘영업중’으로 대체 인허가일자 - 데이터의 평균을 구한 뒤 근접한 날짜로 대체 폐업일자 - 데이터 기준 날짜로 변경 (2022.03.11) 시…","frontmatter":{"date":"April 21, 2022","title":"숙박업 분석하기 (1) - 데이터 수집 및 전처리","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/"}},"next":{"id":"e47b0147-862b-5b04-8e95-af2e4574f2d1","html":"<p>이번 장에서는 전 장에서 진행한 자료를 가지고 Pyspark의 ML 라이브러리를 활용하여 폐업 가능확률을 알아보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> font_manager<span class=\"token punctuation\">,</span>rc\n<span class=\"token keyword\">import</span> matplotlib\n\nfont_path <span class=\"token operator\">=</span> <span class=\"token string\">'C:\\\\Windows\\\\Fonts\\\\gulim.ttc'</span>\n\n<span class=\"token comment\">#폰트 이름 얻어오기</span>\nfont_name <span class=\"token operator\">=</span> font_manager<span class=\"token punctuation\">.</span>FontProperties<span class=\"token punctuation\">(</span>fname<span class=\"token operator\">=</span>font_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#font 설정</span>\nmatplotlib<span class=\"token punctuation\">.</span>rc<span class=\"token punctuation\">(</span><span class=\"token string\">'font'</span><span class=\"token punctuation\">,</span>family<span class=\"token operator\">=</span>font_name<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge_analysis.csv\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n      <th>start_year</th>\n      <th>end_year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n      <td>1978</td>\n      <td>2003</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n      <td>1980</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n      <td>1970</td>\n      <td>1999</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n      <td>2012</td>\n      <td>2017</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n      <td>2003</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>제주시</td>\n      <td>폐업</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n      <td>2016</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>구례군</td>\n      <td>폐업</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n      <td>2020</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>태안군</td>\n      <td>폐업</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n      <td>2016</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>완도군</td>\n      <td>폐업</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n      <td>2019</td>\n      <td>2019</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>인제군</td>\n      <td>폐업</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n      <td>2016</td>\n      <td>2020</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 12 columns</p>\n</div>\n<h3 id=\"변수-선택-및-변환\" style=\"position:relative;\"><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\" aria-label=\"변수 선택 및 변환 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>변수 선택 및 변환</h3>\n<ol>\n<li>불필요한 칼럼 제외 (번호, 사업장명, start_year, end_year)</li>\n<li>날짜형으로 데이터 변환</li>\n<li>Label Encoding</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">## 과정 2 진행 중 date 범위 오류값 수정</span>\n<span class=\"token comment\"># 인허가일자</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19750229</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19750228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19940431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19940430</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19840431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19840430</span>\n\n<span class=\"token comment\"># 폐업일자</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020231</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20140000</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20140101</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000300</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000301</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020400</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020401</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19990900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19990901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\n\ndata <span class=\"token operator\">=</span> lodge\n\n<span class=\"token comment\"># 불필요한 칼럼 제외</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#-------- 날짜형으로 데이터 변환 ------------</span>\n<span class=\"token comment\"># 약간 지저분한 방식으로 날짜형 데이터로 전환</span>\n<span class=\"token comment\"># 1. int-> str 변환</span>\n<span class=\"token comment\"># 2. str.slice 함수 사용하여 년도,월,일로 나눔</span>\n<span class=\"token comment\"># 3. 나눠진 칼럼을 to_datetime으로 날짜형데이터로 변환</span>\n<span class=\"token comment\"># 1~3 과정에서 발생한 임시 칼럼 삭제</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">make_datetime</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'str'</span><span class=\"token punctuation\">)</span>\n    temp <span class=\"token operator\">=</span> df\n    temp <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    \n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span>\n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    \n    df<span class=\"token punctuation\">[</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ndata</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1978-07-31</td>\n      <td>2003-03-31</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1980-02-20</td>\n      <td>2007-12-18</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1970-08-11</td>\n      <td>1999-01-23</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>2012-06-25</td>\n      <td>2017-12-14</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>2003-01-16</td>\n      <td>2016-01-25</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>자동차야영장업</td>\n      <td>제주시</td>\n      <td>폐업</td>\n      <td>2016-03-08</td>\n      <td>2022-03-11</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>자동차야영장업</td>\n      <td>구례군</td>\n      <td>폐업</td>\n      <td>2020-09-09</td>\n      <td>2022-03-11</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>자동차야영장업</td>\n      <td>태안군</td>\n      <td>폐업</td>\n      <td>2016-06-24</td>\n      <td>2016-10-18</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>자동차야영장업</td>\n      <td>완도군</td>\n      <td>폐업</td>\n      <td>2019-07-22</td>\n      <td>2019-08-26</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>자동차야영장업</td>\n      <td>인제군</td>\n      <td>폐업</td>\n      <td>2016-06-02</td>\n      <td>2020-05-07</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 본격적인 머신러닝을 하기 위해 0으로 지정한 값(null)을 중간값으로 값을 대체</span>\n\n<span class=\"token comment\">#data['운영기간'][data['운영기간'] ==0] = 17</span>\n\n<span class=\"token comment\">#data['면적'][data['면적'] == 0 ] = 335</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>65176</th>\n      <td>한옥체험업</td>\n      <td>강진군</td>\n      <td>영업</td>\n      <td>2013-11-30</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>117.41</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65177</th>\n      <td>한옥체험업</td>\n      <td>경주시</td>\n      <td>영업</td>\n      <td>2019-07-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>65178</th>\n      <td>한옥체험업</td>\n      <td>서울특별시</td>\n      <td>영업</td>\n      <td>2021-07-05</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>65180</th>\n      <td>한옥체험업</td>\n      <td>강진군</td>\n      <td>영업</td>\n      <td>2013-12-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>95.58</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65053</th>\n      <td>한옥체험업</td>\n      <td>전주시</td>\n      <td>영업</td>\n      <td>2013-11-06</td>\n      <td>2022-03-11</td>\n      <td>2021-11</td>\n      <td>335.00</td>\n      <td>9.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>61838</th>\n      <td>General Campground</td>\n      <td>0</td>\n      <td>영업</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>59790</th>\n      <td>Resort Condominium</td>\n      <td>0</td>\n      <td>영업</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>60027</th>\n      <td>Resort Condominium</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>57840</th>\n      <td>TOURIST HOTEL</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>60575</th>\n      <td>Tourist Accommodation Business</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64112</th>\n      <td>Traditional Korean</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64879</th>\n      <td>Traditional Korean housing experiencing business</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>58137</th>\n      <td>관광숙박업</td>\n      <td>평창군</td>\n      <td>폐업</td>\n      <td>1997-03-14</td>\n      <td>2006-08-31</td>\n      <td>2018-08</td>\n      <td>0.00</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>59038</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2016-09-27</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>218.85</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59039</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2016-12-30</td>\n      <td>2022-03-11</td>\n      <td>2021-10</td>\n      <td>624.75</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59042</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-03-15</td>\n      <td>2022-03-11</td>\n      <td>2021-08</td>\n      <td>225.16</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59041</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-02-03</td>\n      <td>2022-03-11</td>\n      <td>2020-02</td>\n      <td>313.04</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59043</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-03-31</td>\n      <td>2022-03-11</td>\n      <td>2022-01</td>\n      <td>1382.35</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59044</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-06-01</td>\n      <td>2022-03-11</td>\n      <td>2019-02</td>\n      <td>169.63</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59045</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-07-03</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>246.27</td>\n      <td>5.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'PySpark ML for Loging Industry'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|   면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  관광숙박업|부산광역시|          영업|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|  면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+------+--------+\n|      숙박업|서울특별시|          폐업|1948-08-15|1967-07-10| 2018-08| 335.0|    19.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-07-07| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2015-12-03| 2018-08| 148.5|    67.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-02-01| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1975-09-18| 2018-08| 335.0|    27.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1972-07-31| 2018-08| 335.0|    24.0|\n|      숙박업|서울특별시|          영업|1948-08-15|2022-03-11| 2019-12|144.93|    74.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2000-06-15| 2018-08| 335.0|    52.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-05-17| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          영업|1948-08-15|2022-03-11| 2018-10| 907.0|    74.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1948-08-15| 2018-08| 335.0|     0.0|\n|      숙박업|서울특별시|          폐업|1949-07-05|2006-03-27| 2018-08| 165.0|    57.0|\n|      숙박업|인천광역시|          폐업|1952-04-13|2018-08-28| 2018-10| 335.0|    66.0|\n|      숙박업|    경주시|          폐업|1954-01-31|1991-07-05| 2018-08|500.96|    37.0|\n|      숙박업|    영광군|          폐업|1954-02-08|2006-10-18| 2018-08|  88.0|    52.0|\n|      숙박업|    해남군|          폐업|1955-01-20|2002-05-02| 2018-08| 335.0|    47.0|\n|      숙박업|    창원시|          폐업|1955-06-14|1999-03-02| 2021-07|166.77|    44.0|\n|      숙박업|    경주시|          영업|1957-04-19|2022-03-11| 2021-02| 335.0|    65.0|\n|      숙박업|    창원시|          폐업|1958-04-28|2018-01-24| 2021-07| 63.46|    60.0|\n|      숙박업|    창원시|          영업|1958-05-19|2022-03-11| 2021-07| 74.04|    64.0|\n+------------+----------+--------------+----------+----------+--------+------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|   면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  관광숙박업|부산광역시|          영업|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  관광숙박업|부산광역시|          영업|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"범주형-변수-처리하기\" style=\"position:relative;\"><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"범주형 변수 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>범주형 변수 처리하기</h3>\n<p>아래는 총 3가지 과정으로 진행</p>\n<ol>\n<li>StringIndexer</li>\n</ol>\n<p>범주형 변수를 인덱싱하여 0.0 , 1.0, 2.0 과 같은 번호로 인덱싱</p>\n<ol start=\"2\">\n<li>OneHotEncoder</li>\n</ol>\n<p>인덱싱한 값은 0,1,2 와 같이 값으로써 크기를 가지기 때문에 OneHotEncoder를 사용하여 값의 크기를 갖지 않도록 변환</p>\n<ol start=\"3\">\n<li>VectorAssembler</li>\n</ol>\n<p>인코딩한 값을 벡터로 모으기</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml <span class=\"token keyword\">import</span> Pipeline\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>feature <span class=\"token keyword\">import</span> StringIndexer<span class=\"token punctuation\">,</span> OneHotEncoder<span class=\"token punctuation\">,</span> VectorAssembler\n\n<span class=\"token comment\"># 갱신일자, 인허가일자, 폐업일자를 제외하고 다시 진행</span>\ncategory_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'갱신일자'</span><span class=\"token punctuation\">]</span>\nnumeric_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># label</span>\nlabel_idx <span class=\"token operator\">=</span> StringIndexer<span class=\"token punctuation\">(</span>inputCol <span class=\"token operator\">=</span> <span class=\"token string\">\"상세영업상태명\"</span><span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 범주형 변수들을 인덱싱</span>\nindexers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    StringIndexer<span class=\"token punctuation\">(</span>inputCol<span class=\"token operator\">=</span>c<span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_indexed\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> category_cols\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 인덱싱한 변수들을 인코딩</span>\nencoders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>OneHotEncoder<span class=\"token punctuation\">(</span>dropLast<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>inputCol<span class=\"token operator\">=</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_encoded\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    <span class=\"token keyword\">for</span> indexer <span class=\"token keyword\">in</span> indexers\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 인코딩 된 값과 숫자 변수 값을 벡터화</span>\n<span class=\"token comment\"># -- encoder와 numeric cols 의 결합 리스트 관련 지식 부족(Array로 안됨)</span>\n\nassembler <span class=\"token operator\">=</span> VectorAssembler<span class=\"token punctuation\">(</span>inputCols<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'개방서비스명_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'지역_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'인허가일자_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'폐업일자_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'갱신일자_indexed_encoded'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"features\"</span><span class=\"token punctuation\">)</span>\n\npipeline <span class=\"token operator\">=</span> Pipeline<span class=\"token punctuation\">(</span>stages<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>label_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> indexers  <span class=\"token operator\">+</span> encoders<span class=\"token operator\">+</span><span class=\"token punctuation\">[</span>assembler<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token operator\">=</span>pipeline<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|  면적|운영기간|label|개방서비스명_indexed|지역_indexed|인허가일자_indexed|폐업일자_indexed|갱신일자_indexed|개방서비스명_indexed_encoded|지역_indexed_encoded|인허가일자_indexed_encoded|폐업일자_indexed_encoded|갱신일자_indexed_encoded|            features|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|   0.0|     9.0|  1.0|                 2.0|        55.0|            1373.0|           244.0|             0.0|               (7,[2],[1.0])|    (163,[55],[1.0])|      (14963,[1373],[1.0])|      (6606,[244],[1.0])|          (44,[0],[1.0])|(21785,[2,62,1543...|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12|218.85|     6.0|  0.0|                 2.0|         1.0|             887.0|             0.0|            23.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[887],[1.0])|        (6606,[0],[1.0])|         (44,[23],[1.0])|(21785,[2,8,1057,...|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10|624.75|     6.0|  0.0|                 2.0|         1.0|             686.0|             0.0|             7.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[686],[1.0])|        (6606,[0],[1.0])|          (44,[7],[1.0])|(21785,[2,8,856,1...|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08|225.16|     5.0|  0.0|                 2.0|         1.0|            5201.0|             0.0|             4.0|               (7,[2],[1.0])|     (163,[1],[1.0])|      (14963,[5201],[1.0])|        (6606,[0],[1.0])|          (44,[4],[1.0])|(21785,[2,8,5371,...|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02|313.04|     5.0|  0.0|                 2.0|         1.0|             536.0|             0.0|            20.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[536],[1.0])|        (6606,[0],[1.0])|         (44,[20],[1.0])|(21785,[2,8,706,1...|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\nonly showing top 5 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df <span class=\"token operator\">=</span> transformed<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>regression <span class=\"token keyword\">import</span> LinearRegression\n\nlr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>LinearRegression<span class=\"token punctuation\">(</span>featuresCol<span class=\"token operator\">=</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">\"label\"</span><span class=\"token punctuation\">,</span> predictionCol<span class=\"token operator\">=</span><span class=\"token string\">'predlabel'</span><span class=\"token punctuation\">,</span> \n                               maxIter<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> regParam<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> elasticNetParam<span class=\"token operator\">=</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span> standardization<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  1.0|(21785,[2,62,1543...|\n|  0.0|(21785,[2,8,1057,...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,5371,...|\n|  0.0|(21785,[2,8,706,1...|\n|  0.0|(21785,[2,8,563,1...|\n|  0.0|(21785,[2,8,712,1...|\n|  0.0|(21785,[2,8,2325,...|\n|  0.0|(21785,[2,8,415,1...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,7123,...|\n|  0.0|(21785,[2,8,2337,...|\n|  0.0|(21785,[2,8,1336,...|\n|  0.0|(21785,[2,8,688,1...|\n|  0.0|(21785,[2,8,1376,...|\n|  0.0|(21785,[2,8,1073,...|\n|  0.0|(21785,[2,8,9370,...|\n|  0.0|(21785,[2,8,1335,...|\n|  0.0|(21785,[2,8,299,1...|\n|  0.0|(21785,[2,8,321,1...|\n+-----+--------------------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">,</span> test_data <span class=\"token operator\">=</span> trans_df<span class=\"token punctuation\">.</span>randomSplit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> seed<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">.</span>columns</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">['label', 'features']</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Fit the data to the model</span>\nlinearModel <span class=\"token operator\">=</span> lr<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions <span class=\"token operator\">=</span> linearModel<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels <span class=\"token operator\">=</span> predictions<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-------------------+-----+\n|          predlabel|label|\n+-------------------+-----+\n| 0.4786779491779273|  0.0|\n|0.47812190795718557|  0.0|\n| 0.4763438691699301|  0.0|\n|0.46373595776939147|  0.0|\n| 0.4621842148277867|  0.0|\n|  0.461957918982136|  0.0|\n|0.46163463920263503|  0.0|\n| 0.4564621627306192|  0.0|\n| 0.4530677250458588|  0.0|\n| 0.4522595255971063|  0.0|\n|0.45080476658935187|  0.0|\n| 0.4472567710093285|  0.0|\n|0.39633212374343496|  0.0|\n| 0.3614890291088182|  0.0|\n| 0.4700399134696608|  0.0|\n| 0.4727877915954192|  0.0|\n|0.46379414812970166|  0.0|\n|0.45904840096662713|  0.0|\n|0.44309292744935574|  0.0|\n| 0.3900524140266282|  0.0|\n+-------------------+-----+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"평가\" style=\"position:relative;\"><a href=\"#%ED%8F%89%EA%B0%80\" aria-label=\"평가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>평가</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>evaluation <span class=\"token keyword\">import</span> RegressionEvaluator\n\n<span class=\"token comment\"># Get the RMSE</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>rootMeanSquaredError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>meanAbsoluteError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Get the R2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>r2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5022262338134558\nMAE: 0.4878241107468986\nR2: 0.012063243903345677</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'rmse'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5017870515976061</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'mae'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">MAE: 0.4873217827313394</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'r2'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">R2: 0.010070756230703637</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">spark<span class=\"token punctuation\">.</span>stop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners\">https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners</a></p>\n<p><a href=\"https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html\">https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html</a></p>\n<p><a href=\"https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0\">https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0</a></p>\n<p><a href=\"https://spark.apache.org/docs/latest/ml-classification-regression.html\">https://spark.apache.org/docs/latest/ml-classification-regression.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\">변수 선택 및 변환</a></li>\n<li><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">범주형 변수 처리하기</a></li>\n<li><a href=\"#%ED%8F%89%EA%B0%80\">평가</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 21, 2022","title":"숙박업 분석하기 (3) - MLlib","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (3) - MLlib/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/","nextSlug":"/PySpark/[PySpark] 숙박업 분석하기 (3) - MLlib/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}