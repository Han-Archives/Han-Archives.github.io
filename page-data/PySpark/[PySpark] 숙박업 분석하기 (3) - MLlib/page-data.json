{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/PySpark/[PySpark] 숙박업 분석하기 (3) - MLlib/",
    "result": {"data":{"cur":{"id":"e47b0147-862b-5b04-8e95-af2e4574f2d1","html":"<p>이번 장에서는 전 장에서 진행한 자료를 가지고 Pyspark의 ML 라이브러리를 활용하여 폐업 가능확률을 알아보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> font_manager<span class=\"token punctuation\">,</span>rc\n<span class=\"token keyword\">import</span> matplotlib\n\nfont_path <span class=\"token operator\">=</span> <span class=\"token string\">'C:\\\\Windows\\\\Fonts\\\\gulim.ttc'</span>\n\n<span class=\"token comment\">#폰트 이름 얻어오기</span>\nfont_name <span class=\"token operator\">=</span> font_manager<span class=\"token punctuation\">.</span>FontProperties<span class=\"token punctuation\">(</span>fname<span class=\"token operator\">=</span>font_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#font 설정</span>\nmatplotlib<span class=\"token punctuation\">.</span>rc<span class=\"token punctuation\">(</span><span class=\"token string\">'font'</span><span class=\"token punctuation\">,</span>family<span class=\"token operator\">=</span>font_name<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge_analysis.csv\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n      <th>start_year</th>\n      <th>end_year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n      <td>1978</td>\n      <td>2003</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n      <td>1980</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n      <td>1970</td>\n      <td>1999</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n      <td>2012</td>\n      <td>2017</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n      <td>2003</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>제주시</td>\n      <td>폐업</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n      <td>2016</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>구례군</td>\n      <td>폐업</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n      <td>2020</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>태안군</td>\n      <td>폐업</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n      <td>2016</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>완도군</td>\n      <td>폐업</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n      <td>2019</td>\n      <td>2019</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>인제군</td>\n      <td>폐업</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n      <td>2016</td>\n      <td>2020</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 12 columns</p>\n</div>\n<h3 id=\"변수-선택-및-변환\" style=\"position:relative;\"><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\" aria-label=\"변수 선택 및 변환 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>변수 선택 및 변환</h3>\n<ol>\n<li>불필요한 칼럼 제외 (번호, 사업장명, start_year, end_year)</li>\n<li>날짜형으로 데이터 변환</li>\n<li>Label Encoding</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">## 과정 2 진행 중 date 범위 오류값 수정</span>\n<span class=\"token comment\"># 인허가일자</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19750229</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19750228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19940431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19940430</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19840431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19840430</span>\n\n<span class=\"token comment\"># 폐업일자</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020231</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20140000</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20140101</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000300</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000301</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020400</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020401</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19990900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19990901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\n\ndata <span class=\"token operator\">=</span> lodge\n\n<span class=\"token comment\"># 불필요한 칼럼 제외</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#-------- 날짜형으로 데이터 변환 ------------</span>\n<span class=\"token comment\"># 약간 지저분한 방식으로 날짜형 데이터로 전환</span>\n<span class=\"token comment\"># 1. int-> str 변환</span>\n<span class=\"token comment\"># 2. str.slice 함수 사용하여 년도,월,일로 나눔</span>\n<span class=\"token comment\"># 3. 나눠진 칼럼을 to_datetime으로 날짜형데이터로 변환</span>\n<span class=\"token comment\"># 1~3 과정에서 발생한 임시 칼럼 삭제</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">make_datetime</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'str'</span><span class=\"token punctuation\">)</span>\n    temp <span class=\"token operator\">=</span> df\n    temp <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    \n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span>\n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    \n    df<span class=\"token punctuation\">[</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ndata</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1978-07-31</td>\n      <td>2003-03-31</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1980-02-20</td>\n      <td>2007-12-18</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>1970-08-11</td>\n      <td>1999-01-23</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>2012-06-25</td>\n      <td>2017-12-14</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>숙박업</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>2003-01-16</td>\n      <td>2016-01-25</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>자동차야영장업</td>\n      <td>제주시</td>\n      <td>폐업</td>\n      <td>2016-03-08</td>\n      <td>2022-03-11</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>자동차야영장업</td>\n      <td>구례군</td>\n      <td>폐업</td>\n      <td>2020-09-09</td>\n      <td>2022-03-11</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>자동차야영장업</td>\n      <td>태안군</td>\n      <td>폐업</td>\n      <td>2016-06-24</td>\n      <td>2016-10-18</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>자동차야영장업</td>\n      <td>완도군</td>\n      <td>폐업</td>\n      <td>2019-07-22</td>\n      <td>2019-08-26</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>자동차야영장업</td>\n      <td>인제군</td>\n      <td>폐업</td>\n      <td>2016-06-02</td>\n      <td>2020-05-07</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 본격적인 머신러닝을 하기 위해 0으로 지정한 값(null)을 중간값으로 값을 대체</span>\n\n<span class=\"token comment\">#data['운영기간'][data['운영기간'] ==0] = 17</span>\n\n<span class=\"token comment\">#data['면적'][data['면적'] == 0 ] = 335</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>65176</th>\n      <td>한옥체험업</td>\n      <td>강진군</td>\n      <td>영업</td>\n      <td>2013-11-30</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>117.41</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65177</th>\n      <td>한옥체험업</td>\n      <td>경주시</td>\n      <td>영업</td>\n      <td>2019-07-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>65178</th>\n      <td>한옥체험업</td>\n      <td>서울특별시</td>\n      <td>영업</td>\n      <td>2021-07-05</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>65180</th>\n      <td>한옥체험업</td>\n      <td>강진군</td>\n      <td>영업</td>\n      <td>2013-12-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>95.58</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65053</th>\n      <td>한옥체험업</td>\n      <td>전주시</td>\n      <td>영업</td>\n      <td>2013-11-06</td>\n      <td>2022-03-11</td>\n      <td>2021-11</td>\n      <td>335.00</td>\n      <td>9.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>개방서비스명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>폐업</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>61838</th>\n      <td>General Campground</td>\n      <td>0</td>\n      <td>영업</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>59790</th>\n      <td>Resort Condominium</td>\n      <td>0</td>\n      <td>영업</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>60027</th>\n      <td>Resort Condominium</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>57840</th>\n      <td>TOURIST HOTEL</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>60575</th>\n      <td>Tourist Accommodation Business</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64112</th>\n      <td>Traditional Korean</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64879</th>\n      <td>Traditional Korean housing experiencing business</td>\n      <td>999</td>\n      <td>영업</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>58137</th>\n      <td>관광숙박업</td>\n      <td>평창군</td>\n      <td>폐업</td>\n      <td>1997-03-14</td>\n      <td>2006-08-31</td>\n      <td>2018-08</td>\n      <td>0.00</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>59038</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2016-09-27</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>218.85</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59039</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2016-12-30</td>\n      <td>2022-03-11</td>\n      <td>2021-10</td>\n      <td>624.75</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59042</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-03-15</td>\n      <td>2022-03-11</td>\n      <td>2021-08</td>\n      <td>225.16</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59041</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-02-03</td>\n      <td>2022-03-11</td>\n      <td>2020-02</td>\n      <td>313.04</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59043</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-03-31</td>\n      <td>2022-03-11</td>\n      <td>2022-01</td>\n      <td>1382.35</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59044</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-06-01</td>\n      <td>2022-03-11</td>\n      <td>2019-02</td>\n      <td>169.63</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59045</th>\n      <td>관광숙박업</td>\n      <td>부산광역시</td>\n      <td>영업</td>\n      <td>2017-07-03</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>246.27</td>\n      <td>5.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'PySpark ML for Loging Industry'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|   면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  관광숙박업|부산광역시|          영업|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|  면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+------+--------+\n|      숙박업|서울특별시|          폐업|1948-08-15|1967-07-10| 2018-08| 335.0|    19.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-07-07| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2015-12-03| 2018-08| 148.5|    67.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-02-01| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1975-09-18| 2018-08| 335.0|    27.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1972-07-31| 2018-08| 335.0|    24.0|\n|      숙박업|서울특별시|          영업|1948-08-15|2022-03-11| 2019-12|144.93|    74.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2000-06-15| 2018-08| 335.0|    52.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|2001-05-17| 2018-08| 335.0|    53.0|\n|      숙박업|서울특별시|          영업|1948-08-15|2022-03-11| 2018-10| 907.0|    74.0|\n|      숙박업|서울특별시|          폐업|1948-08-15|1948-08-15| 2018-08| 335.0|     0.0|\n|      숙박업|서울특별시|          폐업|1949-07-05|2006-03-27| 2018-08| 165.0|    57.0|\n|      숙박업|인천광역시|          폐업|1952-04-13|2018-08-28| 2018-10| 335.0|    66.0|\n|      숙박업|    경주시|          폐업|1954-01-31|1991-07-05| 2018-08|500.96|    37.0|\n|      숙박업|    영광군|          폐업|1954-02-08|2006-10-18| 2018-08|  88.0|    52.0|\n|      숙박업|    해남군|          폐업|1955-01-20|2002-05-02| 2018-08| 335.0|    47.0|\n|      숙박업|    창원시|          폐업|1955-06-14|1999-03-02| 2021-07|166.77|    44.0|\n|      숙박업|    경주시|          영업|1957-04-19|2022-03-11| 2021-02| 335.0|    65.0|\n|      숙박업|    창원시|          폐업|1958-04-28|2018-01-24| 2021-07| 63.46|    60.0|\n|      숙박업|    창원시|          영업|1958-05-19|2022-03-11| 2021-07| 74.04|    64.0|\n+------------+----------+--------------+----------+----------+--------+------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|   면적|운영기간|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  관광숙박업|부산광역시|          영업|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  관광숙박업|부산광역시|          영업|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  관광숙박업|부산광역시|          영업|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  관광숙박업|부산광역시|          영업|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  관광숙박업|부산광역시|          영업|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  관광숙박업|부산광역시|          영업|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"범주형-변수-처리하기\" style=\"position:relative;\"><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"범주형 변수 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>범주형 변수 처리하기</h3>\n<p>아래는 총 3가지 과정으로 진행</p>\n<ol>\n<li>StringIndexer</li>\n</ol>\n<p>범주형 변수를 인덱싱하여 0.0 , 1.0, 2.0 과 같은 번호로 인덱싱</p>\n<ol start=\"2\">\n<li>OneHotEncoder</li>\n</ol>\n<p>인덱싱한 값은 0,1,2 와 같이 값으로써 크기를 가지기 때문에 OneHotEncoder를 사용하여 값의 크기를 갖지 않도록 변환</p>\n<ol start=\"3\">\n<li>VectorAssembler</li>\n</ol>\n<p>인코딩한 값을 벡터로 모으기</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml <span class=\"token keyword\">import</span> Pipeline\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>feature <span class=\"token keyword\">import</span> StringIndexer<span class=\"token punctuation\">,</span> OneHotEncoder<span class=\"token punctuation\">,</span> VectorAssembler\n\n<span class=\"token comment\"># 갱신일자, 인허가일자, 폐업일자를 제외하고 다시 진행</span>\ncategory_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'갱신일자'</span><span class=\"token punctuation\">]</span>\nnumeric_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># label</span>\nlabel_idx <span class=\"token operator\">=</span> StringIndexer<span class=\"token punctuation\">(</span>inputCol <span class=\"token operator\">=</span> <span class=\"token string\">\"상세영업상태명\"</span><span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 범주형 변수들을 인덱싱</span>\nindexers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    StringIndexer<span class=\"token punctuation\">(</span>inputCol<span class=\"token operator\">=</span>c<span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_indexed\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> category_cols\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 인덱싱한 변수들을 인코딩</span>\nencoders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>OneHotEncoder<span class=\"token punctuation\">(</span>dropLast<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>inputCol<span class=\"token operator\">=</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_encoded\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    <span class=\"token keyword\">for</span> indexer <span class=\"token keyword\">in</span> indexers\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 인코딩 된 값과 숫자 변수 값을 벡터화</span>\n<span class=\"token comment\"># -- encoder와 numeric cols 의 결합 리스트 관련 지식 부족(Array로 안됨)</span>\n\nassembler <span class=\"token operator\">=</span> VectorAssembler<span class=\"token punctuation\">(</span>inputCols<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'개방서비스명_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'지역_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'인허가일자_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'폐업일자_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'갱신일자_indexed_encoded'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"features\"</span><span class=\"token punctuation\">)</span>\n\npipeline <span class=\"token operator\">=</span> Pipeline<span class=\"token punctuation\">(</span>stages<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>label_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> indexers  <span class=\"token operator\">+</span> encoders<span class=\"token operator\">+</span><span class=\"token punctuation\">[</span>assembler<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token operator\">=</span>pipeline<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|개방서비스명|      지역|상세영업상태명|인허가일자|  폐업일자|갱신일자|  면적|운영기간|label|개방서비스명_indexed|지역_indexed|인허가일자_indexed|폐업일자_indexed|갱신일자_indexed|개방서비스명_indexed_encoded|지역_indexed_encoded|인허가일자_indexed_encoded|폐업일자_indexed_encoded|갱신일자_indexed_encoded|            features|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|  관광숙박업|    평창군|          폐업|1997-03-14|2006-08-31| 2018-08|   0.0|     9.0|  1.0|                 2.0|        55.0|            1373.0|           244.0|             0.0|               (7,[2],[1.0])|    (163,[55],[1.0])|      (14963,[1373],[1.0])|      (6606,[244],[1.0])|          (44,[0],[1.0])|(21785,[2,62,1543...|\n|  관광숙박업|부산광역시|          영업|2016-09-27|2022-03-11| 2018-12|218.85|     6.0|  0.0|                 2.0|         1.0|             887.0|             0.0|            23.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[887],[1.0])|        (6606,[0],[1.0])|         (44,[23],[1.0])|(21785,[2,8,1057,...|\n|  관광숙박업|부산광역시|          영업|2016-12-30|2022-03-11| 2021-10|624.75|     6.0|  0.0|                 2.0|         1.0|             686.0|             0.0|             7.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[686],[1.0])|        (6606,[0],[1.0])|          (44,[7],[1.0])|(21785,[2,8,856,1...|\n|  관광숙박업|부산광역시|          영업|2017-03-15|2022-03-11| 2021-08|225.16|     5.0|  0.0|                 2.0|         1.0|            5201.0|             0.0|             4.0|               (7,[2],[1.0])|     (163,[1],[1.0])|      (14963,[5201],[1.0])|        (6606,[0],[1.0])|          (44,[4],[1.0])|(21785,[2,8,5371,...|\n|  관광숙박업|부산광역시|          영업|2017-02-03|2022-03-11| 2020-02|313.04|     5.0|  0.0|                 2.0|         1.0|             536.0|             0.0|            20.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[536],[1.0])|        (6606,[0],[1.0])|         (44,[20],[1.0])|(21785,[2,8,706,1...|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\nonly showing top 5 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df <span class=\"token operator\">=</span> transformed<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>regression <span class=\"token keyword\">import</span> LinearRegression\n\nlr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>LinearRegression<span class=\"token punctuation\">(</span>featuresCol<span class=\"token operator\">=</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">\"label\"</span><span class=\"token punctuation\">,</span> predictionCol<span class=\"token operator\">=</span><span class=\"token string\">'predlabel'</span><span class=\"token punctuation\">,</span> \n                               maxIter<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> regParam<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> elasticNetParam<span class=\"token operator\">=</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span> standardization<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  1.0|(21785,[2,62,1543...|\n|  0.0|(21785,[2,8,1057,...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,5371,...|\n|  0.0|(21785,[2,8,706,1...|\n|  0.0|(21785,[2,8,563,1...|\n|  0.0|(21785,[2,8,712,1...|\n|  0.0|(21785,[2,8,2325,...|\n|  0.0|(21785,[2,8,415,1...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,7123,...|\n|  0.0|(21785,[2,8,2337,...|\n|  0.0|(21785,[2,8,1336,...|\n|  0.0|(21785,[2,8,688,1...|\n|  0.0|(21785,[2,8,1376,...|\n|  0.0|(21785,[2,8,1073,...|\n|  0.0|(21785,[2,8,9370,...|\n|  0.0|(21785,[2,8,1335,...|\n|  0.0|(21785,[2,8,299,1...|\n|  0.0|(21785,[2,8,321,1...|\n+-----+--------------------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">,</span> test_data <span class=\"token operator\">=</span> trans_df<span class=\"token punctuation\">.</span>randomSplit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> seed<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">.</span>columns</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">['label', 'features']</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Fit the data to the model</span>\nlinearModel <span class=\"token operator\">=</span> lr<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions <span class=\"token operator\">=</span> linearModel<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels <span class=\"token operator\">=</span> predictions<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-------------------+-----+\n|          predlabel|label|\n+-------------------+-----+\n| 0.4786779491779273|  0.0|\n|0.47812190795718557|  0.0|\n| 0.4763438691699301|  0.0|\n|0.46373595776939147|  0.0|\n| 0.4621842148277867|  0.0|\n|  0.461957918982136|  0.0|\n|0.46163463920263503|  0.0|\n| 0.4564621627306192|  0.0|\n| 0.4530677250458588|  0.0|\n| 0.4522595255971063|  0.0|\n|0.45080476658935187|  0.0|\n| 0.4472567710093285|  0.0|\n|0.39633212374343496|  0.0|\n| 0.3614890291088182|  0.0|\n| 0.4700399134696608|  0.0|\n| 0.4727877915954192|  0.0|\n|0.46379414812970166|  0.0|\n|0.45904840096662713|  0.0|\n|0.44309292744935574|  0.0|\n| 0.3900524140266282|  0.0|\n+-------------------+-----+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"평가\" style=\"position:relative;\"><a href=\"#%ED%8F%89%EA%B0%80\" aria-label=\"평가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>평가</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>evaluation <span class=\"token keyword\">import</span> RegressionEvaluator\n\n<span class=\"token comment\"># Get the RMSE</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>rootMeanSquaredError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>meanAbsoluteError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Get the R2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>r2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5022262338134558\nMAE: 0.4878241107468986\nR2: 0.012063243903345677</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'rmse'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5017870515976061</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'mae'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">MAE: 0.4873217827313394</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'r2'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">R2: 0.010070756230703637</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">spark<span class=\"token punctuation\">.</span>stop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners\">https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners</a></p>\n<p><a href=\"https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html\">https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html</a></p>\n<p><a href=\"https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0\">https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0</a></p>\n<p><a href=\"https://spark.apache.org/docs/latest/ml-classification-regression.html\">https://spark.apache.org/docs/latest/ml-classification-regression.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\">변수 선택 및 변환</a></li>\n<li><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">범주형 변수 처리하기</a></li>\n<li><a href=\"#%ED%8F%89%EA%B0%80\">평가</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","excerpt":"이번 장에서는 전 장에서 진행한 자료를 가지고 Pyspark의 ML 라이브러리를 활용하여 폐업 가능확률을 알아보자 변수 선택 및 변환 불필요한 칼럼 제외 (번호, 사업장명, start_year, end_year) 날짜형으로 데이터 변환 Label Encoding 범주형 변수 처리하기 아래는 총 3가지 과정으로 진행 StringIndexer 범주형 변수를 인덱싱하여 0.0 , 1.0, 2.0 과 같은 번호로 인덱싱 OneHotEncoder 인덱싱한 값은 0,1,2 와 같이 값으로써 크기를 가지기 때문에 OneHotEncoder를 사용하여 값의 크기를 갖지 않도록 변환 VectorAssembler 인코딩한 값을 벡터로 모으기 평가 Reference https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners https://spark.apache.org/docs/3.1.1/api/python/reference/api…","frontmatter":{"date":"April 21, 2022","title":"숙박업 분석하기 (3) - MLlib","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (3) - MLlib/"}},"next":{"id":"16b04a9c-e9ed-5a95-9ff7-b55f23dd2013","html":"<h3 id=\"진행-과정\" style=\"position:relative;\"><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\" aria-label=\"진행 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>진행 과정</h3>\n<ol>\n<li>SparkSession 생성</li>\n<li>데이터 불러오기</li>\n</ol>\n<ul>\n<li>Union 하여 하나의 DataFrame으로 만들기</li>\n</ul>\n<ol start=\"3\">\n<li>Schema로 확인</li>\n<li>결측값 처리하기</li>\n<li>Parquet으로 저장하기</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h3 id=\"sparksession-생성\" style=\"position:relative;\"><a href=\"#sparksession-%EC%83%9D%EC%84%B1\" aria-label=\"sparksession 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkSession 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession 객체 생성</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'Python Spark SQL lodging'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"데이터-불러오기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"데이터 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 불러오기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#파일 읽기</span>\nlodge_df1 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_01_P_관광숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df2 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_02_P_관광펜션업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_03_P_숙박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df4 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_04_P_외국인관광도시민박업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df5 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_05_P_자동차야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df6 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_06_P_한옥체험업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nlodge_df7 <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"fulldata_03_11_07_P_일반야영장업.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># printSchema()로 스키마 구조 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 개방서비스아이디: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 관리번호: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 인허가취소일자: integer (nullable = true)\n |-- 영업상태구분코드: integer (nullable = true)\n |-- 영업상태명: string (nullable = true)\n |-- 상세영업상태코드: double (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 휴업시작일자: integer (nullable = true)\n |-- 휴업종료일자: integer (nullable = true)\n |-- 재개업일자: string (nullable = true)\n |-- 소재지전화: string (nullable = true)\n |-- 소재지면적: string (nullable = true)\n |-- 소재지우편번호: integer (nullable = true)\n |-- 소재지전체주소: string (nullable = true)\n |-- 도로명전체주소: string (nullable = true)\n |-- 도로명우편번호: integer (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 최종수정시점: string (nullable = true)\n |-- 데이터갱신구분: string (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 업태구분명: string (nullable = true)\n |-- 좌표정보(x): double (nullable = true)\n |-- 좌표정보(y): double (nullable = true)\n |-- 문화체육업종명: string (nullable = true)\n |-- 문화사업자구분명: string (nullable = true)\n |-- 지역구분명: string (nullable = true)\n |-- 총층수: integer (nullable = true)\n |-- 주변환경명: string (nullable = true)\n |-- 제작취급품목내용: string (nullable = true)\n |-- 보험기관명: string (nullable = true)\n |-- 건물용도명: string (nullable = true)\n |-- 지상층수: integer (nullable = true)\n |-- 지하층수: integer (nullable = true)\n |-- 객실수: integer (nullable = true)\n |-- 건축연면적: integer (nullable = true)\n |-- 영문상호명: string (nullable = true)\n |-- 영문상호주소: string (nullable = true)\n |-- 선박총톤수: integer (nullable = true)\n |-- 선박척수: integer (nullable = true)\n |-- 선박제원: string (nullable = true)\n |-- 무대면적: integer (nullable = true)\n |-- 좌석수: integer (nullable = true)\n |-- 기념품종류: string (nullable = true)\n |-- 회의실별동시수용인원: integer (nullable = true)\n |-- 시설면적: double (nullable = true)\n |-- 놀이기구수내역: string (nullable = true)\n |-- 놀이시설수: integer (nullable = true)\n |-- 방송시설유무: string (nullable = true)\n |-- 발전시설유무: string (nullable = true)\n |-- 의무실유무: string (nullable = true)\n |-- 안내소유무: string (nullable = true)\n |-- 기획여행보험시작일자: string (nullable = true)\n |-- 기획여행보험종료일자: string (nullable = true)\n |-- 자본금: long (nullable = true)\n |-- 보험시작일자: integer (nullable = true)\n |-- 보험종료일자: integer (nullable = true)\n |-- 부대시설내역: string (nullable = true)\n |-- 시설규모: integer (nullable = true)\n |-- 관광숙박업상세명: string (nullable = true)\n |-- _c64: string (nullable = true)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># lodge_df 데이터 확인</span>\nlodge_df1<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|번호|개방서비스명|개방서비스아이디|개방자치단체코드|            관리번호|인허가일자|인허가취소일자|영업상태구분코드|영업상태명|상세영업상태코드|상세영업상태명|폐업일자|휴업시작일자|휴업종료일자|재개업일자|  소재지전화|소재지면적|소재지우편번호|                   소재지전체주소|                    도로명전체주소|도로명우편번호|                  사업장명|  최종수정시점|데이터갱신구분|      데이터갱신일자|업태구분명|     좌표정보(x)|   좌표정보(y)|문화체육업종명|문화사업자구분명|  지역구분명|총층수|주변환경명|제작취급품목내용|보험기관명|건물용도명|지상층수|지하층수|객실수|건축연면적|          영문상호명| 영문상호주소|선박총톤수|선박척수|선박제원|무대면적|좌석수|기념품종류|회의실별동시수용인원|시설면적|놀이기구수내역|놀이시설수|방송시설유무|발전시설유무|의무실유무|안내소유무|기획여행보험시작일자|기획여행보험종료일자|    자본금|보험시작일자|보험종료일자|부대시설내역|시설규모|관광숙박업상세명|_c64|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\n|   1|  관광숙박업|      03_11_01_P|         4530000|CDFI2260032018000001|  20180511|          null|               2|      휴업|             2.0|          휴업|    null|    20220101|    20221231|      null|041-666-8114|      null|          null|   충청남도 서산시 갈산동 181 ...|    충청남도 서산시 안견로 465,...|         31987|         베니키아호텔 서산|20220126112352|             U|2022-01-28 02:40:...|      null|   149762.965546| 364903.326481|    관광숙박업|            null|        null|  null|      null|            null|      null|      null|      13|       3|  null|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    null|      관광호텔업|null|\n|   2|  관광숙박업|      03_11_01_P|         3590000|CDFI2260031981000001|  19811129|          null|               2|      휴업|             2.0|          휴업|    null|    20210607|    20220606|      null|    228-8000|      null|        501835|      광주광역시 동구 지산동 20-8|    광주광역시 동구 지호로 214-...|          null|              신양파크호텔|20220121085653|             U|2022-01-23 02:40:...|      null|   194823.265738| 183819.247909|    관광숙박업|        관광사업|        null|     0|      null|            null|      null|      null|       0|       0|     0|         0|                null|         null|         0|       0|    null|       0|     0|      null|                   0|     0.0|          null|         0|        null|        null|      null|      null|                null|                null|         0|        null|        null|        null|       0|            null|null|\n|   3|  관광숙박업|      03_11_01_P|         3480000|CDFI2260032004000001|  20041015|          null|               2|      휴업|             2.0|          휴업|    null|    20210218|    20220217|      null|053-555-7221|      null|        711858|대구광역시 달성군 논공읍 하리 509|대구광역시 달성군 논공읍 약산덧...|        711856|   (주)파라다이스 온천호텔|20210305175930|             U|2021-03-07 02:40:...|      null|   328965.130661| 250161.463857|    관광숙박업|        관광사업|        null|     4|      null|            null|      null|      null|       3|       1|  null|      null|Yaksan Spa Touris...|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null|    null|          null|      null|        null|        null|      null|      null|                null|                null|2000000000|        null|        null|        null|    null|      관광호텔업|null|\n|   4|  관광숙박업|      03_11_01_P|         3410000|CDFI2260031989000001|  19890131|          null|               2|      휴업|             2.0|          휴업|    null|    20210701|    20220630|      null|053-252-2221|      null|        700112|    대구광역시 중구 태평로2가 1-9|    대구광역시 중구 태평로 117 ...|         41902|            유니온관광호텔|20210720154000|             U|2021-07-22 02:40:...|      null|   343594.783952| 265157.612523|    관광숙박업|        관광사업|중심상업지역|    13|      null|            null|      null|  숙박시설|      11|       2|    65|      null| Union Tourist Hotel|Tourist Hotel|      null|    null|    null|    null|  null|      null|                null| 4231.63|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|    4232|      관광호텔업|null|\n|   5|  관광숙박업|      03_11_01_P|         5250000|CDFI2260031983000001|  19830930|          null|               2|      휴업|             2.0|          휴업|    null|    20210401|    20220331|      null|        null|      null|        767841|경상북도 울진군 온정면 온정리 964|  경상북도 울진군 온정면 온천로 84|          null|에스이엔비(주)백암관광호텔|20210405183956|             U|2021-04-07 02:40:...|      null|408835.060132522|360261.2355428|    관광숙박업|        관광사업|일반상업지역|     8|      기타|            null|      null|      호텔|       7|       1|   127|      null|                null|         null|      null|    null|    null|    null|  null|      null|                null|12081.29|          null|      null|        null|        null|      null|      null|                null|                null|      null|        null|        null|        null|   12081|      관광호텔업|null|\n+----+------------+----------------+----------------+--------------------+----------+--------------+----------------+----------+----------------+--------------+--------+------------+------------+----------+------------+----------+--------------+---------------------------------+----------------------------------+--------------+--------------------------+--------------+--------------+--------------------+----------+----------------+--------------+--------------+----------------+------------+------+----------+----------------+----------+----------+--------+--------+------+----------+--------------------+-------------+----------+--------+--------+--------+------+----------+--------------------+--------+--------------+----------+------------+------------+----------+----------+--------------------+--------------------+----------+------------+------------+------------+--------+----------------+----+\nonly showing top 5 rows</code></pre></div>\n<p>각 csv파일마다 컬럼 목록이 다르므로 csv파일마다 공통된 컬럼과 분석에 적합한 항목들을 선택한 뒤 진행</p>\n<p>번호|개방자치단체코드|사업자명|인허가일자|상세영업상태명|폐업일자|소재지면적|데이터갱신일자|건물지상층수|건물소유구분명|</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 위의 칼럼만 담은 새로운 DataFrame 생성 -- Select</span>\nlodge_df1 <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df2 <span class=\"token operator\">=</span> lodge_df2<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df4 <span class=\"token operator\">=</span> lodge_df4<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df5 <span class=\"token operator\">=</span> lodge_df5<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df6 <span class=\"token operator\">=</span> lodge_df6<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df7 <span class=\"token operator\">=</span> lodge_df7<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방서비스명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'사업장명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    col<span class=\"token punctuation\">(</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'데이터갱신일자'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 칼럼명 변경 및 기존 칼럼 삭제</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">(</span><span class=\"token string\">'소재지면적'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge_df3 <span class=\"token operator\">=</span> lodge_df3<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"소재지면적\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"union-하여-하나의-dataframe으로-합치기\" style=\"position:relative;\"><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\" aria-label=\"union 하여 하나의 dataframe으로 합치기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Union 하여 하나의 DataFrame으로 합치기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># merge 하기</span>\nlodge <span class=\"token operator\">=</span> lodge_df1<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df2<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df3<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df4<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df5<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df6<span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>unionAll<span class=\"token punctuation\">(</span>lodge_df7<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|번호|개방서비스명|                        사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|      데이터갱신일자|시설면적|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\n|   1|  관광숙박업|               베니키아호텔 서산|         4530000|          휴업|  20180511|    null|2022-01-28 02:40:...|    null|\n|   2|  관광숙박업|                    신양파크호텔|         3590000|          휴업|  19811129|    null|2022-01-23 02:40:...|     0.0|\n|   3|  관광숙박업|         (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|    null|2021-03-07 02:40:...|    null|\n|   4|  관광숙박업|                  유니온관광호텔|         3410000|          휴업|  19890131|    null|2021-07-22 02:40:...| 4231.63|\n|   5|  관광숙박업|      에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|    null|2021-04-07 02:40:...|12081.29|\n|   6|  관광숙박업|            파크비지니스관광호텔|         5080000|          휴업|  20021230|    null|2021-11-24 02:40:...| 1029.11|\n|   7|  관광숙박업|                     호텔 비에스|         5080000|          휴업|  20140818|    null|2021-10-30 02:40:...| 4292.48|\n|   8|  관광숙박업|                (주)하일라리조트|         5180000|          휴업|  20061031|    null|2018-08-31 23:59:...|    null|\n|   9|  관광숙박업|(주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|    null|2021-04-23 02:40:...|    null|\n|  10|  관광숙박업|                그랜드 호텔 경주|         5050000|          휴업|  19880622|    null|2021-09-12 02:40:...|     0.0|\n|  11|  관광숙박업|                경주조선온천호텔|         5050000|          휴업|  20120815|    null|2021-11-13 02:40:...|14134.49|\n|  12|  관광숙박업|                  마린프라자(주)|         3580000|          휴업|  19980601|    null|2019-04-24 02:40:...| 11774.9|\n|  13|  관광숙박업|                    인썸관광호텔|         3580000|          휴업|  20171130|    null|2021-05-01 02:40:...|  1370.0|\n|  14|  관광숙박업|                    이츠관광호텔|         3490000|          휴업|  20031201|    null|2022-01-15 02:40:...| 2498.58|\n|  15|  관광숙박업|                인천비치관광호텔|         3490000|          휴업|  20070618|    null|2021-10-20 02:40:...|     0.0|\n|  16|  관광숙박업|   (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|    null|2019-12-04 02:40:...| 9316.17|\n|  17|  관광숙박업|(주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|    null|2021-05-26 02:40:...|23008.37|\n|  18|  관광숙박업|                  엠페러관광호텔|         3640000|          휴업|  19950104|    null|2018-08-31 23:59:...|  4405.9|\n|  19|  관광숙박업|                   올림포스 호텔|         3490000|          휴업|  19651203|    null|2021-07-11 02:40:...|21322.57|\n|  20|  관광숙박업|     (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|    null|2020-11-04 02:40:...| 12014.0|\n+----+------------+--------------------------------+----------------+--------------+----------+--------+--------------------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"schema-확인하기\" style=\"position:relative;\"><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"schema 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Schema 확인하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>printSchema<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root\n |-- 번호: string (nullable = true)\n |-- 개방서비스명: string (nullable = true)\n |-- 사업장명: string (nullable = true)\n |-- 개방자치단체코드: integer (nullable = true)\n |-- 상세영업상태명: string (nullable = true)\n |-- 인허가일자: integer (nullable = true)\n |-- 폐업일자: integer (nullable = true)\n |-- 데이터갱신일자: string (nullable = true)\n |-- 시설면적: string (nullable = true)</code></pre></div>\n<h3 id=\"결측치-처리하기\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"결측치 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결측치 처리하기</h3>\n<p>Null 값이 있는 칼럼은 아래와 같이 처리</p>\n<p>개방서비스명 - ‘숙박업’으로 대체 (제일 많은 비율을 차지)</p>\n<p>사업자명 - ‘알수없음’으로 대체</p>\n<p>개방자치단체코드 - ‘999’로 대체. 추후 알수없음으로 교체</p>\n<p>상세영업상태명 - ‘영업중’으로 대체</p>\n<p>인허가일자 - 데이터의 평균을 구한 뒤 근접한 날짜로 대체</p>\n<p>폐업일자 - 데이터 기준 날짜로 변경 (2022.03.11)</p>\n<p>시설면적 - ‘0’으로 대체. 추후 알수없음으로 교체</p>\n<p>갱신일자 - 데이터 기준 날짜로 대체 (2022-03)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 결측치 확인</span>\nlodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|데이터갱신일자|시설면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+\n|   0|          28|      15|              38|            35|        33|   39666|            40|    3062|\n+----+------------+--------+----------------+--------------+----------+--------+--------------+--------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span>avg<span class=\"token punctuation\">(</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+--------------------+\n|     avg(인허가일자)|\n+--------------------+\n|1.9993372109428637E7|\n+--------------------+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># na 값 위의 값으로 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'숙박업'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방서비스명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'알수없음'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"사업장명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"개방자치단체코드\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'영업중'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"상세영업상태명\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">19991231</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"인허가일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token number\">20220311</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"폐업일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"시설면적\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 갱신일자</span>\nlodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">,</span> lpad<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 칼럼 삭제하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터갱신일자\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># na 값 대체하기</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>na<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">'2022-03'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"갱신일자\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>withColumn<span class=\"token punctuation\">(</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>regexp_replace<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'[\\s,]'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlodge <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">'시설면적'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|번호|개방서비스명|                          사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|    면적|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\n|   1|  관광숙박업|                 베니키아호텔 서산|         4530000|          휴업|  20180511|20220311| 2022-01|       0|\n|   2|  관광숙박업|                      신양파크호텔|         3590000|          휴업|  19811129|20220311| 2022-01|     0.0|\n|   3|  관광숙박업|           (주)파라다이스 온천호텔|         3480000|          휴업|  20041015|20220311| 2021-03|       0|\n|   4|  관광숙박업|                    유니온관광호텔|         3410000|          휴업|  19890131|20220311| 2021-07| 4231.63|\n|   5|  관광숙박업|        에스이엔비(주)백암관광호텔|         5250000|          휴업|  19830930|20220311| 2021-04|12081.29|\n|   6|  관광숙박업|              파크비지니스관광호텔|         5080000|          휴업|  20021230|20220311| 2021-11| 1029.11|\n|   7|  관광숙박업|                       호텔 비에스|         5080000|          휴업|  20140818|20220311| 2021-10| 4292.48|\n|   8|  관광숙박업|                  (주)하일라리조트|         5180000|          휴업|  20061031|20220311| 2018-08|       0|\n|   9|  관광숙박업|  (주)이랜드파크 한국콘도 경주보문|         5050000|          휴업|  19830816|20220311| 2021-04|       0|\n|  10|  관광숙박업|                  그랜드 호텔 경주|         5050000|          휴업|  19880622|20220311| 2021-09|     0.0|\n|  11|  관광숙박업|                  경주조선온천호텔|         5050000|          휴업|  20120815|20220311| 2021-11|14134.49|\n|  12|  관광숙박업|                    마린프라자(주)|         3580000|          휴업|  19980601|20220311| 2019-04| 11774.9|\n|  13|  관광숙박업|                      인썸관광호텔|         3580000|          휴업|  20171130|20220311| 2021-05|  1370.0|\n|  14|  관광숙박업|                      이츠관광호텔|         3490000|          휴업|  20031201|20220311| 2022-01| 2498.58|\n|  15|  관광숙박업|                  인천비치관광호텔|         3490000|          휴업|  20070618|20220311| 2021-10|     0.0|\n|  16|  관광숙박업|     (주)이랜드파크  한국콘도 도고|         4520000|          휴업|  19830801|20220311| 2019-12| 9316.17|\n|  17|  관광숙박업|  (주)이랜드파크 켄싱턴리조트 도고|         4520000|          휴업|  19921023|20220311| 2021-05|23008.37|\n|  18|  관광숙박업|                    엠페러관광호텔|         3640000|          휴업|  19950104|20220311| 2018-08|  4405.9|\n|  19|  관광숙박업|                     올림포스 호텔|         3490000|          휴업|  19651203|20220311| 2021-07|21322.57|\n|  20|  관광숙박업|       (주)이랜드파크 전주코아호텔|         4640000|          휴업|  19970320|20220311| 2020-11| 12014.0|\n|  21|  관광숙박업|             째즈어라운드 관광호텔|         4640000|          휴업|  20120404|20220311| 2021-07| 2774.48|\n|  22|  관광숙박업|                군산리버힐관광호텔|         4670000|          휴업|  19961224|20220311| 2022-01|       0|\n|  23|  관광숙박업|                      폭스관광호텔|         4670000|          휴업|  20090730|20220311| 2021-06| 1836.24|\n|  24|  관광숙박업|                    오스카관광호텔|         4670000|          휴업|  20110407|20220311| 2021-12| 2961.87|\n|  25|  관광숙박업|              (주)무주덕유산리조트|         4740000|          휴업|  19970121|20220311| 2021-04|       0|\n|  26|  관광숙박업|                   예그리나 호스텔|         6510000|          휴업|  20140501|20220311| 2021-01| 1004.18|\n|  27|  관광숙박업|       더 쇼어 호텔 제주(The Sh...|         6520000|          휴업|  19850115|20220311| 2021-02|     0.0|\n|  28|  관광숙박업|                    CASALOMA HOTEL|         6520000|          휴업|  19860915|20220311| 2019-09|  7220.2|\n|  29|  관광숙박업|                            WE호텔|         6520000|          휴업|  19920325|20220311| 2019-04|       0|\n|  30|  관광숙박업|                       헤이 서귀포|         6520000|          휴업|  19921002|20220311| 2021-05| 12136.0|\n|  31|  관광숙박업|             주식회사 호텔크리스탈|         6520000|          휴업|  19920618|20220311| 2021-12| 3647.35|\n|  32|  관광숙박업|                서귀포월드컵리조트|         6520000|          휴업|  20101027|20220311| 2020-09| 8481.52|\n|  33|  관광숙박업|             휴식호텔 중문오션블루|         6520000|          휴업|  20160120|20220311| 2022-01| 1530.99|\n|  34|  관광숙박업|                          뜨레피아|         6520000|          휴업|  20130909|20220311| 2019-04| 1266.74|\n|  35|  관광숙박업|                          호텔화인|         6520000|          휴업|  20150611|20220311| 2022-01| 5268.63|\n|  36|  관광숙박업|                      엔파제주호텔|         6520000|          휴업|  20121106|20220311| 2021-01| 2984.95|\n|  37|  관광숙박업|                  제주세인트하우스|         6520000|          휴업|  20140227|20220311| 2020-11|     0.0|\n|  38|  관광숙박업|                  제주항공우주호텔|         6520000|          휴업|  20140328|20220311| 2021-08| 21359.0|\n|  39|  관광숙박업|                        양평리조트|         4170000|          휴업|  20030325|20220311| 2020-12|  2016.8|\n|  40|  관광숙박업|                  윈져캐슬관광호텔|         4050000|          휴업|  20080313|20220311| 2020-04|  423.47|\n|  41|  관광숙박업|                        루스톤호텔|         6510000|          휴업|  20140822|20220311| 2022-01| 3793.94|\n|  42|  관광숙박업|(주)이랜드파크 켄싱턴리조트 해운대|         3330000|          휴업|  19840801|20220311| 2022-02|       0|\n|  43|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020719|20220311| 2018-08|       0|\n|  44|  관광숙박업|              동남해상관광호텔(주)|         3330000|          휴업|  20020720|20220311| 2018-08|       0|\n|  45|  관광숙박업|          동남해상관광호텔주식회사|         3330000|          휴업|  20020914|20220311| 2018-08|       0|\n|  46|  관광숙박업|                     보나트리 호텔|         3380000|          휴업|  20170616|20220311| 2022-01| 1496.07|\n|  47|  관광숙박업|                 호텔포레 부산역점|         3270000|          휴업|  20150205|20220311| 2022-02| 2581.86|\n|  48|  관광숙박업|                라스베가스관광호텔|         3340000|          휴업|  20010305|20220311| 2022-01|10627.57|\n|  49|  관광숙박업|                   인더스트리 호텔|         3330000|          휴업|  20140710|20220311| 2022-01|  1938.1|\n|  50|  관광숙박업|                사보이관광호텔(주)|         5670000|          휴업|  19901011|20220311| 2021-12|11856.78|\n+----+------------+----------------------------------+----------------+--------------+----------+--------+--------+--------+\nonly showing top 50 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">(</span>when<span class=\"token punctuation\">(</span>isnan<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> col<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isNull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>alias<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> lodge<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|번호|개방서비스명|사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|면적|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+\n|   0|           0|       0|               0|             0|         0|       0|       0|   0|\n+----+------------+--------+----------------+--------------+----------+--------+--------+----+</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>toPandas<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nlodge_df<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;class 'pandas.core.frame.DataFrame'>\nRangeIndex: 67328 entries, 0 to 67327\nData columns (total 9 columns):\n #   Column    Non-Null Count  Dtype \n---  ------    --------------  ----- \n 0   번호        67328 non-null  object\n 1   개방서비스명    67328 non-null  object\n 2   사업장명      67328 non-null  object\n 3   개방자치단체코드  67328 non-null  int32 \n 4   상세영업상태명   67328 non-null  object\n 5   인허가일자     67328 non-null  int32 \n 6   폐업일자      67328 non-null  int32 \n 7   갱신일자      67328 non-null  object\n 8   면적        67328 non-null  object\ndtypes: int32(3), object(6)\nmemory usage: 3.9+ MB</code></pre></div>\n<h3 id=\"parquet으로-저장하기\" style=\"position:relative;\"><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"parquet으로 저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet으로 저장하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Parquet로 저장하기</span>\nlodge<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"에러-발생-시\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\" aria-label=\"에러 발생 시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>에러 발생 시</h3>\n<p>Hadoop이 설치가 안되있는 경우 아래와 같이 에러가 발생할 수 있습니다. 에러가 발생한 경우 아래 사이트대로 설치하여 문제 해결하시길 바랍니다.</p>\n<p><img src=\"/6bf868183caeb77f3ce5c55f85e4c12b/1.png\" alt=\"1.PNG\"></p>\n<p>Trouble Shooting</p>\n<p><a href=\"https://codedragon.tistory.com/9582\">https://codedragon.tistory.com/9582</a></p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html\">https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html</a></p>\n<p><a href=\"https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/\">https://minsw.github.io/2021/02/02/Spark-The-Definitive-Guide-6%EC%9E%A5/</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%A7%84%ED%96%89-%EA%B3%BC%EC%A0%95\">진행 과정</a></li>\n<li><a href=\"#sparksession-%EC%83%9D%EC%84%B1\">SparkSession 생성</a></li>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">데이터 불러오기</a></li>\n<li><a href=\"#union-%ED%95%98%EC%97%AC-%ED%95%98%EB%82%98%EC%9D%98-dataframe%EC%9C%BC%EB%A1%9C-%ED%95%A9%EC%B9%98%EA%B8%B0\">Union 하여 하나의 DataFrame으로 합치기</a></li>\n<li><a href=\"#schema-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">Schema 확인하기</a></li>\n<li><a href=\"#%EA%B2%B0%EC%B8%A1%EC%B9%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">결측치 처리하기</a></li>\n<li><a href=\"#parquet%EC%9C%BC%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">Parquet으로 저장하기</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\">에러 발생 시</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 20, 2022","title":"숙박업 분석하기 (1) - 데이터 수집 및 전처리","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/"}},"prev":{"id":"93df98a5-2415-5d89-80b6-5aa5f9e26d18","html":"<p>이번 장에서는 전처리가 완료된 숙박업 데이터 EDA를 통해 숙박업 상태를 간략히 알아보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> font_manager<span class=\"token punctuation\">,</span>rc\n<span class=\"token keyword\">import</span> matplotlib\n\nfont_path <span class=\"token operator\">=</span> <span class=\"token string\">'C:\\\\Windows\\\\Fonts\\\\gulim.ttc'</span>\n\n<span class=\"token comment\">#폰트 이름 얻어오기</span>\nfont_name <span class=\"token operator\">=</span> font_manager<span class=\"token punctuation\">.</span>FontProperties<span class=\"token punctuation\">(</span>fname<span class=\"token operator\">=</span>font_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#font 설정</span>\nmatplotlib<span class=\"token punctuation\">.</span>rc<span class=\"token punctuation\">(</span><span class=\"token string\">'font'</span><span class=\"token punctuation\">,</span>family<span class=\"token operator\">=</span>font_name<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-----+------------+------------+----------------+--------------+----------+--------+--------+-------+\n| 번호|개방서비스명|    사업장명|개방자치단체코드|상세영업상태명|인허가일자|폐업일자|갱신일자|   면적|\n+-----+------------+------------+----------------+--------------+----------+--------+--------+-------+\n|39267|      숙박업|  산호장여관|         5670000|          폐업|  19780731|20030331| 2021-07|  77.17|\n|39268|      숙박업|    새한여관|         5670000|          폐업|  19800220|20071218| 2021-07| 272.00|\n|39269|      숙박업|        삼성|         5670000|          폐업|  19700811|19990123| 2021-07|  86.94|\n|39270|      숙박업|      승정원|         5670000|          폐업|  20120625|20171214| 2021-07| 292.50|\n|39271|      숙박업|    에스모텔|         5670000|          폐업|  20030116|20160125| 2021-07| 351.80|\n|39272|      숙박업|      소라텔|         5670000|          폐업|  20070501|20121220| 2021-07| 400.00|\n|39273|      숙박업|    삼성모텔|         5670000|          폐업|  19920605|20120308| 2021-07| 434.85|\n|39274|      숙박업|  정수장여관|         5670000|          폐업|  20120410|20171206| 2021-07| 368.33|\n|39275|      숙박업|      그린텔|         5670000|          폐업|  20120412|20120425| 2021-07| 264.00|\n|39276|      숙박업|  브이원모텔|         5670000|          폐업|  20040311|20180704| 2021-07|1113.60|\n|39277|      숙박업|프린스장여관|         5670000|          폐업|  19971216|20121129| 2021-07| 579.24|\n|39278|      숙박업|        송정|         5670000|          폐업|  19650406|20070420| 2021-07|  62.00|\n|39279|      숙박업|        대성|         5670000|          폐업|  19810702|20001116| 2021-07|  36.37|\n|39280|      숙박업|      수림장|         5670000|          폐업|  19800904|20091224| 2021-07|  72.25|\n|39281|      숙박업|맥스 인 모텔|         5670000|          폐업|  19801008|20200203| 2021-07| 201.32|\n|39282|      숙박업|  열린여인숙|         5670000|          폐업|  19710115|20071114| 2021-07|    .00|\n|39283|      숙박업|        명보|         5670000|          폐업|  19710217|20020325| 2021-07|  72.00|\n|39284|      숙박업|        송죽|         5670000|          폐업|  19650907|20070411| 2021-07|  58.80|\n|39285|      숙박업|    로얄파크|         5670000|          폐업|  19850130|20061215| 2021-07| 216.22|\n|39286|      숙박업|      청미장|         5670000|          폐업|  19811214|20051108| 2021-07| 138.84|\n|39287|      숙박업|        금천|         5670000|          폐업|  19820115|20021202| 2021-07| 152.25|\n|39288|      숙박업|      영남장|         5670000|          폐업|  19740814|20140304| 2021-07|  95.04|\n|39289|      숙박업|    그린파크|         5670000|          폐업|  19631025|19991231| 2021-07| 487.00|\n|39290|      숙박업|      퀸모텔|         5670000|          폐업|  20031111|20070406| 2021-07| 795.31|\n|39291|      숙박업|르네상스모텔|         5670000|          폐업|  20031222|20151127| 2021-07|1399.08|\n|39292|      숙박업|        대명|         5670000|          폐업|  19881026|19981202| 2021-07| 225.28|\n|39293|      숙박업|      드림텔|         5670000|          폐업|  20030619|20051221| 2021-07|1016.00|\n|39294|      숙박업|  컨벤션호텔|         5670000|          폐업|  20030219|20050704| 2021-07|1532.80|\n|39295|      숙박업|모리스장여관|         5670000|          폐업|  19960910|20070830| 2021-07| 501.24|\n|39296|      숙박업|  스카이모텔|         5670000|          폐업|  20070712|20070830| 2021-07| 209.00|\n|39297|      숙박업|    부창여관|         5670000|          폐업|  19881021|20040623| 2021-07| 643.00|\n|39298|      숙박업|        부일|         5670000|          폐업|  19861222|20121120| 2021-07| 332.27|\n|39299|      숙박업|  금호여인숙|         5670000|          폐업|  20101213|20110816| 2021-07|    .00|\n|39300|      숙박업|        만복|         5670000|          폐업|  19710326|20020523| 2021-07|    .00|\n|39301|      숙박업|        상춘|         5670000|          폐업|  19711012|20091215| 2021-07|    .00|\n|39302|      숙박업|      부성장|         5670000|          폐업|  19720506|20070420| 2021-07| 151.08|\n|39303|      숙박업|        진주|         5670000|          폐업|  19580428|20180124| 2021-07|  63.46|\n|39304|      숙박업|        제일|         5670000|          폐업|  19581223|20010129| 2021-07|    .00|\n|39305|      숙박업|        고려|         5670000|          폐업|  19600310|20090122| 2021-07|    .00|\n|39306|      숙박업|숲속산장모텔|         5670000|          폐업|  20030211|20190705| 2021-07| 856.98|\n|39307|      숙박업|    타워모텔|         5670000|          폐업|  20010216|20100510| 2021-07| 366.78|\n|39308|      숙박업|  초원장여관|         5670000|          폐업|  19950119|20130802| 2021-07| 827.24|\n|39309|      숙박업|  대우장여관|         5670000|          폐업|  19860526|20130712| 2021-07| 369.02|\n|39310|      숙박업|    기린여관|         5670000|          폐업|  19860628|20030210| 2021-07| 273.92|\n|39311|      숙박업|      성수장|         5670000|          폐업|  19801125|20060613| 2021-07| 254.02|\n|39312|      숙박업|      흥일장|         5670000|          폐업|  19810415|20000228| 2021-07| 101.66|\n|39313|      숙박업|      성빈장|         5670000|          폐업|  19740327|20120727| 2021-07|    .00|\n|39314|      숙박업|      천애장|         5670000|          폐업|  19740409|20061219| 2021-07|    .00|\n|39315|      숙박업|  삼화장여관|         5670000|          폐업|  19780104|20110607| 2021-07|  92.25|\n|39316|      숙박업|        양성|         5670000|          폐업|  19700618|20070411| 2021-07|  82.00|\n|39317|      숙박업|        백옥|         5670000|          폐업|  19701218|20070411| 2021-07|    .00|\n|39318|      숙박업|    네오모텔|         5670000|          폐업|  20030729|20111031| 2021-07|1894.62|\n|39319|      숙박업|      백악장|         5670000|          폐업|  20020906|20080513| 2021-07| 566.48|\n|39320|      숙박업|      새누리|         5670000|          폐업|  20090825|20121010| 2021-07| 586.53|\n|39321|      숙박업|  동궁장모텔|         5670000|          폐업|  20131101|20141111| 2021-07| 393.75|\n|39322|      숙박업|        로얄|         5670000|          폐업|  20131119|20140617| 2021-07| 650.00|\n|39323|      숙박업|    대암모텔|         5670000|          폐업|  20031107|20031229| 2021-07|1035.00|\n|39324|      숙박업|    루비모텔|         5670000|          폐업|  20030902|20031231| 2021-07| 412.00|\n|39325|      숙박업|    하나모텔|         5670000|          폐업|  20030423|20030430| 2021-07| 510.00|\n|39326|      숙박업|  아이존모텔|         5670000|          폐업|  20030429|20060518| 2021-07| 661.00|\n|39327|      숙박업|      그린텔|         5670000|          폐업|  20120914|20130515| 2021-07| 497.70|\n|39328|      숙박업|    새누리장|         5670000|          폐업|  20121010|20131021| 2021-07|    .00|\n|39329|      숙박업|  신성장여관|         5670000|          폐업|  19960215|20220209| 2022-02| 335.19|\n|39330|      숙박업|  럭셔리모텔|         5670000|          폐업|  20120427|20130801| 2021-07| 488.92|\n|39331|      숙박업|        목화|         5670000|          폐업|  19630220|20020927| 2021-07|    .00|\n|39332|      숙박업|        대산|         5670000|          폐업|  19640917|20050329| 2021-07|  35.41|\n|39333|      숙박업|        신덕|         5670000|          폐업|  19641105|20200514| 2021-07|    .00|\n|39334|      숙박업|        명진|         5670000|          폐업|  19651221|20050510| 2021-07|  62.87|\n|39335|      숙박업|      동호장|         5670000|          폐업|  19730824|20070411| 2021-07| 110.25|\n|39336|      숙박업|코리아나모텔|         5670000|          폐업|  20040727|20121120| 2021-07| 805.98|\n|39337|      숙박업|      새나라|         5670000|          폐업|  19650830|20060703| 2021-07|  64.00|\n|39338|      숙박업|      금산장|         5670000|          폐업|  19920713|20070411| 2021-07| 589.68|\n|39339|      숙박업|북면온천여관|         5670000|          폐업|  19980119|20040831| 2021-07|1362.00|\n|39340|      숙박업|    정임여관|         5670000|          폐업|  19900728|20041203| 2021-07| 187.27|\n|39341|      숙박업|      우일장|         5670000|          폐업|  19741119|20161026| 2021-07| 113.36|\n|39342|      숙박업|      궁전장|         5670000|          폐업|  20020509|20160719| 2021-07| 495.00|\n|39343|      숙박업|  백악장여관|         5670000|          폐업|  19900723|20100906| 2021-07| 566.48|\n|39344|      숙박업|      진양장|         5670000|          폐업|  19830725|20050418| 2021-07|  64.07|\n|39345|      숙박업|  궁전장여관|         5670000|          폐업|  19781114|20000601| 2021-07| 135.70|\n|39346|      숙박업|  신라장여관|         5670000|          폐업|  19800117|20070604| 2021-07| 271.98|\n|39347|      숙박업|  동양장여관|         5670000|          폐업|  19931122|20110804| 2021-07| 321.32|\n|39348|      숙박업|        동정|         5670000|          폐업|  19890201|20030415| 2021-07| 379.74|\n|39349|      숙박업|    수복여관|         5670000|          폐업|  19711112|20020202| 2021-07| 119.00|\n|39350|      숙박업|  가인장여관|         5670000|          폐업|  19940117|20160118| 2021-07| 440.76|\n|39351|      숙박업|  동보장여관|         5670000|          폐업|  19941206|20210119| 2021-07| 459.36|\n|39352|      숙박업|  오렌지모텔|         5670000|          폐업|  19870124|20160531| 2021-07| 207.90|\n|39353|      숙박업|  호반장여관|         5670000|          폐업|  19891213|20201102| 2021-07| 390.96|\n|39354|      숙박업|  용호장여관|         5670000|          폐업|  19861231|20031209| 2021-07| 796.80|\n|39355|      숙박업|        마일|         5670000|          폐업|  19750626|20190923| 2021-07|    .00|\n|39356|      숙박업|        가포|         5670000|          폐업|  19630605|20031024| 2021-07|    .00|\n|39357|      숙박업|        호성|         5670000|          폐업|  19680930|20120713| 2021-07|  93.76|\n|39358|      숙박업|        미성|         5670000|          폐업|  19690107|20070411| 2021-07| 203.90|\n|39359|      숙박업|        세화|         5670000|          폐업|  19691013|20070207| 2021-07|  83.33|\n|39360|      숙박업|        창신|         5670000|          폐업|  19720919|20050318| 2021-07|  64.59|\n|39361|      숙박업|      청하장|         5670000|          폐업|  19721226|20180810| 2021-07| 190.28|\n|39362|      숙박업|    바비런던|         5670000|          폐업|  19670602|20070420| 2021-07| 684.00|\n|39363|      숙박업|        송미|         5670000|          폐업|  19670620|20070411| 2021-07|  85.80|\n|39364|      숙박업|        순풍|         5670000|          폐업|  19810324|20081120| 2021-07| 135.30|\n|39365|      숙박업|        청자|         5670000|          폐업|  19700109|20000522| 2021-07|  32.50|\n|39366|      숙박업|        몽고|         5670000|          폐업|  19700910|20000429| 2021-07|  60.67|\n+-----+------------+------------+----------------+--------------+----------+--------+--------+-------+\nonly showing top 100 rows</code></pre></div>\n<p>toPandas()를 활용하여 EDA를 진행하자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df <span class=\"token operator\">=</span> lodge<span class=\"token punctuation\">.</span>toPandas<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;class 'pandas.core.frame.DataFrame'>\nRangeIndex: 67328 entries, 0 to 67327\nData columns (total 9 columns):\n #   Column    Non-Null Count  Dtype \n---  ------    --------------  ----- \n 0   번호        67328 non-null  object\n 1   개방서비스명    67328 non-null  object\n 2   사업장명      67328 non-null  object\n 3   개방자치단체코드  67328 non-null  int32 \n 4   상세영업상태명   67328 non-null  object\n 5   인허가일자     67328 non-null  int32 \n 6   폐업일자      67328 non-null  int32 \n 7   갱신일자      67328 non-null  object\n 8   면적        67328 non-null  object\ndtypes: int32(3), object(6)\nmemory usage: 3.9+ MB</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>개방자치단체코드</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>5670000</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>5670000</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>5670000</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>5670000</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>5670000</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>6510000</td>\n      <td>등록취소</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>4870000</td>\n      <td>등록취소</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>30870.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>4620000</td>\n      <td>직권말소</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>4990000</td>\n      <td>직권말소</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>28359.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>4330000</td>\n      <td>직권말소</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 9 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">code <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\\\\자치단체코드.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">code<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;class 'pandas.core.frame.DataFrame'>\nRangeIndex: 230 entries, 0 to 229\nData columns (total 2 columns):\n #   Column  Non-Null Count  Dtype \n---  ------  --------------  ----- \n 0   지역구명    230 non-null    object\n 1   자치단체코드  230 non-null    int64 \ndtypes: int64(1), object(1)\nmemory usage: 3.7+ KB</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> code<span class=\"token punctuation\">[</span><span class=\"token string\">'자치단체코드'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> code<span class=\"token punctuation\">[</span><span class=\"token string\">'지역구명'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0        창원시\n1        창원시\n2        창원시\n3        창원시\n4        창원시\n        ... \n67323    제주시\n67324    구례군\n67325    태안군\n67326    완도군\n67327    인제군\nName: 개방자치단체코드, Length: 67328, dtype: object</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 개방자치단체코드 -> 지역</span>\nlodge_df<span class=\"token punctuation\">.</span>rename<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'개방자치단체코드'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>inplace<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>제주시</td>\n      <td>등록취소</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>구례군</td>\n      <td>등록취소</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>30870.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>태안군</td>\n      <td>직권말소</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>완도군</td>\n      <td>직권말소</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>28359.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>인제군</td>\n      <td>직권말소</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 9 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">temp1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ntemp2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 운영기간이라는 변수 생성</span>\n<span class=\"token comment\"># 운영기간 = 폐업일자 - 인허가일자 후 </span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp1 <span class=\"token operator\">-</span> temp2</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>제주시</td>\n      <td>등록취소</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>0.0</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>구례군</td>\n      <td>등록취소</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>30870.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>태안군</td>\n      <td>직권말소</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>완도군</td>\n      <td>직권말소</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>28359.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>인제군</td>\n      <td>직권말소</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>0</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 10 columns</p>\n</div>\n<h3 id=\"갱신일자-확인하기\" style=\"position:relative;\"><a href=\"#%EA%B0%B1%EC%8B%A0%EC%9D%BC%EC%9E%90-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"갱신일자 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>갱신일자 확인하기</h3>\n<p>분석을 진행하기전 갱신일자 현황을 알아보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">renewal_date <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'갱신일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrenewal_date</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-08    28001\n2021-07     2517\n2021-12     2102\n2022-01     2004\n2021-08     1567\n2018-11     1456\n2020-08     1364\n2021-10     1312\n2021-09     1241\n2021-04     1164\n2021-11     1157\n2021-06     1114\n2020-12     1093\n2021-05     1074\n2022-02     1066\n2019-07     1059\n2021-02     1040\n2018-10     1035\n2021-01      981\n2021-03      956\n2020-02      855\n2020-07      845\n2020-11      804\n2018-12      801\n2020-06      753\n2019-12      707\n2020-05      702\n2020-01      694\n2020-10      640\n2020-04      637\n2019-01      628\n2020-03      626\n2020-09      586\n2019-06      578\n2019-08      551\n2019-11      516\n2019-03      492\n2019-05      460\n2019-10      452\n2019-09      435\n2019-04      413\n2019-02      390\n2018-09      332\n2022-03      128\nName: 갱신일자, dtype: int64</code></pre></div>\n<p>위 자료는 2018년도 8월부터 2022년도 3월까지 특정주기로 갱신된 데이터인 것을 확인</p>\n<h3 id=\"1영업-상태와-폐업상태-건수를-알아보자\" style=\"position:relative;\"><a href=\"#1%EC%98%81%EC%97%85-%EC%83%81%ED%83%9C%EC%99%80-%ED%8F%90%EC%97%85%EC%83%81%ED%83%9C-%EA%B1%B4%EC%88%98%EB%A5%BC-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\" aria-label=\"1영업 상태와 폐업상태 건수를 알아보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.영업 상태와 폐업상태 건수를 알아보자</h3>\n<p>상세영업상태명을 영업, 폐업, 휴업 3가지로 분류</p>\n<p>※ 영업, 휴업을 제외한 자료는 모두 폐업으로 분류</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'영업중'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'영업'</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'영업'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'휴업'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span><span class=\"token string\">'폐업'</span>  </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">current_status <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nstatus_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>current_status<span class=\"token punctuation\">)</span>\nstatus_df <span class=\"token operator\">=</span> status_df<span class=\"token punctuation\">.</span>reset_index<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nstatus_df<span class=\"token punctuation\">.</span>rename<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'index'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'영업상태'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> inplace <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\nstatus_df</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>영업상태</th>\n      <th>상세영업상태명</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>영업</td>\n      <td>39135</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>폐업</td>\n      <td>27830</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>휴업</td>\n      <td>363</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># pie 차트 형태로 나타내기</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>pie<span class=\"token punctuation\">(</span>status_df<span class=\"token punctuation\">[</span><span class=\"token string\">'상세영업상태명'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> labels<span class=\"token operator\">=</span>status_df<span class=\"token punctuation\">[</span><span class=\"token string\">'영업상태'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  autopct<span class=\"token operator\">=</span><span class=\"token string\">'%.1f%%'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">([&lt;matplotlib.patches.Wedge at 0x2004c35c608>,\n  &lt;matplotlib.patches.Wedge at 0x2004c35cdc8>,\n  &lt;matplotlib.patches.Wedge at 0x2004c366688>],\n [Text(-0.27777047090880896, 1.0643512415979504, '영업'),\n  Text(0.25970348918010755, -1.068903221862334, '폐업'),\n  Text(1.0998422094675733, -0.01863100301881176, '휴업')],\n [Text(-0.1515111659502594, 0.5805552226897911, '58.1%'),\n  Text(0.141656448643695, -0.5830381210158184, '41.3%'),\n  Text(0.5999139324368581, -0.010162365282988231, '0.5%')])</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 449px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADr0lEQVQ4y22UXWgdRRTHz92NhaTdSaLWmmvuTBIRCyIKjYgKKhVBRdQHoaAPEUREiKSSZiZJk5nUD6SKor6ICKE1fjQIwWRGcqWx4KsfRUGhoj4UUQmC0FI17e7OkTM7N7mVDvw5M3tmfud/docFaBtCuc358JcId/+LNT6+lF735k8hx6VNhXKkGqe1chedgf/DhLLQu/cpuHEJk9bzxv5FuPaVb2PetcDApUuraEFIdwlYTPADn9T4xDI0nvu4l48vPSOU+4BLe0Io9zmX9j2u3IhQdjtXFriySXuhMLiMD2R7dfuEUO4PoRy2xKXFtvVpLt2j0URNtNonp1QpgmrBobQvtQ5zafOoQihX0Fwol3PKVeCJ6C4hY8SCaD2NiREhLbYBsDG26Pn4khfKeS6tD8WkK+KaoA+JylR4pzSpRVgPtckjMG7eglSOvZDOt9zH9n8Uym6LUNgkC+WejBvyzcPK+qo16wfUyqYESYZYCLWCQi0/IqZWoX90IaUXmYb+pVvgMhzOA6ia+0G1HOZXyybWZROvkU3sl03kqolcruZiYhXFRPOtxuiHMPwFJtXXDV/YrglFrVG7zg+qFRJeLtdQSOtvn5wv9kwdKW6aOlLcMH20GJqYLwanj240Zhawrt9fvAcROvp3d4bLXF0de5ycDChbDKll3CU/wyvlcb9v6nD51exweVZfVa6bvuL3ub7i9KF6cWpmV3Fqrr7x/Qv9+N2LjWOId8BtAx1dBGq1PE+O6nI175Un/N7Jd0o3c2+JptOj2YZodiDq7VsyIeaouxBnO1/768AOwJM7E2hIlw4oC0Nq+fEr5BrerD668O7BfeUF3Vui6cBSMyx0t/eGBZUt6RCLwjA8b3ruw+cZ/DaepXCLWqjBfgQYw8656dGf13UD0SQ5Ocp1j/eaeTQZep35UmceCawzRMNyNIziSdSshpoBCeBphF9mr09/1UOAc/Awmi4Codd0gEAEZPj3dObPTAYgwXOsoKS70DBAw9IK+CwCLgF8PbsnwUMAue4ZiyBSQU4CoHJE8yKCCDzSDkOdAfyp++Gc3gnndS+UurvmNQOv2f1o2A/kIrYXot9y9Y3X2Z1eZwRLCESidRixSktJjB1o2INo2OteZ4to2DGvs1fPTGYPfPpYJ5Q6I6UtGJrs4n8iQcgdJUILmwUywDkGZyczwLd7aOtliP8AvswSxN3VOcMu/ddud0qbUFM7wWmycTBL8HB3B+KtgG90A673AZ6rh73t4z+YG8VwE/JLrAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/9f9fef18cf352ada8be26283f975fa93/053a9/output_26_1.png\"\n        srcset=\"/static/9f9fef18cf352ada8be26283f975fa93/e9ff0/output_26_1.png 180w,\n/static/9f9fef18cf352ada8be26283f975fa93/f21e7/output_26_1.png 360w,\n/static/9f9fef18cf352ada8be26283f975fa93/053a9/output_26_1.png 449w\"\n        sizes=\"(max-width: 449px) 100vw, 449px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"2운영기간의-분포를-파악하자\" style=\"position:relative;\"><a href=\"#2%EC%9A%B4%EC%98%81%EA%B8%B0%EA%B0%84%EC%9D%98-%EB%B6%84%ED%8F%AC%EB%A5%BC-%ED%8C%8C%EC%95%85%ED%95%98%EC%9E%90\" aria-label=\"2운영기간의 분포를 파악하자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.운영기간의 분포를 파악하자</h3>\n<p>운영기간이라는 새로운 변수를 아래와 같은 식을 통해 생성</p>\n<p>운영기간(년도) = 폐업기간 - 인허가일자를 통해 운영기간을 구함</p>\n<ul>\n<li>우선 인허가일자와 폐업기간 속 오류를 정정하는 작업 시행</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">65386           0\n61838           0\n55414           0\n55416           0\n55419           0\n           ...   \n54742    20220228\n54743    20220228\n34531    20220228\n34532    20220228\n64686    20220228\nName: 인허가일자, Length: 67328, dtype: int32</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 한국 정부 설립일 1948년 8월 15일 전에 허가가 된 자료들은 설립일로 변경</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1931109</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19931109</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">19480815</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19480815</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">59790           0\n61838           0\n2078         2014\n18528      199909\n11873      200003\n           ...   \n38824    20220311\n38825    20220311\n38826    20220311\n38828    20220311\n33663    20220311\nName: 폐업일자, Length: 67328, dtype: int32</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 폐업일자가 48년도 이전으로 나타난 경우 19480101로 변경</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2014</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20140000</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">199909</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19990900</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">200003</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000300</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">200009</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000900</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">200204</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020400</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2001123</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20010123</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">19480814</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19480815</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">temp1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ntemp2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">temp1<span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    67328.000000\nmean      2017.290147\nstd          7.395865\nmin       1948.000000\n25%       2014.000000\n50%       2022.000000\n75%       2022.000000\nmax       2022.000000\nName: 폐업일자, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">temp2<span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    67328.000000\nmean      1999.503891\nstd         15.368706\nmin       1948.000000\n25%       1988.000000\n50%       2002.000000\n75%       2014.000000\nmax       2022.000000\nName: 인허가일자, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp1 <span class=\"token operator\">-</span> temp2</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    67328.000000\nmean        17.786255\nstd         13.367892\nmin          0.000000\n25%          6.000000\n50%         17.000000\n75%         27.000000\nmax         74.000000\nName: 운영기간, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\\\\lodge.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>운영기간을 아래와 같이 구분하여 비율을 파악해보자</p>\n<p>5년이하, 6~10년도, 11년-20년, 21년-30년, 31년-40년, 41년이상</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">period_1 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nperiod_2 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nperiod_3 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nperiod_4 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">21</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nperiod_5 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nperiod_6 <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'번호'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">41</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">period_3</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">15364</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 데이터프레임으로 만들고 Pie 차트 생성</span>\nperiod <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">'5년이하'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'6~10년'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'11년~20년'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'21~30년'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'31~40년'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'41년 이상'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token string\">'count'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span>period_1<span class=\"token punctuation\">,</span>period_2<span class=\"token punctuation\">,</span>period_3<span class=\"token punctuation\">,</span>period_4<span class=\"token punctuation\">,</span>period_5<span class=\"token punctuation\">,</span>period_6<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">period</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>운영기간</th>\n      <th>count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5년이하</td>\n      <td>15621</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>6~10년</td>\n      <td>10778</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>11년~20년</td>\n      <td>15364</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>21~30년</td>\n      <td>12558</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>31~40년</td>\n      <td>8690</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>41년 이상</td>\n      <td>4317</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># pie 차트 형태로 나타내기</span>\ncolors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'red'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orange'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'yellow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lightgreen'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'skyblue'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'purple'</span><span class=\"token punctuation\">]</span>\n\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>pie<span class=\"token punctuation\">(</span>period<span class=\"token punctuation\">[</span><span class=\"token string\">'count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> labels<span class=\"token operator\">=</span>period<span class=\"token punctuation\">[</span><span class=\"token string\">'운영기간'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> colors<span class=\"token operator\">=</span>colors<span class=\"token punctuation\">,</span> autopct<span class=\"token operator\">=</span><span class=\"token string\">'%.1f%%'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">([&lt;matplotlib.patches.Wedge at 0x20046d0c808>,\n  &lt;matplotlib.patches.Wedge at 0x2004783dcc8>,\n  &lt;matplotlib.patches.Wedge at 0x2004783d348>,\n  &lt;matplotlib.patches.Wedge at 0x20046d0dd08>,\n  &lt;matplotlib.patches.Wedge at 0x20046c04408>,\n  &lt;matplotlib.patches.Wedge at 0x20048244288>],\n [Text(0.8205043395252873, 0.7326476839656099, '5년이하'),\n  Text(-0.4181049594406049, 1.017442009596208, '6~10년'),\n  Text(-1.099167184528615, -0.042796033174087755, '11년~20년'),\n  Text(-0.2497172067103892, -1.0712802232248857, '21~30년'),\n  Text(0.7597575682132678, -0.7954674333639699, '31~40년'),\n  Text(1.0777583984691492, -0.2200836989175137, '41년 이상')],\n [Text(0.4475478215592476, 0.39962600943578713, '23.2%'),\n  Text(-0.22805725060396628, 0.5549683688706589, '16.0%'),\n  Text(-0.5995457370156081, -0.023343290822229683, '22.8%'),\n  Text(-0.1362093854783941, -0.584334667213574, '18.7%'),\n  Text(0.4144132190254187, -0.4338913272894381, '12.9%'),\n  Text(0.5878682173468086, -0.12004565395500746, '6.4%')])</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 488px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAADyklEQVQ4y3WUb0hedRTHP/c+z+OWCaPaslmUrCG1YBaxGHuxKBgRvaheFNWLSHAQwvai3hiCbNZ8HnV6r4ptRVsxdS3KZGztT/8Guc2tNLHcWkQW5SL1+aNz83H33t85cZ/H/SnbgcM59/L7fX7fc+7vXPiPrSuDB+4CVdAjRPQgyEcgbSDLQaJEFGwFQhduYNqdj8VL4K3nKAAKdAD0Vyyzj2J1Wa53cJNE86AQeml+770LYKEaF95bDZrG1h4428g9/h4S2sl38jHj2kBSopxR2K02a/S6/eXAigXA0Iex9WxO7bO6l5R2o9qFag8qtfklYqGSX751HlpUAouKFsC+IaKnQAd5WkJIJ2q68bK7CEwPRjcRCBi18RQkB4ftIbQSYiGr9DqglYsBxaIkZRTVbjzzAXpxFxJ8guhLmBAU2OhlMALBvJYnp4EsRA5fURkERMLjRNiigoriySRGezH6Pqq9qDyRB3o2cgHUgC/5+PWVL+5h548IbWo6l58UQVUIVFHJYuQoxuyzRNfkgKr21S7JfJxTKJ2HWoyM5Mv1fW4T4Y8Q5HmYwENyULFEhwn8O/HDUj0ixosUGN8qMB7RwCOqcxSs94lxiZjNypUUAjcfP06JKmMhZGYGM5tFRCwNn3+W8mBnV7fX8Vh70B7bHLRSaVrYaNrtzUGbtUk7qHq8hVf5kDfy+k+ezGmPijKYK1kJRHMwGcmuDZrTzZKY/NzUnZmTut5RqX3lkKle1mRqqNUatpjNsa2rgFgxyws5dgw8j8h8Y9pCoAheCPs+uz5oSr0tTsZRd7zNNAz9buqHk7rt7KQk+s7726q/0roHdwzUg81wubWK+6522DZiYcS+XxU/LPP07Aa/MbVDnKSjLRMt4mYapemXfvPmiQnd2vebxH9IefFzUxofvbAxPjDB7qRGCll87WJngqVXVL52fPYpTSTfkda04zf/3SQNfzaKO7Vdm8/vDeKDaT8+NOnVD0xo/Nvx3oqfTud6VLnnAEu55dq0dKQTdE+/bv04t5aG5M4aN+2om3LUTbuhGyflSJgnRs5p/UBa40MTn74QfzecuMLVG56JLllWgoWVB4rA0YsvcmCmIj+kyU5aM8761kzrfjftTjkpR52Uq26m6XLT6Bf9205nK2r2KzOqlD60dvH//r6+vPg8h2Zepqv/ET7TnfYJ7Qtfx6r7q+9un2l/2Em1rHOS7SvC6xsf+ovaU4c5qGrdvqKMG5qbdq/mVb1VkbJHyxYN6iCNY420ZlycVBsXFOJDY5HEoMn1rujWZf+C/AMvn5CAa4myZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/20e48bba1ac012a32fef541393ced750/bd48c/output_44_1.png\"\n        srcset=\"/static/20e48bba1ac012a32fef541393ced750/e9ff0/output_44_1.png 180w,\n/static/20e48bba1ac012a32fef541393ced750/f21e7/output_44_1.png 360w,\n/static/20e48bba1ac012a32fef541393ced750/bd48c/output_44_1.png 488w\"\n        sizes=\"(max-width: 488px) 100vw, 488px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"3-숙박업이-발달한-지역-알아보기\" style=\"position:relative;\"><a href=\"#3-%EC%88%99%EB%B0%95%EC%97%85%EC%9D%B4-%EB%B0%9C%EB%8B%AC%ED%95%9C-%EC%A7%80%EC%97%AD-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"3 숙박업이 발달한 지역 알아보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 숙박업이 발달한 지역 알아보기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 0이거나 999로 표기된 자료는 알수없음으로 변경</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'알수없음'</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">999</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'알수없음'</span>                </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_count <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'지역'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_count<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">서울특별시    9765\n부산광역시    4742\n인천광역시    2985\n대구광역시    1932\n대전광역시    1561\n광주광역시    1494\n제주시      1468\n창원시      1364\n울산광역시    1233\n전주시      1222\n태안군      1059\n여수시      1026\n경주시      1012\n수원시       981\n서귀포시      968\n강릉시       878\n가평군       877\n청주시       804\n포항시       769\n성남시       742\n순천시       615\n보령시       612\n양양군       601\n목포시       601\n부천시       594\n춘천시       519\n고성군       511\n구미시       493\n거제시       491\n진주시       487\nName: 지역, dtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_count<span class=\"token punctuation\">.</span>tail<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">광주시     93\n군포시     92\n진천군     89\n장성군     84\n성주군     83\n봉화군     83\n예천군     79\n장흥군     79\n곡성군     79\n옥천군     78\n함안군     72\n영동군     68\n의성군     68\n고령군     66\n군위군     59\n청양군     58\n진도군     57\n증평군     53\n순창군     48\n하남시     47\n함평군     46\n진안군     44\n알수없음    40\n의령군     38\n임실군     35\n영양군     35\n계룡시     29\n장수군     26\n의왕시     21\n과천시      9\nName: 지역, dtype: int64</code></pre></div>\n<p><img src=\"/c0aaa7d37a3a089a72dd5a6f594448a8/5_1.png\" alt=\"5_1.PNG\"></p>\n<p>세종시,창원시, 경남 고성군의 경우 아래와 같이 구글맵에서 나타나지 않아 제외</p>\n<p><img src=\"/e4fa8872f94475095a21353cb3719b34/9_2.png\" alt=\"9_2.PNG\"><img src=\"/ab869a39daa92bd9ac1ec60561ee1acf/9_1.png\" alt=\"9_1.PNG\"></p>\n<h3 id=\"4면적-분포-확인하기\" style=\"position:relative;\"><a href=\"#4%EB%A9%B4%EC%A0%81-%EB%B6%84%ED%8F%AC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"4면적 분포 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.면적 분포 확인하기</h3>\n<p>소재지면적에 대한 자세한 조항이 없기 때문에 데이터 및 소재지라는 점을 봤을 때 대지면적으로 판단하는 것이 옳다고 판단</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">size <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">size<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>ascending<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">27939    9999.66\n58416    9999.02\n52110    9999.00\n50813    9999.00\n50828    9999.00\n          ...   \n17099        .00\n17098        .00\n6053         .00\n6054         .00\n17213        .00\nName: 면적, Length: 67328, dtype: object</code></pre></div>\n<h3 id=\"trouble-shooting\" style=\"position:relative;\"><a href=\"#trouble-shooting\" aria-label=\"trouble shooting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Trouble Shooting</h3>\n<ol>\n<li>\n<p>면적 데이터 타입이 object를 int 형으로 변환</p>\n</li>\n<li>\n<p>일반적인 면적 분포를 파악하기 알고 싶었으나 사업장의 면적과 같은 부분은 자치구에서 중요하게 관리하는 부분이 아니라 아래와 같이 신뢰하기 힘든 데이터가 다수 포함. box plot을 통해 이상값은 0(알수없음)으로 변경</p>\n</li>\n</ol>\n<p><img src=\"/8a77a7d775c89bf91334d2005d6cb50c/9_4.png\" alt=\"9_4.PNG\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 1. 데이터형 변환</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 2. 면적의 최대값 설정하기</span>\n<span class=\"token comment\"># boxplot 에서 이상값 경계치를 최대값으로 설정</span>\n<span class=\"token comment\"># 0으로 설정된 부분은 중앙값으로 대체</span>\n\nfind_max <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 중앙 값 확인</span>\nfind_max<span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    6.732800e+04\nmean     4.301137e+03\nstd      4.170719e+05\nmin      0.000000e+00\n25%      8.320000e+01\n50%      3.355200e+02\n75%      8.560000e+02\nmax      9.933791e+07\nName: 면적, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 건물부지 최소크기는 60이므로 그 이하의 값은 중앙값으로 대체</span>\n<span class=\"token comment\"># 98년도 이전 건물에는 해당 x -- 하지만 숙박업종 특성상 최소값을 지정하는 것이 옳다고 판단</span>\nfind_max<span class=\"token punctuation\">[</span>find_max <span class=\"token operator\">&lt;=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">335</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 5000이상의 값을 0으로 한뒤 boxplot으로 최대값 확인</span>\nfind_max<span class=\"token punctuation\">[</span>find_max <span class=\"token operator\">>=</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>boxplot<span class=\"token punctuation\">(</span>find_max<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{'whiskers': [&lt;matplotlib.lines.Line2D at 0x200471a50c8>,\n  &lt;matplotlib.lines.Line2D at 0x20047624148>],\n 'caps': [&lt;matplotlib.lines.Line2D at 0x200476240c8>,\n  &lt;matplotlib.lines.Line2D at 0x2004762aec8>],\n 'boxes': [&lt;matplotlib.lines.Line2D at 0x20047179488>],\n 'medians': [&lt;matplotlib.lines.Line2D at 0x2004762afc8>],\n 'fliers': [&lt;matplotlib.lines.Line2D at 0x20047603fc8>],\n 'means': []}</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 379px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABrElEQVQ4y61STU/bQBAdClz6A0CIlrb8ufyO+ORTjrlEOUS59uYGW0IgLtQKyoFTkKM4sqrmAzXZzUb7gbG9i9Z10CZNSA886WnHM7Nv33oHAOBjqVT6OpvNLjnnd4yxn4wxf0lKqZ8kid/pdPwoivw4jvOc2cMYuxVC3I9GowoopcDzvBMhxLPaACllvnqep3q9nnoL8/n8CgDg0LKsc875rBBIpJTpkhpKqdR13TQIgjzOsiw1e6SUsd6LEHJyh81m85RzjgtBaZ76V08p13VVEAR5nGXZ+i3yJoxxSzs8sG3723sK7tVqtc+bBHW4TdA8d13wQ7VaPdvlUD/K/zrcr1QqX3Y5dBxHdbvd3Q71ozQajU+m4BLLT72GYSgxxis5AysOD8vlsh6baSGo5zHR1COkV0ppghBKFotFIoRYqRVxXAg6UK/Xod1uH1NKX69pUoOgP+p3+KAef4WK0cXWPoTQDUwmE7Bt+2g4HH4nhHjaNsb4wiQhpDUYDLzxeJzH63WM8Q9CyHUURWXo9/tgWRYQQkBKCWmarlDnBOf5v34S/J+62TedTuEFq96WUYpKuSIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/e4afa60f3fa60053c7a0552016c2b565/811d1/output_61_1.png\"\n        srcset=\"/static/e4afa60f3fa60053c7a0552016c2b565/e9ff0/output_61_1.png 180w,\n/static/e4afa60f3fa60053c7a0552016c2b565/f21e7/output_61_1.png 360w,\n/static/e4afa60f3fa60053c7a0552016c2b565/811d1/output_61_1.png 379w\"\n        sizes=\"(max-width: 379px) 100vw, 379px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위 과정을 통해 max값을 1500으로 설정</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">1500.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    67328.000000\nmean       391.468432\nstd        340.166903\nmin          0.000000\n25%        134.657500\n50%        335.000000\n75%        515.840000\nmax       1500.000000\nName: 면적, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">bins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span><span class=\"token number\">700</span><span class=\"token punctuation\">,</span><span class=\"token number\">900</span><span class=\"token punctuation\">,</span><span class=\"token number\">1100</span><span class=\"token punctuation\">,</span><span class=\"token number\">1300</span><span class=\"token punctuation\">,</span><span class=\"token number\">1500</span><span class=\"token punctuation\">]</span>\nlabels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'알수없음'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'100미만'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100이상~300미만'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'300이상~500미만'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'500이상~700미만'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'700이상~900미만'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'900이상~1100미만'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1100이상~1300미만'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1300이상~1500'</span><span class=\"token punctuation\">]</span>\nsize_bins <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'면적'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bins<span class=\"token punctuation\">,</span> right<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> labels<span class=\"token operator\">=</span>labels<span class=\"token punctuation\">)</span>\n\nsize_bins</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0              100미만\n1        100이상~300미만\n2              100미만\n3        100이상~300미만\n4        300이상~500미만\n            ...     \n67323    300이상~500미만\n67324           알수없음\n67325    300이상~500미만\n67326           알수없음\n67327    300이상~500미만\nName: 면적, Length: 67328, dtype: category\nCategories (9, object): ['알수없음' &lt; '100미만' &lt; '100이상~300미만' &lt; '300이상~500미만' ... '700이상~900미만' &lt; '900이상~1100미만' &lt; '1100이상~1300미만' &lt; '1300이상~1500']</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">count_size <span class=\"token operator\">=</span> size_bins<span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span>sort<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\ncount_size</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">알수없음              8778\n100미만             4845\n100이상~300미만      13215\n300이상~500미만      23203\n500이상~700미만       5999\n700이상~900미만       4103\n900이상~1100미만      3419\n1100이상~1300미만     2051\n1300이상~1500       1715\nName: 면적, dtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>            \nbars <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">,</span> count_size<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># access the bar attributes to place the text in the appropriate location</span>\n<span class=\"token keyword\">for</span> bar <span class=\"token keyword\">in</span> bars<span class=\"token punctuation\">:</span>\n    yval <span class=\"token operator\">=</span> bar<span class=\"token punctuation\">.</span>get_height<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>bar<span class=\"token punctuation\">.</span>get_x<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> yval <span class=\"token operator\">+</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> yval<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQY031Q3StDcRg+Vy7kTkqUWgj3yt+jkLJ8tYtFuXDjwhXJjZB85WMbS1jZ7LeZGGe+Y+Zjxo6PzTZNjnPO+/5enW0phaeei+fpeZ+eXkEURYOqqhEAeNI0TQLQpE9FlYi45DiJSnW9a9LpfSKjFVWT9MwvjAJATJblXcHlctYgckLOidNPWAMPlNe8SGI4kdF65j/ow4S9/UAlEVdyHuq8jb3j3O4tDm+GsKhjCffDrxlfBURAjsg5InLk/JuQK7wWLg78VfG0LFv2wviY+tCICFaOolDQYoG22QCUmuxwGEnqB3+TczVbqIQEerup8V6+UH6LlQadIbKKdzTkClF51yq1zx1SRfca9TuC1DThJ99VnDzBZ4okPugsmiIFOAFmX8WzC18EomQJO5ccBpPFa5zybxQa590NY9uuarPN0zzuY1VmG6sf8bLi1nnWOLrlLutc8HRO77DaHjsbWD9mHZPbbMZ36e5bDviSb+mpLzU2mbP/BLKKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/85f27671a3b48a691bb96059e3267a3a/37523/output_67_0.png\"\n        srcset=\"/static/85f27671a3b48a691bb96059e3267a3a/e9ff0/output_67_0.png 180w,\n/static/85f27671a3b48a691bb96059e3267a3a/f21e7/output_67_0.png 360w,\n/static/85f27671a3b48a691bb96059e3267a3a/37523/output_67_0.png 720w,\n/static/85f27671a3b48a691bb96059e3267a3a/f1901/output_67_0.png 942w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>번호</th>\n      <th>개방서비스명</th>\n      <th>사업장명</th>\n      <th>지역</th>\n      <th>상세영업상태명</th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>갱신일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>숙박업</td>\n      <td>산호장여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>숙박업</td>\n      <td>새한여관</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>숙박업</td>\n      <td>삼성</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>숙박업</td>\n      <td>승정원</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>숙박업</td>\n      <td>에스모텔</td>\n      <td>창원시</td>\n      <td>폐업</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>자동차야영장업</td>\n      <td>캠핑스타</td>\n      <td>제주시</td>\n      <td>폐업</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>자동차야영장업</td>\n      <td>지리산 호수공원 오토캠핑장</td>\n      <td>구례군</td>\n      <td>폐업</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>자동차야영장업</td>\n      <td>마린오토캠핑장</td>\n      <td>태안군</td>\n      <td>폐업</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>자동차야영장업</td>\n      <td>명사십리 신리야영장</td>\n      <td>완도군</td>\n      <td>폐업</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>자동차야영장업</td>\n      <td>인제나르샤파크 캠핑장</td>\n      <td>인제군</td>\n      <td>폐업</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows × 10 columns</p>\n</div>\n<h3 id=\"5년도별-인허가-및-폐업상황-그래프로-확인\" style=\"position:relative;\"><a href=\"#5%EB%85%84%EB%8F%84%EB%B3%84-%EC%9D%B8%ED%97%88%EA%B0%80-%EB%B0%8F-%ED%8F%90%EC%97%85%EC%83%81%ED%99%A9-%EA%B7%B8%EB%9E%98%ED%94%84%EB%A1%9C-%ED%99%95%EC%9D%B8\" aria-label=\"5년도별 인허가 및 폐업상황 그래프로 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.년도별 인허가 및 폐업상황 그래프로 확인</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    6.732800e+04\nmean     1.999573e+07\nstd      1.536549e+05\nmin      1.948082e+07\n25%      1.988030e+07\n50%      2.002040e+07\n75%      2.014072e+07\nmax      2.022023e+07\nName: 인허가일자, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    6.732800e+04\nmean     2.017336e+07\nstd      7.383296e+04\nmin      1.948082e+07\n25%      2.014110e+07\n50%      2.022031e+07\n75%      2.022031e+07\nmax      2.022031e+07\nName: 폐업일자, dtype: float64</code></pre></div>\n<p>1948년부터 2022년도까지의 허가 및 폐업건수를 확인해보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'인허가일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'int'</span><span class=\"token punctuation\">)</span>\nlodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'폐업일자'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'int'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start <span class=\"token operator\">=</span> start<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>ascending<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2003    4742\n2015    2826\n2016    2630\n2017    2364\n2018    2154\n2021    2087\n2000    2077\n2019    2063\n2002    1989\n2001    1833\nName: start_year, dtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">71</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start<span class=\"token punctuation\">[</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> start<span class=\"token punctuation\">.</span>index</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">start</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>start_year</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2003</th>\n      <td>4742</td>\n      <td>2003</td>\n    </tr>\n    <tr>\n      <th>2015</th>\n      <td>2826</td>\n      <td>2015</td>\n    </tr>\n    <tr>\n      <th>2016</th>\n      <td>2630</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>2017</th>\n      <td>2364</td>\n      <td>2017</td>\n    </tr>\n    <tr>\n      <th>2018</th>\n      <td>2154</td>\n      <td>2018</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1954</th>\n      <td>2</td>\n      <td>1954</td>\n    </tr>\n    <tr>\n      <th>1955</th>\n      <td>2</td>\n      <td>1955</td>\n    </tr>\n    <tr>\n      <th>1952</th>\n      <td>1</td>\n      <td>1952</td>\n    </tr>\n    <tr>\n      <th>1957</th>\n      <td>1</td>\n      <td>1957</td>\n    </tr>\n    <tr>\n      <th>1949</th>\n      <td>1</td>\n      <td>1949</td>\n    </tr>\n  </tbody>\n</table>\n<p>71 rows × 2 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">end <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">[</span><span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nend <span class=\"token operator\">=</span> end<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>ascending<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>end<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">47</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">end<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2022    39889\n2003     2275\n2018     1851\n2021     1721\n2020     1617\n2019     1538\n2017     1538\n2006     1327\n2005     1327\n2004     1286\nName: end_year, dtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">end <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>end<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">end<span class=\"token punctuation\">[</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> end<span class=\"token punctuation\">.</span>index</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">end</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>end_year</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2022</th>\n      <td>39889</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>2003</th>\n      <td>2275</td>\n      <td>2003</td>\n    </tr>\n    <tr>\n      <th>2018</th>\n      <td>1851</td>\n      <td>2018</td>\n    </tr>\n    <tr>\n      <th>2021</th>\n      <td>1721</td>\n      <td>2021</td>\n    </tr>\n    <tr>\n      <th>2020</th>\n      <td>1617</td>\n      <td>2020</td>\n    </tr>\n    <tr>\n      <th>2019</th>\n      <td>1538</td>\n      <td>2019</td>\n    </tr>\n    <tr>\n      <th>2017</th>\n      <td>1538</td>\n      <td>2017</td>\n    </tr>\n    <tr>\n      <th>2006</th>\n      <td>1327</td>\n      <td>2006</td>\n    </tr>\n    <tr>\n      <th>2005</th>\n      <td>1327</td>\n      <td>2005</td>\n    </tr>\n    <tr>\n      <th>2004</th>\n      <td>1286</td>\n      <td>2004</td>\n    </tr>\n    <tr>\n      <th>2016</th>\n      <td>1182</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>2007</th>\n      <td>1177</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2002</th>\n      <td>1039</td>\n      <td>2002</td>\n    </tr>\n    <tr>\n      <th>2015</th>\n      <td>985</td>\n      <td>2015</td>\n    </tr>\n    <tr>\n      <th>2008</th>\n      <td>928</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>2012</th>\n      <td>911</td>\n      <td>2012</td>\n    </tr>\n    <tr>\n      <th>2014</th>\n      <td>900</td>\n      <td>2014</td>\n    </tr>\n    <tr>\n      <th>2010</th>\n      <td>823</td>\n      <td>2010</td>\n    </tr>\n    <tr>\n      <th>2011</th>\n      <td>811</td>\n      <td>2011</td>\n    </tr>\n    <tr>\n      <th>2009</th>\n      <td>775</td>\n      <td>2009</td>\n    </tr>\n    <tr>\n      <th>2013</th>\n      <td>756</td>\n      <td>2013</td>\n    </tr>\n    <tr>\n      <th>2001</th>\n      <td>612</td>\n      <td>2001</td>\n    </tr>\n    <tr>\n      <th>2000</th>\n      <td>444</td>\n      <td>2000</td>\n    </tr>\n    <tr>\n      <th>1999</th>\n      <td>358</td>\n      <td>1999</td>\n    </tr>\n    <tr>\n      <th>1998</th>\n      <td>263</td>\n      <td>1998</td>\n    </tr>\n    <tr>\n      <th>1997</th>\n      <td>230</td>\n      <td>1997</td>\n    </tr>\n    <tr>\n      <th>1995</th>\n      <td>202</td>\n      <td>1995</td>\n    </tr>\n    <tr>\n      <th>1996</th>\n      <td>166</td>\n      <td>1996</td>\n    </tr>\n    <tr>\n      <th>1994</th>\n      <td>124</td>\n      <td>1994</td>\n    </tr>\n    <tr>\n      <th>1993</th>\n      <td>110</td>\n      <td>1993</td>\n    </tr>\n    <tr>\n      <th>1992</th>\n      <td>39</td>\n      <td>1992</td>\n    </tr>\n    <tr>\n      <th>1991</th>\n      <td>31</td>\n      <td>1991</td>\n    </tr>\n    <tr>\n      <th>1987</th>\n      <td>23</td>\n      <td>1987</td>\n    </tr>\n    <tr>\n      <th>1989</th>\n      <td>23</td>\n      <td>1989</td>\n    </tr>\n    <tr>\n      <th>1990</th>\n      <td>21</td>\n      <td>1990</td>\n    </tr>\n    <tr>\n      <th>1986</th>\n      <td>6</td>\n      <td>1986</td>\n    </tr>\n    <tr>\n      <th>1985</th>\n      <td>4</td>\n      <td>1985</td>\n    </tr>\n    <tr>\n      <th>1988</th>\n      <td>3</td>\n      <td>1988</td>\n    </tr>\n    <tr>\n      <th>1948</th>\n      <td>3</td>\n      <td>1948</td>\n    </tr>\n    <tr>\n      <th>1967</th>\n      <td>2</td>\n      <td>1967</td>\n    </tr>\n    <tr>\n      <th>1975</th>\n      <td>2</td>\n      <td>1975</td>\n    </tr>\n    <tr>\n      <th>1984</th>\n      <td>1</td>\n      <td>1984</td>\n    </tr>\n    <tr>\n      <th>1968</th>\n      <td>1</td>\n      <td>1968</td>\n    </tr>\n    <tr>\n      <th>1983</th>\n      <td>1</td>\n      <td>1983</td>\n    </tr>\n    <tr>\n      <th>1980</th>\n      <td>1</td>\n      <td>1980</td>\n    </tr>\n    <tr>\n      <th>1974</th>\n      <td>1</td>\n      <td>1974</td>\n    </tr>\n    <tr>\n      <th>1972</th>\n      <td>1</td>\n      <td>1972</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">year <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1948</span><span class=\"token punctuation\">,</span><span class=\"token number\">2023</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    year<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">year_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">year_df<span class=\"token punctuation\">[</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> year_df<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># start</span>\nstart <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>merge<span class=\"token punctuation\">(</span>year_df<span class=\"token punctuation\">,</span>start<span class=\"token punctuation\">,</span>how<span class=\"token operator\">=</span><span class=\"token string\">'outer'</span><span class=\"token punctuation\">,</span> on<span class=\"token operator\">=</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">)</span>\nstart <span class=\"token operator\">=</span> start<span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># end</span>\nend <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>merge<span class=\"token punctuation\">(</span>year_df<span class=\"token punctuation\">,</span>end<span class=\"token punctuation\">,</span>how<span class=\"token operator\">=</span><span class=\"token string\">'outer'</span><span class=\"token punctuation\">,</span> on<span class=\"token operator\">=</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">)</span>\nend <span class=\"token operator\">=</span> end<span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 위 분석 1 과정을 통해 현재 운영중인 39135 업소를 2022에서 제외</span>\nend<span class=\"token punctuation\">[</span><span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">74</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>end<span class=\"token punctuation\">[</span><span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">74</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">39135</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> start<span class=\"token punctuation\">[</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"open\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">[</span><span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">'closed'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'upper right'</span><span class=\"token punctuation\">,</span> fontsize<span class=\"token operator\">=</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;matplotlib.legend.Legend at 0x2004873ad48></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABaElEQVQoz5VQ7WobMRC89+gz5E8b+nZ9g15iQx+sYDDYOE2gzXF1pbvT3Um6/dIWKbZx0x8hC4N2B3Y0O1XTNDdE9JuZO2Y2zGzfggjbKYAFJCsiFgCM7TrXtu33arPZfE4p6XvLBVSW014SZSKdvf9ZHQ6HjyKChU9J0htV1iUlF/A0F07yPiI+Vvv9/pOI0EnwP6tnKr/XvYt04QJQEQSAp+zwH8HXAtdC5yJJ2g8uWy3+xojigXTJgrvd7vaV4PUpF7C85EEsyUxLmvtjUsaEogkXL94ZDTE+VdvtNjtcTjnQGZyUAgohJ/LApffAPINQBCQIEwU/0zQ6UopIEDXG8FD9em5umUkTowqBMoICLPm38sYlKiGoCpY5QzmWc3N0wniJIS6LqR5+PH5wQ1/3f9q1d7Y+ts3ammM9dcdVdOY+OHM32nYdxq52pl3H0dZu6Ffz7O9jCHfjNK1CCF/H0X0bhuHLX+0eri1likDkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/8b4ca2f9bcf8a318f8489557725607d1/37523/output_93_1.png\"\n        srcset=\"/static/8b4ca2f9bcf8a318f8489557725607d1/e9ff0/output_93_1.png 180w,\n/static/8b4ca2f9bcf8a318f8489557725607d1/f21e7/output_93_1.png 360w,\n/static/8b4ca2f9bcf8a318f8489557725607d1/37523/output_93_1.png 720w,\n/static/8b4ca2f9bcf8a318f8489557725607d1/96658/output_93_1.png 881w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>위 과정에서 2003년도에 큰 변화가 생긴 이유</li>\n</ul>\n<p><img src=\"/e9af2ddda009907392e863df86be2b46/10_1.png\" alt=\"10_1.PNG\">\n[출처]<a href=\"http://www.sukbakmagazine.com/news/articleView.html?idxno=52799\">http://www.sukbakmagazine.com/news/articleView.html?idxno=52799</a></p>\n<h3 id=\"6-변수-간-상관관계-알아보기\" style=\"position:relative;\"><a href=\"#6-%EB%B3%80%EC%88%98-%EA%B0%84-%EC%83%81%EA%B4%80%EA%B4%80%EA%B3%84-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"6 변수 간 상관관계 알아보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 변수 간 상관관계 알아보기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge_df<span class=\"token punctuation\">.</span>corr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>인허가일자</th>\n      <th>폐업일자</th>\n      <th>면적</th>\n      <th>운영기간</th>\n      <th>start_year</th>\n      <th>end_year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>인허가일자</th>\n      <td>1.000000</td>\n      <td>0.493592</td>\n      <td>0.053949</td>\n      <td>-0.876587</td>\n      <td>0.999997</td>\n      <td>0.493592</td>\n    </tr>\n    <tr>\n      <th>폐업일자</th>\n      <td>0.493592</td>\n      <td>1.000000</td>\n      <td>0.079687</td>\n      <td>-0.014153</td>\n      <td>0.493536</td>\n      <td>0.999994</td>\n    </tr>\n    <tr>\n      <th>면적</th>\n      <td>0.053949</td>\n      <td>0.079687</td>\n      <td>1.000000</td>\n      <td>-0.017867</td>\n      <td>0.053939</td>\n      <td>0.079792</td>\n    </tr>\n    <tr>\n      <th>운영기간</th>\n      <td>-0.876587</td>\n      <td>-0.014153</td>\n      <td>-0.017867</td>\n      <td>1.000000</td>\n      <td>-0.876621</td>\n      <td>-0.014149</td>\n    </tr>\n    <tr>\n      <th>start_year</th>\n      <td>0.999997</td>\n      <td>0.493536</td>\n      <td>0.053939</td>\n      <td>-0.876621</td>\n      <td>1.000000</td>\n      <td>0.493536</td>\n    </tr>\n    <tr>\n      <th>end_year</th>\n      <td>0.493592</td>\n      <td>0.999994</td>\n      <td>0.079792</td>\n      <td>-0.014149</td>\n      <td>0.493536</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">corr <span class=\"token operator\">=</span> lodge_df<span class=\"token punctuation\">.</span>corr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span>figsize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nsns<span class=\"token punctuation\">.</span>heatmap<span class=\"token punctuation\">(</span>corr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>corr <span class=\"token operator\">>=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span>corr <span class=\"token operator\">&lt;=</span> <span class=\"token operator\">-</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> cmap <span class=\"token operator\">=</span> <span class=\"token string\">'viridis'</span><span class=\"token punctuation\">,</span> vmax <span class=\"token operator\">=</span> <span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span> linewidth <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> annot <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> annot_kws <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> square <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;matplotlib.axes._subplots.AxesSubplot at 0x20047647e08></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAElElEQVQ4y22TfUxTVxjGT7Ys2ZKFLbot2USjsrEhRAl+i6hb9SK2FAoFwfLRwmx0GR8VZxZn1OE0jE75avxItmXD+IdhY6tKxG0mc8KKFlEoG0JBVgaXIrTQ0km5957zLL3o9sf2/vWc5Dm/nOd930PYxHpFkI/xYCxy5LIziS+wG/jiO7v4nikHD4D3Ppzk8994j99IdvIfKtJ45onmMRrJX3NyfIFdP2LqyJ3c3bF/8yN+/om+3nCOjN5blgl3BOAOh9W5FZqWfOTbstA95UCoJtxeaOblIpYko2TVNsC7FBhdiGbnO9C05KGwTYe8jrLEdteCM82/R6jJjbaN2p6h9RgYWi1dcW6nZkcarelOpi7/PQqA+if99ITuFC1aV06ri8to78ha2u9aTa86E6nZoZHqftPgbI+BO9e7oa7ubryKmBzFO/a2G5DVZqQ/9G9neBgBjEYCsy1g8hsFPCmXNIh37bnY1WbEZacy5KVwRwPeOG73nSzLgdsaFdE1qrN3305FeouWXu5dx8DPR3D4ZbBZuwwJQUVJksX9qW7obUpktmjxzf34kJfODC8AJhZxb98osWRcNySTK4ON6ubR7/D9iJX2e84zBGohTZ8Gmz4DNl0DFvgSlAZkuCc4jib+W1h5K3onLoS8VPSfBmg9t9S635LQdEBFWBDqx4lCPWPsycGTC3HoaUjuFWDSGBj+UyEvpXOaC/v6A0v0hfJk4vV5Nf8CKWNMeAwshDT8EuhYAhid/B8gY4yJlM75uWdrD1ve/NysJBU5tUmHUytg2nSI3mhole+JIgUTHGDBX8BmrkOcKAUCejywleIjVSXKthzCj+d/DnmpIIoy8PnycktUZaWaJJAUzWaSjuVEQeuPNMhAKrB/BgL2F+hYHBB4AXcbo7CeaBFHOJwtOy8DJUEOzc0zHbPEflytJNrFGRnZ4buw/ZkkerHqoszwz/gg0dm56OI4fH0KBF2vo70hHtpXdFA+p0T98XoZ6JvxycBXCz6xrCw1q4nfuSlpzBGLQFcUvdSdxkxdpTjYuQdOf48MnByfRNFaI9Rh6TianArP/Vj4OqNw1ZHKTJ0l9FDn+6h27+NiMqosawo/VZKHjmVaTEQAnnB6qV/BUm7mIPfXDDimuua+3qgXKS/mYzlJRfHKRMC/FBhfiGsDW1jKTR3V27Kxb1jPrVWcssSnHUsm7R0J6QND6zA8tIo2OXew4107mdmRxgb9naFIzOf1s6PpFcy4/CA7uaeI/cGvYX+6VrFmZxI73pVJTzoy8ZVXx21YUWFRKI6oSEnX3iSjPQcZNoPQ3L9VxNgiCfwSCbOtIgOkUBdDgwcgDQoDYsGtLCnLZpCsfZwI90KB8ZEAIretfq28VhVXpiLG5mxd0R0dctvycNW5FXAvwSwfARZsfbxtEiQqybrP34O99kzo2/Jg7eMA92IER94CELNjzVNFX6gWFWjIvlZjjMmurzO0Flb/9EBVKQ1G1Uy7Yqog3KqcCaIKTDILovCZ8EisGQj0mYtu55wqtBVWNw2kVDJXVFXAFVsHbIhcSXI0iWGa6L8ByijTsGr1EIUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/2a0d2792337caea649bb50d5c54d2662/37523/output_97_1.png\"\n        srcset=\"/static/2a0d2792337caea649bb50d5c54d2662/e9ff0/output_97_1.png 180w,\n/static/2a0d2792337caea649bb50d5c54d2662/f21e7/output_97_1.png 360w,\n/static/2a0d2792337caea649bb50d5c54d2662/37523/output_97_1.png 720w,\n/static/2a0d2792337caea649bb50d5c54d2662/ea7fb/output_97_1.png 788w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 저장하기</span>\nlodge_df<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge_analysis.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EA%B0%B1%EC%8B%A0%EC%9D%BC%EC%9E%90-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">갱신일자 확인하기</a></li>\n<li><a href=\"#1%EC%98%81%EC%97%85-%EC%83%81%ED%83%9C%EC%99%80-%ED%8F%90%EC%97%85%EC%83%81%ED%83%9C-%EA%B1%B4%EC%88%98%EB%A5%BC-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\">1.영업 상태와 폐업상태 건수를 알아보자</a></li>\n<li><a href=\"#2%EC%9A%B4%EC%98%81%EA%B8%B0%EA%B0%84%EC%9D%98-%EB%B6%84%ED%8F%AC%EB%A5%BC-%ED%8C%8C%EC%95%85%ED%95%98%EC%9E%90\">2.운영기간의 분포를 파악하자</a></li>\n<li><a href=\"#3-%EC%88%99%EB%B0%95%EC%97%85%EC%9D%B4-%EB%B0%9C%EB%8B%AC%ED%95%9C-%EC%A7%80%EC%97%AD-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\">3. 숙박업이 발달한 지역 알아보기</a></li>\n<li><a href=\"#4%EB%A9%B4%EC%A0%81-%EB%B6%84%ED%8F%AC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">4.면적 분포 확인하기</a></li>\n<li><a href=\"#trouble-shooting\">Trouble Shooting</a></li>\n<li><a href=\"#5%EB%85%84%EB%8F%84%EB%B3%84-%EC%9D%B8%ED%97%88%EA%B0%80-%EB%B0%8F-%ED%8F%90%EC%97%85%EC%83%81%ED%99%A9-%EA%B7%B8%EB%9E%98%ED%94%84%EB%A1%9C-%ED%99%95%EC%9D%B8\">5.년도별 인허가 및 폐업상황 그래프로 확인</a></li>\n<li><a href=\"#6-%EB%B3%80%EC%88%98-%EA%B0%84-%EC%83%81%EA%B4%80%EA%B4%80%EA%B3%84-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\">6. 변수 간 상관관계 알아보기</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 21, 2022","title":"숙박업 분석하기 (2) - EDA","categories":"Data_Analysis","author":"HwanHee Park","emoji":"👨‍💻"},"fields":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (2) - EDA/"}},"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/PySpark/[PySpark] 숙박업 분석하기 (3) - MLlib/","nextSlug":"/PySpark/[PySpark] 숙박업 분석하기 (1)- 데이터 수집 및 전처리/","prevSlug":"/PySpark/[PySpark] 숙박업 분석하기 (2) - EDA/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}