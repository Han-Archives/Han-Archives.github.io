{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/PySpark/PostgreSQLê³¼ ì—°ë™í•˜ê¸°/",
    "result": {"data":{"cur":{"id":"e0151f47-d704-5b50-b1e8-ba698656e3a4","html":"<p>ì•„ë˜ì˜ ê³¼ì •ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ì˜ ì‚¬ì´íŠ¸ë¥¼ ì°¸ì¡° ë°”ëë‹ˆë‹¤.</p>\n<p><a href=\"https://han-depository.tistory.com/47\">https://han-depository.tistory.com/47</a></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd</code></pre></div>\n<h3 id=\"postgresql-ì ‘ì†-ì •ë³´\" style=\"position:relative;\"><a href=\"#postgresql-%EC%A0%91%EC%86%8D-%EC%A0%95%EB%B3%B4\" aria-label=\"postgresql ì ‘ì† ì •ë³´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PostgreSQL ì ‘ì† ì •ë³´</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># localhost</span>\nip <span class=\"token operator\">=</span> <span class=\"token string\">\"127.0.0.1\"</span>\n<span class=\"token comment\"># port</span>\nport <span class=\"token operator\">=</span> <span class=\"token number\">5432</span> \n<span class=\"token comment\"># username</span>\nuser <span class=\"token operator\">=</span> <span class=\"token string\">\"ID\"</span>\n<span class=\"token comment\"># password</span>\npasswd <span class=\"token operator\">=</span> <span class=\"token string\">\"ë¹„ë°€ë²ˆí˜¸\"</span>\n<span class=\"token comment\"># database</span>\ndb <span class=\"token operator\">=</span> <span class=\"token string\">\"dvdrental\"</span></code></pre></div>\n<h3 id=\"sparksession-ì—°ë™í•˜ê¸°\" style=\"position:relative;\"><a href=\"#sparksession-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\" aria-label=\"sparksession ì—°ë™í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkSession ì—°ë™í•˜ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"db-ì†-table-í˜¸ì¶œí•˜ê¸°\" style=\"position:relative;\"><a href=\"#db-%EC%86%8D-table-%ED%98%B8%EC%B6%9C%ED%95%98%EA%B8%B0\" aria-label=\"db ì† table í˜¸ì¶œí•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DB ì† table í˜¸ì¶œí•˜ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SQL query ì‘ì„±</span>\nsql <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"\nselect * from actor\n\"\"\"</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc\"</span><span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jdbc:postgresql://{0}:{1}/{2}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span> ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> db <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"driver\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.postgresql.Driver\"</span><span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"query\"</span><span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> passwd<span class=\"token punctuation\">)</span>\\\n                    <span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"attachment:7_1.PNG\" alt=\"7_1.PNG\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">dvdrental_actor<span class=\"token punctuation\">.</span>createOrReplaceTempView<span class=\"token punctuation\">(</span> <span class=\"token string\">\"dvdrental_actor\"</span> <span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SQL ì¿¼ë¦¬ ì‘ì„±</span>\nspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">(</span> <span class=\"token triple-quoted-string string\">\"\"\"\n    select *\n    from dvdrental_actor\n    limit 5\n\"\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"attachment:7_2.PNG\" alt=\"7_2.PNG\"></p>\n<h3 id=\"parquet-ë¶ˆëŸ¬ì˜¤ê¸°\" style=\"position:relative;\"><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"parquet ë¶ˆëŸ¬ì˜¤ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet ë¶ˆëŸ¬ì˜¤ê¸°</h3>\n<p>ìˆ™ë°•ì—… ë¶„ì„ ê³¼ì •ì—ì„œ ì €ì¥ëœ parquetì„ í˜¸ì¶œí•˜ì—¬ PostgreSQLì— ì €ì¥í•˜ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>parquet<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Dataset\\\\lodge_industry\\\\lodge.parquet\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"attachment:8_1.PNG\" alt=\"8_1.PNG\"></p>\n<h3 id=\"dbì—-table-ì—…ë¡œë“œí•˜ê¸°\" style=\"position:relative;\"><a href=\"#db%EC%97%90-table-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0\" aria-label=\"dbì— table ì—…ë¡œë“œí•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DBì— table ì—…ë¡œë“œí•˜ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># JDBC ì†ŒìŠ¤ë¡œ ë°ì´í„° ì €ì¥í•˜ê¸°</span>\nlodge<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jdbc:postgresql://{0}:{1}/{2}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span> ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> db <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"driver\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.postgresql.Driver\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"dbtable\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lodge\"</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> passwd<span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"attachment:8_2.PNG\" alt=\"8_2.PNG\"></p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://urame.tistory.com/entry/Spark-PostgreSQL-%EC%97%B0%EB%8F%99-%EB%B0%A9%EB%B2%95-jdbc-spark-sql\">https://urame.tistory.com/entry/Spark-PostgreSQL-%EC%97%B0%EB%8F%99-%EB%B0%A9%EB%B2%95-jdbc-spark-sql</a></p>\n<p><a href=\"https://spark-korea.github.io/docs/sql-data-sources-jdbc.html\">https://spark-korea.github.io/docs/sql-data-sources-jdbc.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#postgresql-%EC%A0%91%EC%86%8D-%EC%A0%95%EB%B3%B4\">PostgreSQL ì ‘ì† ì •ë³´</a></li>\n<li><a href=\"#sparksession-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\">SparkSession ì—°ë™í•˜ê¸°</a></li>\n<li><a href=\"#db-%EC%86%8D-table-%ED%98%B8%EC%B6%9C%ED%95%98%EA%B8%B0\">DB ì† table í˜¸ì¶œí•˜ê¸°</a></li>\n<li><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">Parquet ë¶ˆëŸ¬ì˜¤ê¸°</a></li>\n<li><a href=\"#db%EC%97%90-table-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0\">DBì— table ì—…ë¡œë“œí•˜ê¸°</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","excerpt":"ì•„ë˜ì˜ ê³¼ì •ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ì˜ ì‚¬ì´íŠ¸ë¥¼ ì°¸ì¡° ë°”ëë‹ˆë‹¤. https://han-depository.tistory.com/47 PostgreSQL ì ‘ì† ì •ë³´ SparkSession ì—°ë™í•˜ê¸° DB ì† table í˜¸ì¶œí•˜ê¸° 7_1.PNG 7_2.PNG Parquet ë¶ˆëŸ¬ì˜¤ê¸° ìˆ™ë°•ì—… ë¶„ì„ ê³¼ì •ì—ì„œ ì €ì¥ëœ parquetì„ í˜¸ì¶œí•˜ì—¬ PostgreSQLì— ì €ì¥í•˜ì. 8_1.PNG DBì— table ì—…ë¡œë“œí•˜ê¸° 8_2.PNG Reference https://urame.tistory.com/entry/Spark-PostgreSQL-%EC%97%B0%EB%8F%99-%EB%B0%A9%EB%B2%95-jdbc-spark-sql https://spark-korea.github.io/docs/sql-data-sources-jdbc.html PostgreSQL ì ‘ì† ì •ë³´ SparkSession ì—°ë™í•˜ê¸° DB ì† table í˜¸ì¶œí•˜ê¸° Parquet ë¶ˆëŸ¬ì˜¤ê¸° DBì— table ì—…ë¡œë“œí•˜ê¸° Reference","frontmatter":{"date":"April 20, 2022","title":"PostgreSQL ì—°ë™í•˜ê¸°","categories":"Anaylsis_tools","author":"HwanHee Park","emoji":"ğŸ‘¨â€ğŸ’»"},"fields":{"slug":"/PySpark/PostgreSQLê³¼ ì—°ë™í•˜ê¸°/"}},"next":{"id":"a4f830e4-5329-527c-931f-59127371d16c","html":"<h2 id=\"datastudio-ì‚¬ìš©í•˜ê¸°\" style=\"position:relative;\"><a href=\"#datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"datastudio ì‚¬ìš©í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataStudio ì‚¬ìš©í•˜ê¸°</h2>\n<p><img src=\"/7771d5baf4d2b56718481df6c544c61b/logo.png\" alt=\"logo.PNG\"></p>\n<h3 id=\"datastudioë€\" style=\"position:relative;\"><a href=\"#datastudio%EB%9E%80\" aria-label=\"datastudioë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataStudioë€?</h3>\n<p>êµ¬ê¸€ì—ì„œ ì œê³µí•˜ëŠ” ì‹œê°í™” ë„êµ¬ë¡œ ì–‘ë°©í–¥ ëŒ€ì‹œë³´ë“œì™€ ë°ì´í„° ì‹œê°í™” ë³´ê³ ì„œë¥¼ ì œì‘í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.</p>\n<ul>\n<li>íŠ¹ì§•</li>\n</ul>\n<ol>\n<li>ë¬´ë£Œ</li>\n<li>ì‰¬ìš´ ì‚¬ìš©ë²•</li>\n<li>ì—¬ëŸ¬ê°€ì§€ í”Œë«í¼ê³¼ ì—°ê²°ì´ ì‰¬ì›€ (ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ì†ŒìŠ¤ ì‚¬ìš©ê°€ëŠ¥)</li>\n<li>ë³µì¡í•œ ì¡°ê±´ë„ ì‚¬ìš© ê°€ëŠ¥</li>\n<li>ë°ì´í„° ì–‘ì´ ë§ì•„ì§€ëŠ” ê²½ìš° í”„ë¡œê·¸ë¨ ì†ë„ê°€ ëŠë ¤ì§</li>\n</ol>\n<h3 id=\"1-ì‚¬ì´íŠ¸-ì ‘ì†í•˜ê¸°\" style=\"position:relative;\"><a href=\"#1-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\" aria-label=\"1 ì‚¬ì´íŠ¸ ì ‘ì†í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ì‚¬ì´íŠ¸ ì ‘ì†í•˜ê¸°</h3>\n<p>ì•„ë˜ì˜ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ ì ‘ì†í•  ìˆ˜ ìˆìœ¼ë©° êµ¬ê¸€ ê³„ì •ì„ ë¡œê·¸ì¸ í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<p><a href=\"https://datastudio.google.com/\">https://datastudio.google.com/</a></p>\n<p><img src=\"/105bf8bb2ab67e9869a17c85a81e4ab0/2_1.png\" alt=\"2_1.PNG\"></p>\n<p>DataStudioëŠ” ìœ„ì™€ ê°™ì´ ë‹¤ì–‘í•œ í˜•íƒœì˜ ë³´ê³ ì„œ í˜•ì‹ì„ ì œê³µí•˜ë©° ì•„ë˜ì™€ ê°™ì´ ë‹¤ì–‘í•œ í”Œë«í¼ì„ í†µí•´ ë°ì´í„°ë¥¼ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/254ef845e18903176f9abb108bf67f02/2_2.png\" alt=\"2_2.PNG\"></p>\n<h3 id=\"2-datastudio-ì‚´í´ë³´ê¸°\" style=\"position:relative;\"><a href=\"#2-datastudio-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"2 datastudio ì‚´í´ë³´ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DataStudio ì‚´í´ë³´ê¸°</h3>\n<p>DataStudioì—ì„œ ì œê³µí•˜ëŠ” Sample ë°ì´í„°ì˜ êµ¬ì¡°ë¥¼ íŒŒì•…í•œ ë’¤ ë³´ìœ í•˜ê³  ìˆëŠ” ë°ì´í„°ë¡œ DataStudioë¥¼ ì‚¬ìš©í•˜ì.</p>\n<ul>\n<li>Sample ë°ì´í„° êµ¬ì¡° í™•ì¸í•˜ê¸° (World Population)</li>\n</ul>\n<p><img src=\"/a23b3baa7ed19383a826e94e9fd492db/3_3.png\" alt=\"3_3.PNG\"></p>\n<p>ìœ„ì™€ ê°™ì´ ë³µì¡í•˜ì§€ ì•Šì€ êµ¬ì¡°ì˜ ë°ì´í„°ë¡œ êµ¬ì„±ëœ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>\n<ul>\n<li>ë°ì´í„° í™œìš©í•˜ê¸°</li>\n</ul>\n<p>sample ë°ì´í„°ë¥¼ í†µí•´ ëŒ€ì‰¬ë³´ë“œ ë° ë³´ê³ ì„œë¥¼ ì œì‘í•  ìˆ˜ ìˆì§€ë§Œ ì§ì ‘ ë³¸ì¸ì˜ ë³´ìœ í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì´ ì—¬ëŸ¬ëª¨ë¡œ DataStudioë¥¼ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤. ì´ ê³¼ì •ì— ì‚¬ìš©ë  ë°ì´í„°ëŠ” ì‚¬ëŒë“¤ì´ ì´ ë¸”ë¡œê·¸ì— ë§ì´ ë°©ë¬¸í•œ GDP ê´€ë ¨í•œ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ì§„í–‰í•˜ê² ë‹¤.</p>\n<ul>\n<li>ë°</li>\n</ul>\n<h3 id=\"3-ë°ì´í„°-ì¶”ì¶œ-ë°-ì „ì²˜ë¦¬í•˜ê¸°\" style=\"position:relative;\"><a href=\"#3-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%EC%A0%84%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"3 ë°ì´í„° ì¶”ì¶œ ë° ì „ì²˜ë¦¬í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. ë°ì´í„° ì¶”ì¶œ ë° ì „ì²˜ë¦¬í•˜ê¸°</h3>\n<ul>\n<li>ì‚¬ìš©ë  ë°ì´í„°</li>\n</ul>\n<p>ì´ ê³¼ì •ì— ì‚¬ìš©ë  ë°ì´í„°ë¡œ ì‚¬ëŒë“¤ì´ ì´ ë¸”ë¡œê·¸ì— ë§ì´ ë°©ë¬¸í•œ GDP ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ì§„í–‰í•˜ë©° G7+Brics+í•œêµ­ë“± ì´ 13ê°œ êµ­ê°€ì˜ GDPë¥¼ 1980,1990,2000,2011~2020ë…„ë„ì˜ ë³€í™”ë¥¼ ëŒ€ì‰¬ë³´ë“œë¥¼ í†µí•´ ì‹œê°í™”í•˜ì.</p>\n<ul>\n<li>ë°ì´í„° ì¶”ì¶œê³¼ì •</li>\n</ul>\n<ol>\n<li>ì„¸ê³„ì€í–‰ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„° ì„ íƒ</li>\n</ol>\n<p><img src=\"/c7c5c1048e56f73964fcf32a271b5f84/1_1.png\" alt=\"1_1.PNG\"></p>\n<ol start=\"2\">\n<li>csv íŒŒì¼ìƒì—ì„œ ì „ì²˜ë¦¬</li>\n</ol>\n<p>ë¶ˆí•„ìš”í•œ ì¹¼ëŸ¼ ì œê±° ë° ë‹¬ëŸ¬ -> billion$ë¡œ ê°’ì„ ë³€í™˜</p>\n<ol start=\"3\">\n<li>(2)ì—ì„œ ë³¸ ìƒ˜í”Œ ë°ì´í„° êµ¬ì¡°ì™€ ê°™ì´ ë³€í™˜</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Sample ë°ì´í„° êµ¬ì¡°ë¡œ ë°ì´í„° ë³€í™˜</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\norigin_data <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'gdp_data.csv'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">origin_data</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Series Name</th>\n      <th>Country Name</th>\n      <th>Country Code</th>\n      <th>1980</th>\n      <th>1990</th>\n      <th>2000</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>GDP (current US billion$)</td>\n      <td>Canada</td>\n      <td>CAN</td>\n      <td>273.8540</td>\n      <td>593.930</td>\n      <td>744.773</td>\n      <td>1793.330</td>\n      <td>1828.370</td>\n      <td>1846.600</td>\n      <td>1805.750</td>\n      <td>1556.51</td>\n      <td>1527.990</td>\n      <td>1649.270</td>\n      <td>1725.330</td>\n      <td>1742.020</td>\n      <td>1645.420</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>GDP (current US billion$)</td>\n      <td>China</td>\n      <td>CHN</td>\n      <td>191.1490</td>\n      <td>360.858</td>\n      <td>1211.350</td>\n      <td>7551.500</td>\n      <td>8532.230</td>\n      <td>9570.410</td>\n      <td>10475.700</td>\n      <td>11061.60</td>\n      <td>11233.300</td>\n      <td>12310.400</td>\n      <td>13894.800</td>\n      <td>14279.900</td>\n      <td>14722.700</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>GDP (current US billion$)</td>\n      <td>France</td>\n      <td>FRA</td>\n      <td>701.2880</td>\n      <td>1269.180</td>\n      <td>1362.250</td>\n      <td>2861.410</td>\n      <td>2683.830</td>\n      <td>2811.080</td>\n      <td>2852.170</td>\n      <td>2438.21</td>\n      <td>2471.290</td>\n      <td>2588.740</td>\n      <td>2789.590</td>\n      <td>2728.870</td>\n      <td>2630.320</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>GDP (current US billion$)</td>\n      <td>Germany</td>\n      <td>DEU</td>\n      <td>950.2910</td>\n      <td>1771.670</td>\n      <td>1943.150</td>\n      <td>3744.410</td>\n      <td>3527.340</td>\n      <td>3732.740</td>\n      <td>3883.920</td>\n      <td>3356.24</td>\n      <td>3467.500</td>\n      <td>3681.730</td>\n      <td>3975.350</td>\n      <td>3888.330</td>\n      <td>3846.410</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>GDP (current US billion$)</td>\n      <td>Korea, Rep.</td>\n      <td>KOR</td>\n      <td>65.3986</td>\n      <td>283.368</td>\n      <td>576.178</td>\n      <td>1253.220</td>\n      <td>1278.430</td>\n      <td>1370.800</td>\n      <td>1484.320</td>\n      <td>1465.77</td>\n      <td>1500.110</td>\n      <td>1623.900</td>\n      <td>1724.850</td>\n      <td>1651.420</td>\n      <td>1637.900</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>GDP (current US billion$)</td>\n      <td>United States</td>\n      <td>USA</td>\n      <td>2857.3100</td>\n      <td>5963.140</td>\n      <td>10252.300</td>\n      <td>15542.600</td>\n      <td>16197.000</td>\n      <td>16784.800</td>\n      <td>17527.200</td>\n      <td>18238.30</td>\n      <td>18745.100</td>\n      <td>19543.000</td>\n      <td>20611.900</td>\n      <td>21433.200</td>\n      <td>20953.000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>GDP (current US billion$)</td>\n      <td>United Kingdom</td>\n      <td>GBR</td>\n      <td>564.9480</td>\n      <td>1093.170</td>\n      <td>1662.130</td>\n      <td>2674.890</td>\n      <td>2719.160</td>\n      <td>2803.290</td>\n      <td>3087.170</td>\n      <td>2956.57</td>\n      <td>2722.850</td>\n      <td>2699.020</td>\n      <td>2900.790</td>\n      <td>2878.670</td>\n      <td>2759.800</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>GDP (current US billion$)</td>\n      <td>Japan</td>\n      <td>JPN</td>\n      <td>1105.3900</td>\n      <td>3132.820</td>\n      <td>4968.360</td>\n      <td>6233.150</td>\n      <td>6272.360</td>\n      <td>5212.330</td>\n      <td>4896.990</td>\n      <td>4444.93</td>\n      <td>5003.680</td>\n      <td>4930.840</td>\n      <td>5036.890</td>\n      <td>5148.780</td>\n      <td>5057.760</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>GDP (current US billion$)</td>\n      <td>Italy</td>\n      <td>ITA</td>\n      <td>477.2570</td>\n      <td>1181.220</td>\n      <td>1143.830</td>\n      <td>2291.990</td>\n      <td>2087.080</td>\n      <td>2141.320</td>\n      <td>2159.130</td>\n      <td>1835.90</td>\n      <td>1875.800</td>\n      <td>1956.950</td>\n      <td>2090.910</td>\n      <td>2009.380</td>\n      <td>1888.710</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>GDP (current US billion$)</td>\n      <td>India</td>\n      <td>IND</td>\n      <td>186.3250</td>\n      <td>320.979</td>\n      <td>468.395</td>\n      <td>1823.050</td>\n      <td>1827.640</td>\n      <td>1856.720</td>\n      <td>2039.130</td>\n      <td>2103.59</td>\n      <td>2294.800</td>\n      <td>2651.470</td>\n      <td>2701.110</td>\n      <td>2870.500</td>\n      <td>2660.250</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>GDP (current US billion$)</td>\n      <td>Brazil</td>\n      <td>BRA</td>\n      <td>237.3930</td>\n      <td>390.726</td>\n      <td>655.448</td>\n      <td>2616.160</td>\n      <td>2465.230</td>\n      <td>2472.820</td>\n      <td>2456.040</td>\n      <td>1802.21</td>\n      <td>1795.690</td>\n      <td>2063.510</td>\n      <td>1916.930</td>\n      <td>1877.820</td>\n      <td>1444.730</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>GDP (current US billion$)</td>\n      <td>South Africa</td>\n      <td>ZAF</td>\n      <td>82.9805</td>\n      <td>115.552</td>\n      <td>151.753</td>\n      <td>458.202</td>\n      <td>434.401</td>\n      <td>400.886</td>\n      <td>381.199</td>\n      <td>346.71</td>\n      <td>323.586</td>\n      <td>381.449</td>\n      <td>404.842</td>\n      <td>387.935</td>\n      <td>335.442</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>GDP (current US billion$)</td>\n      <td>Russian Federation</td>\n      <td>RUS</td>\n      <td>0.0000</td>\n      <td>516.814</td>\n      <td>259.710</td>\n      <td>2045.930</td>\n      <td>2208.300</td>\n      <td>2292.470</td>\n      <td>2059.240</td>\n      <td>1363.48</td>\n      <td>1276.790</td>\n      <td>1574.200</td>\n      <td>1657.330</td>\n      <td>1687.450</td>\n      <td>1483.500</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">year_list <span class=\"token operator\">=</span> origin_data<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># melt ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ êµ¬ì¡°ë¥¼ ë§ì¶¤</span>\ndata<span class=\"token operator\">=</span> origin_data<span class=\"token punctuation\">.</span>melt<span class=\"token punctuation\">(</span>id_vars<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Country Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Country Code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> value_vars<span class=\"token operator\">=</span>year_list<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Nan ê°’ ì œê±°</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ì¹¼ëŸ¼ ëª… ë³€ê²½</span>\ndata<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Country'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Contry Code'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Year'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'GDP(billion$)'</span><span class=\"token punctuation\">]</span>\n\ndata</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Country</th>\n      <th>Contry Code</th>\n      <th>Year</th>\n      <th>GDP(billion$)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Canada</td>\n      <td>CAN</td>\n      <td>1980</td>\n      <td>273.8540</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>China</td>\n      <td>CHN</td>\n      <td>1980</td>\n      <td>191.1490</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>France</td>\n      <td>FRA</td>\n      <td>1980</td>\n      <td>701.2880</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Germany</td>\n      <td>DEU</td>\n      <td>1980</td>\n      <td>950.2910</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Korea, Rep.</td>\n      <td>KOR</td>\n      <td>1980</td>\n      <td>65.3986</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>164</th>\n      <td>Italy</td>\n      <td>ITA</td>\n      <td>2020</td>\n      <td>1888.7100</td>\n    </tr>\n    <tr>\n      <th>165</th>\n      <td>India</td>\n      <td>IND</td>\n      <td>2020</td>\n      <td>2660.2500</td>\n    </tr>\n    <tr>\n      <th>166</th>\n      <td>Brazil</td>\n      <td>BRA</td>\n      <td>2020</td>\n      <td>1444.7300</td>\n    </tr>\n    <tr>\n      <th>167</th>\n      <td>South Africa</td>\n      <td>ZAF</td>\n      <td>2020</td>\n      <td>335.4420</td>\n    </tr>\n    <tr>\n      <th>168</th>\n      <td>Russian Federation</td>\n      <td>RUS</td>\n      <td>2020</td>\n      <td>1483.5000</td>\n    </tr>\n  </tbody>\n</table>\n<p>169 rows Ã— 4 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># ë³€í™˜ëœ ë°ì´í„° ì €ì¥</span>\ndata<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"gdp_data.csv\"</span><span class=\"token punctuation\">,</span>header<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"4-datastudio-ì‚¬ìš©í•˜ê¸°\" style=\"position:relative;\"><a href=\"#4-datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"4 datastudio ì‚¬ìš©í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. DataStudio ì‚¬ìš©í•˜ê¸°</h3>\n<p>DataStudio ì ‘ì† -> ë°ì´í„° ì—°ê²° -> íŒŒì¼ ì—…ë¡œë“œ ì„ íƒ í›„ ì•„ë˜ì™€ ê°™ì´ ë³€í™˜ëœ ë°ì´í„°ë¥¼ inputí•œë‹¤.</p>\n<p><img src=\"/f5540cbcde75b8af73699d74aa023875/2_3.png\" alt=\"2_3.PNG\"></p>\n<p><img src=\"/1e2cc2975c4862d2dbf61c2c85f33dcd/2_4.png\" alt=\"2_4.PNG\"></p>\n<p>ê·¸ ë’¤ ì¶”ê°€ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëœë‹¤.</p>\n<p>DataStudioì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ë‹¤ì–‘í•œ ì°¨íŠ¸ë¥¼ ì œê³µí•œë‹¤.</p>\n<p><img src=\"/77d892b76b04328ac7ded7025c0abb83/3_4.png\" alt=\"3_4.PNG\"></p>\n<p>ê° ì°¨íŠ¸ë¥¼ ì‚¬ìš©í• ë•Œ ë°ì´í„° ì†ŒìŠ¤, ì¸¡ì •ê¸°ì¤€, ì¸¡ì •í•­ëª©ì„ ì„ íƒí•˜ì—¬ ì›í•˜ëŠ” í˜•íƒœë¡œ ì°¨íŠ¸ ì œì‘ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<p>ëª‡ëª‡ ì°¨íŠ¸ (ex) êµ¬ê¸€ ì§€ë„ ì°¨íŠ¸)ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë°ì´í„° ìœ í˜•ì„ ë³€ê²½í•´ì•¼ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.</p>\n<p>ë³€ê²½ ë°©ë²•ì€ ë¦¬ì†ŒìŠ¤ -> ì¶”ê°€ëœ ë°ì´í„° ì†ŒìŠ¤ ê´€ë¦¬ë¥¼ ëˆ„ë¥¸ í›„ ì•„ë˜ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ ìˆ˜ì •ë²„íŠ¼ì„ í´ë¦­í•œ ë’¤ ì§ì ‘ ë°ì´í„° ìœ í˜•ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/d3190be4adb83ea9734b80167c56fc84/3_5.png\" alt=\"3_5.PNG\"></p>\n<p><img src=\"/e8b3ea034a23b92a5ab0ea93a3bbca62/3_2.png\" alt=\"3_2.PNG\"></p>\n<h3 id=\"5-ë³´ê³ ì„œ-ì œì‘í•˜ê¸°\" style=\"position:relative;\"><a href=\"#5-%EB%B3%B4%EA%B3%A0%EC%84%9C-%EC%A0%9C%EC%9E%91%ED%95%98%EA%B8%B0\" aria-label=\"5 ë³´ê³ ì„œ ì œì‘í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. ë³´ê³ ì„œ ì œì‘í•˜ê¸°</h3>\n<p>ë‹¤ì–‘í•œ ì°¨íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ì‹œê°í™”ëœ ë³´ê³ ì„œë¥¼ ì œì‘í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/3122de0961480cf61f83df35fbf5504f/5_1.png\" alt=\"5_1.PNG\"></p>\n<p>ì¡°ê±´ì— ë§ê²Œ ê²€ìƒ‰í•˜ëŠ” ê¸°ëŠ¥ë„ ìˆì–´ ì›í•˜ëŠ” í•­ëª©ì— ê·¸ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/7be7d2bccee43648941becea3dcd3e3d/5_2.png\" alt=\"5_2.PNG\"></p>\n<p><img src=\"/0cef0cacf5733a84e4e447d0eed3c397/5_3.png\" alt=\"5_3.PNG\"></p>\n<h3 id=\"ì €ì¥í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"ì €ì¥í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì €ì¥í•˜ê¸°</h3>\n<p>ë³´ê³ ì„œê°€ ì™„ì„±ë˜ë©´ ê³µìœ ë²„íŠ¼ì„ í†µí•´ ì €ì¥, ê³µìœ  ë“±ì´ ê°€ëŠ¥í•˜ë©° ë§í¬ ë²„íŠ¼ì„ ì´ìš©í•˜ë©´ ì§ì ‘ ëŒ€ì‹œë³´ë“œì˜ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ë³´ì¼ ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì´ ê³µìœ  ë§í¬ë¥¼ ë‚¨ê¸°ë”ë¼ë„ ì§€ì •ëœ íŠ¹ì • ì‚¬ìš©ìë§Œ ë§í¬ì— ì ‘ì†í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/84f2f8d533d72da84f3b13a8630523f3/5_4.png\" alt=\"5_4.PNG\"></p>\n<p><a href=\"https://datastudio.google.com/s/iUfBcwkr0z4\">https://datastudio.google.com/s/iUfBcwkr0z4</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">DataStudio ì‚¬ìš©í•˜ê¸°</a></p>\n<ul>\n<li><a href=\"#datastudio%EB%9E%80\">DataStudioë€?</a></li>\n<li><a href=\"#1-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\">1. ì‚¬ì´íŠ¸ ì ‘ì†í•˜ê¸°</a></li>\n<li><a href=\"#2-datastudio-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\">2. DataStudio ì‚´í´ë³´ê¸°</a></li>\n<li><a href=\"#3-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%EC%A0%84%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">3. ë°ì´í„° ì¶”ì¶œ ë° ì „ì²˜ë¦¬í•˜ê¸°</a></li>\n<li><a href=\"#4-datastudio-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">4. DataStudio ì‚¬ìš©í•˜ê¸°</a></li>\n<li><a href=\"#5-%EB%B3%B4%EA%B3%A0%EC%84%9C-%EC%A0%9C%EC%9E%91%ED%95%98%EA%B8%B0\">5. ë³´ê³ ì„œ ì œì‘í•˜ê¸°</a></li>\n<li><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">ì €ì¥í•˜ê¸°</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"March 01, 2022","title":"DataStudio ì‚¬ìš©í•˜ê¸°","categories":"Analysis_Tools","author":"HwanHee Park","emoji":"ğŸ‘¨â€ğŸ’»"},"fields":{"slug":"/DataStudio/DataStudio ì‚¬ìš©í•˜ê¸°/"}},"prev":{"id":"e47b0147-862b-5b04-8e95-af2e4574f2d1","html":"<p>ì´ë²ˆ ì¥ì—ì„œëŠ” ì „ ì¥ì—ì„œ ì§„í–‰í•œ ìë£Œë¥¼ ê°€ì§€ê³  Pysparkì˜ ML ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ íì—… ê°€ëŠ¥í™•ë¥ ì„ ì•Œì•„ë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyspark\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> font_manager<span class=\"token punctuation\">,</span>rc\n<span class=\"token keyword\">import</span> matplotlib\n\nfont_path <span class=\"token operator\">=</span> <span class=\"token string\">'C:\\\\Windows\\\\Fonts\\\\gulim.ttc'</span>\n\n<span class=\"token comment\">#í°íŠ¸ ì´ë¦„ ì–»ì–´ì˜¤ê¸°</span>\nfont_name <span class=\"token operator\">=</span> font_manager<span class=\"token punctuation\">.</span>FontProperties<span class=\"token punctuation\">(</span>fname<span class=\"token operator\">=</span>font_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#font ì„¤ì •</span>\nmatplotlib<span class=\"token punctuation\">.</span>rc<span class=\"token punctuation\">(</span><span class=\"token string\">'font'</span><span class=\"token punctuation\">,</span>family<span class=\"token operator\">=</span>font_name<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SparkSession</span>\nspark <span class=\"token operator\">=</span>  pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SparkSession \\\n         <span class=\"token punctuation\">.</span>builder \\\n         <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.driver.extraClassPath\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r\"C:\\\\Program Files\\\\PostgreSQL\\\\14\\\\bin\\\\postgresql-42.3.3.jar\"</span><span class=\"token punctuation\">)</span> \\\n         <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\lodge_analysis.csv\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lodge</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ë²ˆí˜¸</th>\n      <th>ê°œë°©ì„œë¹„ìŠ¤ëª…</th>\n      <th>ì‚¬ì—…ì¥ëª…</th>\n      <th>ì§€ì—­</th>\n      <th>ìƒì„¸ì˜ì—…ìƒíƒœëª…</th>\n      <th>ì¸í—ˆê°€ì¼ì</th>\n      <th>íì—…ì¼ì</th>\n      <th>ê°±ì‹ ì¼ì</th>\n      <th>ë©´ì </th>\n      <th>ìš´ì˜ê¸°ê°„</th>\n      <th>start_year</th>\n      <th>end_year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>39267</td>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì‚°í˜¸ì¥ì—¬ê´€</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>19780731</td>\n      <td>20030331</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n      <td>1978</td>\n      <td>2003</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>39268</td>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ìƒˆí•œì—¬ê´€</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>19800220</td>\n      <td>20071218</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n      <td>1980</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>39269</td>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì‚¼ì„±</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>19700811</td>\n      <td>19990123</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n      <td>1970</td>\n      <td>1999</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>39270</td>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ìŠ¹ì •ì›</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>20120625</td>\n      <td>20171214</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n      <td>2012</td>\n      <td>2017</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>39271</td>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì—ìŠ¤ëª¨í…”</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>20030116</td>\n      <td>20160125</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n      <td>2003</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>618</td>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ìº í•‘ìŠ¤íƒ€</td>\n      <td>ì œì£¼ì‹œ</td>\n      <td>íì—…</td>\n      <td>20160308</td>\n      <td>20220311</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n      <td>2016</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>619</td>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ì§€ë¦¬ì‚° í˜¸ìˆ˜ê³µì› ì˜¤í† ìº í•‘ì¥</td>\n      <td>êµ¬ë¡€êµ°</td>\n      <td>íì—…</td>\n      <td>20200909</td>\n      <td>20220311</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n      <td>2020</td>\n      <td>2022</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>620</td>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ë§ˆë¦°ì˜¤í† ìº í•‘ì¥</td>\n      <td>íƒœì•ˆêµ°</td>\n      <td>íì—…</td>\n      <td>20160624</td>\n      <td>20161018</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n      <td>2016</td>\n      <td>2016</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>621</td>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ëª…ì‚¬ì‹­ë¦¬ ì‹ ë¦¬ì•¼ì˜ì¥</td>\n      <td>ì™„ë„êµ°</td>\n      <td>íì—…</td>\n      <td>20190722</td>\n      <td>20190826</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n      <td>2019</td>\n      <td>2019</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>622</td>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ì¸ì œë‚˜ë¥´ìƒ¤íŒŒí¬ ìº í•‘ì¥</td>\n      <td>ì¸ì œêµ°</td>\n      <td>íì—…</td>\n      <td>20160602</td>\n      <td>20200507</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n      <td>2016</td>\n      <td>2020</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows Ã— 12 columns</p>\n</div>\n<h3 id=\"ë³€ìˆ˜-ì„ íƒ-ë°-ë³€í™˜\" style=\"position:relative;\"><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\" aria-label=\"ë³€ìˆ˜ ì„ íƒ ë° ë³€í™˜ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë³€ìˆ˜ ì„ íƒ ë° ë³€í™˜</h3>\n<ol>\n<li>ë¶ˆí•„ìš”í•œ ì¹¼ëŸ¼ ì œì™¸ (ë²ˆí˜¸, ì‚¬ì—…ì¥ëª…, start_year, end_year)</li>\n<li>ë‚ ì§œí˜•ìœ¼ë¡œ ë°ì´í„° ë³€í™˜</li>\n<li>Label Encoding</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">## ê³¼ì • 2 ì§„í–‰ ì¤‘ date ë²”ìœ„ ì˜¤ë¥˜ê°’ ìˆ˜ì •</span>\n<span class=\"token comment\"># ì¸í—ˆê°€ì¼ì</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19750229</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19750228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19940431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19940430</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19840431</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19840430</span>\n\n<span class=\"token comment\"># íì—…ì¼ì</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020231</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020228</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20140000</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20140101</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000300</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000301</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20020400</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20020401</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19990900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19990901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20000900</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">20000901</span>\nlodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>lodge<span class=\"token punctuation\">[</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19970230</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">19970228</span>\n\ndata <span class=\"token operator\">=</span> lodge\n\n<span class=\"token comment\"># ë¶ˆí•„ìš”í•œ ì¹¼ëŸ¼ ì œì™¸</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ë²ˆí˜¸'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ì‚¬ì—…ì¥ëª…'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'start_year'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'end_year'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#-------- ë‚ ì§œí˜•ìœ¼ë¡œ ë°ì´í„° ë³€í™˜ ------------</span>\n<span class=\"token comment\"># ì•½ê°„ ì§€ì €ë¶„í•œ ë°©ì‹ìœ¼ë¡œ ë‚ ì§œí˜• ë°ì´í„°ë¡œ ì „í™˜</span>\n<span class=\"token comment\"># 1. int-> str ë³€í™˜</span>\n<span class=\"token comment\"># 2. str.slice í•¨ìˆ˜ ì‚¬ìš©í•˜ì—¬ ë…„ë„,ì›”,ì¼ë¡œ ë‚˜ëˆ”</span>\n<span class=\"token comment\"># 3. ë‚˜ëˆ ì§„ ì¹¼ëŸ¼ì„ to_datetimeìœ¼ë¡œ ë‚ ì§œí˜•ë°ì´í„°ë¡œ ë³€í™˜</span>\n<span class=\"token comment\"># 1~3 ê³¼ì •ì—ì„œ ë°œìƒí•œ ì„ì‹œ ì¹¼ëŸ¼ ì‚­ì œ</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">make_datetime</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'str'</span><span class=\"token punctuation\">)</span>\n    temp <span class=\"token operator\">=</span> df\n    temp <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n    temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> stop<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    \n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span>temp<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span>\n    temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    \n    df<span class=\"token punctuation\">[</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">make_datetime<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ndata</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ê°œë°©ì„œë¹„ìŠ¤ëª…</th>\n      <th>ì§€ì—­</th>\n      <th>ìƒì„¸ì˜ì—…ìƒíƒœëª…</th>\n      <th>ì¸í—ˆê°€ì¼ì</th>\n      <th>íì—…ì¼ì</th>\n      <th>ê°±ì‹ ì¼ì</th>\n      <th>ë©´ì </th>\n      <th>ìš´ì˜ê¸°ê°„</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>1978-07-31</td>\n      <td>2003-03-31</td>\n      <td>2021-07</td>\n      <td>77.17</td>\n      <td>25.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>1980-02-20</td>\n      <td>2007-12-18</td>\n      <td>2021-07</td>\n      <td>272.00</td>\n      <td>27.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>1970-08-11</td>\n      <td>1999-01-23</td>\n      <td>2021-07</td>\n      <td>86.94</td>\n      <td>29.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>2012-06-25</td>\n      <td>2017-12-14</td>\n      <td>2021-07</td>\n      <td>292.50</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ìˆ™ë°•ì—…</td>\n      <td>ì°½ì›ì‹œ</td>\n      <td>íì—…</td>\n      <td>2003-01-16</td>\n      <td>2016-01-25</td>\n      <td>2021-07</td>\n      <td>351.80</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67323</th>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ì œì£¼ì‹œ</td>\n      <td>íì—…</td>\n      <td>2016-03-08</td>\n      <td>2022-03-11</td>\n      <td>2019-10</td>\n      <td>335.00</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>67324</th>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>êµ¬ë¡€êµ°</td>\n      <td>íì—…</td>\n      <td>2020-09-09</td>\n      <td>2022-03-11</td>\n      <td>2021-05</td>\n      <td>0.00</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>67325</th>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>íƒœì•ˆêµ°</td>\n      <td>íì—…</td>\n      <td>2016-06-24</td>\n      <td>2016-10-18</td>\n      <td>2018-08</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67326</th>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ì™„ë„êµ°</td>\n      <td>íì—…</td>\n      <td>2019-07-22</td>\n      <td>2019-08-26</td>\n      <td>2019-08</td>\n      <td>0.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>67327</th>\n      <td>ìë™ì°¨ì•¼ì˜ì¥ì—…</td>\n      <td>ì¸ì œêµ°</td>\n      <td>íì—…</td>\n      <td>2016-06-02</td>\n      <td>2020-05-07</td>\n      <td>2020-05</td>\n      <td>335.00</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows Ã— 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span><span class=\"token string\">\"ê°œë°©ì„œë¹„ìŠ¤ëª…\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># ë³¸ê²©ì ì¸ ë¨¸ì‹ ëŸ¬ë‹ì„ í•˜ê¸° ìœ„í•´ 0ìœ¼ë¡œ ì§€ì •í•œ ê°’(null)ì„ ì¤‘ê°„ê°’ìœ¼ë¡œ ê°’ì„ ëŒ€ì²´</span>\n\n<span class=\"token comment\">#data['ìš´ì˜ê¸°ê°„'][data['ìš´ì˜ê¸°ê°„'] ==0] = 17</span>\n\n<span class=\"token comment\">#data['ë©´ì '][data['ë©´ì '] == 0 ] = 335</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data</code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ê°œë°©ì„œë¹„ìŠ¤ëª…</th>\n      <th>ì§€ì—­</th>\n      <th>ìƒì„¸ì˜ì—…ìƒíƒœëª…</th>\n      <th>ì¸í—ˆê°€ì¼ì</th>\n      <th>íì—…ì¼ì</th>\n      <th>ê°±ì‹ ì¼ì</th>\n      <th>ë©´ì </th>\n      <th>ìš´ì˜ê¸°ê°„</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>65176</th>\n      <td>í•œì˜¥ì²´í—˜ì—…</td>\n      <td>ê°•ì§„êµ°</td>\n      <td>ì˜ì—…</td>\n      <td>2013-11-30</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>117.41</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65177</th>\n      <td>í•œì˜¥ì²´í—˜ì—…</td>\n      <td>ê²½ì£¼ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2019-07-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>65178</th>\n      <td>í•œì˜¥ì²´í—˜ì—…</td>\n      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2021-07-05</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>335.00</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>65180</th>\n      <td>í•œì˜¥ì²´í—˜ì—…</td>\n      <td>ê°•ì§„êµ°</td>\n      <td>ì˜ì—…</td>\n      <td>2013-12-02</td>\n      <td>2022-03-11</td>\n      <td>2021-07</td>\n      <td>95.58</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>65053</th>\n      <td>í•œì˜¥ì²´í—˜ì—…</td>\n      <td>ì „ì£¼ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2013-11-06</td>\n      <td>2022-03-11</td>\n      <td>2021-11</td>\n      <td>335.00</td>\n      <td>9.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>67328 rows Ã— 8 columns</p>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ê°œë°©ì„œë¹„ìŠ¤ëª…</th>\n      <th>ì§€ì—­</th>\n      <th>ìƒì„¸ì˜ì—…ìƒíƒœëª…</th>\n      <th>ì¸í—ˆê°€ì¼ì</th>\n      <th>íì—…ì¼ì</th>\n      <th>ê°±ì‹ ì¼ì</th>\n      <th>ë©´ì </th>\n      <th>ìš´ì˜ê¸°ê°„</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54601</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55414</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55416</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>55419</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>65386</th>\n      <td>0</td>\n      <td>999</td>\n      <td>íì—…</td>\n      <td>1948-08-15</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>74.0</td>\n    </tr>\n    <tr>\n      <th>61838</th>\n      <td>General Campground</td>\n      <td>0</td>\n      <td>ì˜ì—…</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>59790</th>\n      <td>Resort Condominium</td>\n      <td>0</td>\n      <td>ì˜ì—…</td>\n      <td>1948-08-15</td>\n      <td>1948-08-15</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>60027</th>\n      <td>Resort Condominium</td>\n      <td>999</td>\n      <td>ì˜ì—…</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>57840</th>\n      <td>TOURIST HOTEL</td>\n      <td>999</td>\n      <td>ì˜ì—…</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>60575</th>\n      <td>Tourist Accommodation Business</td>\n      <td>999</td>\n      <td>ì˜ì—…</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64112</th>\n      <td>Traditional Korean</td>\n      <td>999</td>\n      <td>ì˜ì—…</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>64879</th>\n      <td>Traditional Korean housing experiencing business</td>\n      <td>999</td>\n      <td>ì˜ì—…</td>\n      <td>1999-12-31</td>\n      <td>2022-03-11</td>\n      <td>2022-03</td>\n      <td>335.00</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>58137</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>í‰ì°½êµ°</td>\n      <td>íì—…</td>\n      <td>1997-03-14</td>\n      <td>2006-08-31</td>\n      <td>2018-08</td>\n      <td>0.00</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>59038</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2016-09-27</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>218.85</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59039</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2016-12-30</td>\n      <td>2022-03-11</td>\n      <td>2021-10</td>\n      <td>624.75</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>59042</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2017-03-15</td>\n      <td>2022-03-11</td>\n      <td>2021-08</td>\n      <td>225.16</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59041</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2017-02-03</td>\n      <td>2022-03-11</td>\n      <td>2020-02</td>\n      <td>313.04</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59043</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2017-03-31</td>\n      <td>2022-03-11</td>\n      <td>2022-01</td>\n      <td>1382.35</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59044</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2017-06-01</td>\n      <td>2022-03-11</td>\n      <td>2019-02</td>\n      <td>169.63</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>59045</th>\n      <td>ê´€ê´‘ìˆ™ë°•ì—…</td>\n      <td>ë¶€ì‚°ê´‘ì—­ì‹œ</td>\n      <td>ì˜ì—…</td>\n      <td>2017-07-03</td>\n      <td>2022-03-11</td>\n      <td>2018-12</td>\n      <td>246.27</td>\n      <td>5.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql <span class=\"token keyword\">import</span> SparkSession\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>functions <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\"># SparkSession ê°ì²´ ìƒì„±</span>\nspark <span class=\"token operator\">=</span> SparkSession\\\n        <span class=\"token punctuation\">.</span>builder\\\n        <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">'PySpark ML for Loging Industry'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">'spark.some.config.option'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'some-value'</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\\\Users\\\\USER\\\\Desktop\\\\Analysis\\\\Proceed\\\\Spark\\\\lodge_analysis\\\\dataset.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">,</span>inferSchema <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> header <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|ê°œë°©ì„œë¹„ìŠ¤ëª…|      ì§€ì—­|ìƒì„¸ì˜ì—…ìƒíƒœëª…|ì¸í—ˆê°€ì¼ì|  íì—…ì¼ì|ê°±ì‹ ì¼ì|   ë©´ì |ìš´ì˜ê¸°ê°„|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  ê´€ê´‘ìˆ™ë°•ì—…|    í‰ì°½êµ°|          íì—…|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"ì¸í—ˆê°€ì¼ì\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+\n|ê°œë°©ì„œë¹„ìŠ¤ëª…|      ì§€ì—­|ìƒì„¸ì˜ì—…ìƒíƒœëª…|ì¸í—ˆê°€ì¼ì|  íì—…ì¼ì|ê°±ì‹ ì¼ì|  ë©´ì |ìš´ì˜ê¸°ê°„|\n+------------+----------+--------------+----------+----------+--------+------+--------+\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|1967-07-10| 2018-08| 335.0|    19.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|2001-07-07| 2018-08| 335.0|    53.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|2015-12-03| 2018-08| 148.5|    67.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|2001-02-01| 2018-08| 335.0|    53.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|1975-09-18| 2018-08| 335.0|    27.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|1972-07-31| 2018-08| 335.0|    24.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          ì˜ì—…|1948-08-15|2022-03-11| 2019-12|144.93|    74.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|2000-06-15| 2018-08| 335.0|    52.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|2001-05-17| 2018-08| 335.0|    53.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          ì˜ì—…|1948-08-15|2022-03-11| 2018-10| 907.0|    74.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1948-08-15|1948-08-15| 2018-08| 335.0|     0.0|\n|      ìˆ™ë°•ì—…|ì„œìš¸íŠ¹ë³„ì‹œ|          íì—…|1949-07-05|2006-03-27| 2018-08| 165.0|    57.0|\n|      ìˆ™ë°•ì—…|ì¸ì²œê´‘ì—­ì‹œ|          íì—…|1952-04-13|2018-08-28| 2018-10| 335.0|    66.0|\n|      ìˆ™ë°•ì—…|    ê²½ì£¼ì‹œ|          íì—…|1954-01-31|1991-07-05| 2018-08|500.96|    37.0|\n|      ìˆ™ë°•ì—…|    ì˜ê´‘êµ°|          íì—…|1954-02-08|2006-10-18| 2018-08|  88.0|    52.0|\n|      ìˆ™ë°•ì—…|    í•´ë‚¨êµ°|          íì—…|1955-01-20|2002-05-02| 2018-08| 335.0|    47.0|\n|      ìˆ™ë°•ì—…|    ì°½ì›ì‹œ|          íì—…|1955-06-14|1999-03-02| 2021-07|166.77|    44.0|\n|      ìˆ™ë°•ì—…|    ê²½ì£¼ì‹œ|          ì˜ì—…|1957-04-19|2022-03-11| 2021-02| 335.0|    65.0|\n|      ìˆ™ë°•ì—…|    ì°½ì›ì‹œ|          íì—…|1958-04-28|2018-01-24| 2021-07| 63.46|    60.0|\n|      ìˆ™ë°•ì—…|    ì°½ì›ì‹œ|          ì˜ì—…|1958-05-19|2022-03-11| 2021-07| 74.04|    64.0|\n+------------+----------+--------------+----------+----------+--------+------+--------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">\"ê°œë°©ì„œë¹„ìŠ¤ëª…\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+-------+--------+\n|ê°œë°©ì„œë¹„ìŠ¤ëª…|      ì§€ì—­|ìƒì„¸ì˜ì—…ìƒíƒœëª…|ì¸í—ˆê°€ì¼ì|  íì—…ì¼ì|ê°±ì‹ ì¼ì|   ë©´ì |ìš´ì˜ê¸°ê°„|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-06-12|2022-03-11| 2021-06|    0.0|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-12-28|2022-03-11| 2020-12| 279.23|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-07-27|2022-03-11| 2021-02| 375.16|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-06-01|2022-03-11| 2019-02| 169.63|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-09-19|2022-03-11| 2018-08| 129.96|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-10|2022-03-11| 2020-08|  178.2|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-09-16|2022-03-11| 2021-10| 195.89|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-12-30|2022-03-11| 2021-10| 624.75|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-03-31|2022-03-11| 2022-01|1382.35|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-04|2022-03-11| 2018-11| 206.16|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-12-30|2022-03-11| 2018-08|    0.0|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-09-18|2022-03-11| 2021-05| 120.07|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-08-31|2022-03-11| 2019-04| 207.99|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-11-14|2022-03-11| 2020-11| 108.39|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2015-11-16|2022-03-11| 2020-09|  335.0|     7.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|    í‰ì°½êµ°|          íì—…|1997-03-14|2006-08-31| 2018-08|    0.0|     9.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-09-27|2022-03-11| 2018-12| 218.85|     6.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-03-15|2022-03-11| 2021-08| 225.16|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-02-03|2022-03-11| 2020-02| 313.04|     5.0|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-07-03|2022-03-11| 2018-12| 246.27|     5.0|\n+------------+----------+--------------+----------+----------+--------+-------+--------+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"ë²”ì£¼í˜•-ë³€ìˆ˜-ì²˜ë¦¬í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬í•˜ê¸°</h3>\n<p>ì•„ë˜ëŠ” ì´ 3ê°€ì§€ ê³¼ì •ìœ¼ë¡œ ì§„í–‰</p>\n<ol>\n<li>StringIndexer</li>\n</ol>\n<p>ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ ì¸ë±ì‹±í•˜ì—¬ 0.0 , 1.0, 2.0 ê³¼ ê°™ì€ ë²ˆí˜¸ë¡œ ì¸ë±ì‹±</p>\n<ol start=\"2\">\n<li>OneHotEncoder</li>\n</ol>\n<p>ì¸ë±ì‹±í•œ ê°’ì€ 0,1,2 ì™€ ê°™ì´ ê°’ìœ¼ë¡œì¨ í¬ê¸°ë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— OneHotEncoderë¥¼ ì‚¬ìš©í•˜ì—¬ ê°’ì˜ í¬ê¸°ë¥¼ ê°–ì§€ ì•Šë„ë¡ ë³€í™˜</p>\n<ol start=\"3\">\n<li>VectorAssembler</li>\n</ol>\n<p>ì¸ì½”ë”©í•œ ê°’ì„ ë²¡í„°ë¡œ ëª¨ìœ¼ê¸°</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml <span class=\"token keyword\">import</span> Pipeline\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>feature <span class=\"token keyword\">import</span> StringIndexer<span class=\"token punctuation\">,</span> OneHotEncoder<span class=\"token punctuation\">,</span> VectorAssembler\n\n<span class=\"token comment\"># ê°±ì‹ ì¼ì, ì¸í—ˆê°€ì¼ì, íì—…ì¼ìë¥¼ ì œì™¸í•˜ê³  ë‹¤ì‹œ ì§„í–‰</span>\ncategory_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'ê°œë°©ì„œë¹„ìŠ¤ëª…'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ì§€ì—­'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ì¸í—ˆê°€ì¼ì'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'íì—…ì¼ì'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ê°±ì‹ ì¼ì'</span><span class=\"token punctuation\">]</span>\nnumeric_cols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'ë©´ì '</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ìš´ì˜ê¸°ê°„'</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># label</span>\nlabel_idx <span class=\"token operator\">=</span> StringIndexer<span class=\"token punctuation\">(</span>inputCol <span class=\"token operator\">=</span> <span class=\"token string\">\"ìƒì„¸ì˜ì—…ìƒíƒœëª…\"</span><span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ì„ ì¸ë±ì‹±</span>\nindexers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    StringIndexer<span class=\"token punctuation\">(</span>inputCol<span class=\"token operator\">=</span>c<span class=\"token punctuation\">,</span> outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_indexed\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> category_cols\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># ì¸ë±ì‹±í•œ ë³€ìˆ˜ë“¤ì„ ì¸ì½”ë”©</span>\nencoders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>OneHotEncoder<span class=\"token punctuation\">(</span>dropLast<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>inputCol<span class=\"token operator\">=</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"{0}_encoded\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>indexer<span class=\"token punctuation\">.</span>getOutputCol<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    <span class=\"token keyword\">for</span> indexer <span class=\"token keyword\">in</span> indexers\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># ì¸ì½”ë”© ëœ ê°’ê³¼ ìˆ«ì ë³€ìˆ˜ ê°’ì„ ë²¡í„°í™”</span>\n<span class=\"token comment\"># -- encoderì™€ numeric cols ì˜ ê²°í•© ë¦¬ìŠ¤íŠ¸ ê´€ë ¨ ì§€ì‹ ë¶€ì¡±(Arrayë¡œ ì•ˆë¨)</span>\n\nassembler <span class=\"token operator\">=</span> VectorAssembler<span class=\"token punctuation\">(</span>inputCols<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ê°œë°©ì„œë¹„ìŠ¤ëª…_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ì§€ì—­_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ì¸í—ˆê°€ì¼ì_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'íì—…ì¼ì_indexed_encoded'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ê°±ì‹ ì¼ì_indexed_encoded'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ë©´ì '</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ìš´ì˜ê¸°ê°„'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>outputCol<span class=\"token operator\">=</span><span class=\"token string\">\"features\"</span><span class=\"token punctuation\">)</span>\n\npipeline <span class=\"token operator\">=</span> Pipeline<span class=\"token punctuation\">(</span>stages<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>label_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> indexers  <span class=\"token operator\">+</span> encoders<span class=\"token operator\">+</span><span class=\"token punctuation\">[</span>assembler<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token operator\">=</span>pipeline<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\ntransformed<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|ê°œë°©ì„œë¹„ìŠ¤ëª…|      ì§€ì—­|ìƒì„¸ì˜ì—…ìƒíƒœëª…|ì¸í—ˆê°€ì¼ì|  íì—…ì¼ì|ê°±ì‹ ì¼ì|  ë©´ì |ìš´ì˜ê¸°ê°„|label|ê°œë°©ì„œë¹„ìŠ¤ëª…_indexed|ì§€ì—­_indexed|ì¸í—ˆê°€ì¼ì_indexed|íì—…ì¼ì_indexed|ê°±ì‹ ì¼ì_indexed|ê°œë°©ì„œë¹„ìŠ¤ëª…_indexed_encoded|ì§€ì—­_indexed_encoded|ì¸í—ˆê°€ì¼ì_indexed_encoded|íì—…ì¼ì_indexed_encoded|ê°±ì‹ ì¼ì_indexed_encoded|            features|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\n|  ê´€ê´‘ìˆ™ë°•ì—…|    í‰ì°½êµ°|          íì—…|1997-03-14|2006-08-31| 2018-08|   0.0|     9.0|  1.0|                 2.0|        55.0|            1373.0|           244.0|             0.0|               (7,[2],[1.0])|    (163,[55],[1.0])|      (14963,[1373],[1.0])|      (6606,[244],[1.0])|          (44,[0],[1.0])|(21785,[2,62,1543...|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-09-27|2022-03-11| 2018-12|218.85|     6.0|  0.0|                 2.0|         1.0|             887.0|             0.0|            23.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[887],[1.0])|        (6606,[0],[1.0])|         (44,[23],[1.0])|(21785,[2,8,1057,...|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2016-12-30|2022-03-11| 2021-10|624.75|     6.0|  0.0|                 2.0|         1.0|             686.0|             0.0|             7.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[686],[1.0])|        (6606,[0],[1.0])|          (44,[7],[1.0])|(21785,[2,8,856,1...|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-03-15|2022-03-11| 2021-08|225.16|     5.0|  0.0|                 2.0|         1.0|            5201.0|             0.0|             4.0|               (7,[2],[1.0])|     (163,[1],[1.0])|      (14963,[5201],[1.0])|        (6606,[0],[1.0])|          (44,[4],[1.0])|(21785,[2,8,5371,...|\n|  ê´€ê´‘ìˆ™ë°•ì—…|ë¶€ì‚°ê´‘ì—­ì‹œ|          ì˜ì—…|2017-02-03|2022-03-11| 2020-02|313.04|     5.0|  0.0|                 2.0|         1.0|             536.0|             0.0|            20.0|               (7,[2],[1.0])|     (163,[1],[1.0])|       (14963,[536],[1.0])|        (6606,[0],[1.0])|         (44,[20],[1.0])|(21785,[2,8,706,1...|\n+------------+----------+--------------+----------+----------+--------+------+--------+-----+--------------------+------------+------------------+----------------+----------------+----------------------------+--------------------+--------------------------+------------------------+------------------------+--------------------+\nonly showing top 5 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df <span class=\"token operator\">=</span> transformed<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>regression <span class=\"token keyword\">import</span> LinearRegression\n\nlr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>LinearRegression<span class=\"token punctuation\">(</span>featuresCol<span class=\"token operator\">=</span><span class=\"token string\">'features'</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">\"label\"</span><span class=\"token punctuation\">,</span> predictionCol<span class=\"token operator\">=</span><span class=\"token string\">'predlabel'</span><span class=\"token punctuation\">,</span> \n                               maxIter<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> regParam<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> elasticNetParam<span class=\"token operator\">=</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span> standardization<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">trans_df<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  1.0|(21785,[2,62,1543...|\n|  0.0|(21785,[2,8,1057,...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,5371,...|\n|  0.0|(21785,[2,8,706,1...|\n|  0.0|(21785,[2,8,563,1...|\n|  0.0|(21785,[2,8,712,1...|\n|  0.0|(21785,[2,8,2325,...|\n|  0.0|(21785,[2,8,415,1...|\n|  0.0|(21785,[2,8,856,1...|\n|  0.0|(21785,[2,8,7123,...|\n|  0.0|(21785,[2,8,2337,...|\n|  0.0|(21785,[2,8,1336,...|\n|  0.0|(21785,[2,8,688,1...|\n|  0.0|(21785,[2,8,1376,...|\n|  0.0|(21785,[2,8,1073,...|\n|  0.0|(21785,[2,8,9370,...|\n|  0.0|(21785,[2,8,1335,...|\n|  0.0|(21785,[2,8,299,1...|\n|  0.0|(21785,[2,8,321,1...|\n+-----+--------------------+\nonly showing top 20 rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">,</span> test_data <span class=\"token operator\">=</span> trans_df<span class=\"token punctuation\">.</span>randomSplit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> seed<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_data<span class=\"token punctuation\">.</span>columns</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">['label', 'features']</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Fit the data to the model</span>\nlinearModel <span class=\"token operator\">=</span> lr<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions <span class=\"token operator\">=</span> linearModel<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels <span class=\"token operator\">=</span> predictions<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predandlabels<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-------------------+-----+\n|          predlabel|label|\n+-------------------+-----+\n| 0.4786779491779273|  0.0|\n|0.47812190795718557|  0.0|\n| 0.4763438691699301|  0.0|\n|0.46373595776939147|  0.0|\n| 0.4621842148277867|  0.0|\n|  0.461957918982136|  0.0|\n|0.46163463920263503|  0.0|\n| 0.4564621627306192|  0.0|\n| 0.4530677250458588|  0.0|\n| 0.4522595255971063|  0.0|\n|0.45080476658935187|  0.0|\n| 0.4472567710093285|  0.0|\n|0.39633212374343496|  0.0|\n| 0.3614890291088182|  0.0|\n| 0.4700399134696608|  0.0|\n| 0.4727877915954192|  0.0|\n|0.46379414812970166|  0.0|\n|0.45904840096662713|  0.0|\n|0.44309292744935574|  0.0|\n| 0.3900524140266282|  0.0|\n+-------------------+-----+\nonly showing top 20 rows</code></pre></div>\n<h3 id=\"í‰ê°€\" style=\"position:relative;\"><a href=\"#%ED%8F%89%EA%B0%80\" aria-label=\"í‰ê°€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í‰ê°€</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>ml<span class=\"token punctuation\">.</span>evaluation <span class=\"token keyword\">import</span> RegressionEvaluator\n\n<span class=\"token comment\"># Get the RMSE</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>rootMeanSquaredError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>meanAbsoluteError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Get the R2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>linearModel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">.</span>r2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5022262338134558\nMAE: 0.4878241107468986\nR2: 0.012063243903345677</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'rmse'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RMSE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RMSE: 0.5017870515976061</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'mae'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAE: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">MAE: 0.4873217827313394</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">evaluator <span class=\"token operator\">=</span> RegressionEvaluator<span class=\"token punctuation\">(</span>predictionCol<span class=\"token operator\">=</span><span class=\"token string\">\"predlabel\"</span><span class=\"token punctuation\">,</span> labelCol<span class=\"token operator\">=</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> metricName<span class=\"token operator\">=</span><span class=\"token string\">'r2'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R2: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>predandlabels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">R2: 0.010070756230703637</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">spark<span class=\"token punctuation\">.</span>stop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p><a href=\"https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners\">https://www.kaggle.com/code/fatmakursun/pyspark-ml-tutorial-for-beginners</a></p>\n<p><a href=\"https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html\">https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.OneHotEncoder.html</a></p>\n<p><a href=\"https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0\">https://medium.com/@nutanbhogendrasharma/role-of-onehotencoder-and-pipelines-in-pyspark-ml-feature-part-2-3275767e74f0</a></p>\n<p><a href=\"https://spark.apache.org/docs/latest/ml-classification-regression.html\">https://spark.apache.org/docs/latest/ml-classification-regression.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B3%80%EC%88%98-%EC%84%A0%ED%83%9D-%EB%B0%8F-%EB%B3%80%ED%99%98\">ë³€ìˆ˜ ì„ íƒ ë° ë³€í™˜</a></li>\n<li><a href=\"#%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬í•˜ê¸°</a></li>\n<li><a href=\"#%ED%8F%89%EA%B0%80\">í‰ê°€</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 21, 2022","title":"ìˆ™ë°•ì—… ë¶„ì„í•˜ê¸° (3) - MLlib","categories":"Data_Analysis","author":"HwanHee Park","emoji":"ğŸ‘¨â€ğŸ’»"},"fields":{"slug":"/PySpark/[PySpark] ìˆ™ë°•ì—… ë¶„ì„í•˜ê¸° (3) - MLlib/"}},"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/PySpark/PostgreSQLê³¼ ì—°ë™í•˜ê¸°/","nextSlug":"/DataStudio/DataStudio ì‚¬ìš©í•˜ê¸°/","prevSlug":"/PySpark/[PySpark] ìˆ™ë°•ì—… ë¶„ì„í•˜ê¸° (3) - MLlib/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}