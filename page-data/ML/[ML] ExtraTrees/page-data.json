{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/ML/[ML] ExtraTrees/",
    "result": {"data":{"cur":{"id":"1da14877-121f-5d56-a03c-9b3f289f64b0","html":"<h3 id=\"추가-트리-알고리즘\" style=\"position:relative;\"><a href=\"#%EC%B6%94%EA%B0%80-%ED%8A%B8%EB%A6%AC-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\" aria-label=\"추가 트리 알고리즘 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추가 트리 알고리즘</h3>\n<h4 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h4>\n<p>엑스트라 트리 알고리즘은 랜덤포레스트와 마찬가지로 결정 트리 기반의 알고리즘</p>\n<h4 id=\"랜덤포레스트-차이점\" style=\"position:relative;\"><a href=\"#%EB%9E%9C%EB%8D%A4%ED%8F%AC%EB%A0%88%EC%8A%A4%ED%8A%B8-%EC%B0%A8%EC%9D%B4%EC%A0%90\" aria-label=\"랜덤포레스트 차이점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>랜덤포레스트 차이점</h4>\n<p>[1] 부트스트랩 방식을 사용하지 않고 전체데이터를 사용한다.</p>\n<p>[2] <strong>노드를 분할 하는 임계점을 랜덤하게 선택한다.</strong></p>\n<p>-> 결정트리 방식의 임계점은 불순도를 가장 낮추는 방향으로 분리하지만 추가 트리 알고리즘은 그렇지 않다.</p>\n<h4 id=\"임계점-랜덤-선택\" style=\"position:relative;\"><a href=\"#%EC%9E%84%EA%B3%84%EC%A0%90-%EB%9E%9C%EB%8D%A4-%EC%84%A0%ED%83%9D\" aria-label=\"임계점 랜덤 선택 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>임계점 랜덤 선택??</h4>\n<p>임계점을 랜덤으로 선택하면 모델의 성능이 떨어지는 것이 아닌가 할 수 있지만 추가 트리 알고리즘은 앙상블 모델로써 여러 트리 모형 중 가장 좋은 성능의 트리를 선택하여 이를 보완할 수 있다.</p>\n<p>랜덤 포레스트와 결정 트리의 경우 최적의 임계값을 계산하는 과정에 시간이 소요되지만 추가 트리 알고리즘은 무작위로 선택하기 때문에 시간이 적게 걸리며 랜덤 포레스트에 비해 더 많은 트리 구조를 활용할 수 있다는 장점이 있다.</p>\n<h3 id=\"예제--타이타닉\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%9C--%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89\" aria-label=\"예제  타이타닉 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예제 : 타이타닉</h3>\n<p>타이타닉 데이터셋을 통해 랜덤포레스트와 엑스트라트리 알고리즘의 성능을 비교해보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"C:/Users/USER/Project/Kaggle/titanic/titanic_4_ML.csv\"</span><span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Survived</th>\n      <th>Pclass</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>Fare</th>\n      <th>Embarked</th>\n      <th>FamilyNum</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>2</td>\n      <td>1</td>\n      <td>22.0</td>\n      <td>7.2500</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>38.0</td>\n      <td>71.2833</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1.0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>26.0</td>\n      <td>7.9250</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>35.0</td>\n      <td>53.1000</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.0</td>\n      <td>2</td>\n      <td>1</td>\n      <td>35.0</td>\n      <td>8.0500</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df_train <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">891</span><span class=\"token punctuation\">]</span>\ntrain_y <span class=\"token operator\">=</span> df_train<span class=\"token punctuation\">[</span><span class=\"token string\">'Survived'</span><span class=\"token punctuation\">]</span>\ntrain_X <span class=\"token operator\">=</span> df_train<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Survived'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ndf_test <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token number\">891</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\ntest_X <span class=\"token operator\">=</span> df_test<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Survived'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> StandardScaler\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>pipeline <span class=\"token keyword\">import</span> make_pipeline\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> cross_val_score<span class=\"token punctuation\">,</span> cross_val_predict<span class=\"token punctuation\">,</span> KFold\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>svm <span class=\"token keyword\">import</span> SVC\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>ensemble <span class=\"token keyword\">import</span> RandomForestClassifier<span class=\"token punctuation\">,</span> ExtraTreesClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score<span class=\"token punctuation\">,</span> roc_auc_score</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cv <span class=\"token operator\">=</span> KFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\nmodels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> RandomForestClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ExtraTreesClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\naccuracy_list<span class=\"token punctuation\">,</span> auc_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> model <span class=\"token keyword\">in</span> models<span class=\"token punctuation\">:</span>\n    \n    pipe <span class=\"token operator\">=</span> make_pipeline<span class=\"token punctuation\">(</span>StandardScaler<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">)</span>\n    \n    y_preds <span class=\"token operator\">=</span> cross_val_predict<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span>cv<span class=\"token punctuation\">,</span> n_jobs<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    \n    accuracy <span class=\"token operator\">=</span> accuracy_score<span class=\"token punctuation\">(</span>train_y<span class=\"token punctuation\">,</span> y_preds<span class=\"token punctuation\">)</span>\n    auc <span class=\"token operator\">=</span> roc_auc_score<span class=\"token punctuation\">(</span>train_y<span class=\"token punctuation\">,</span> y_preds<span class=\"token punctuation\">)</span>\n    \n    accuracy_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">)</span>\n    auc_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>auc<span class=\"token punctuation\">)</span>\n    \npd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"Accuracy\"</span><span class=\"token punctuation\">:</span> accuracy_list<span class=\"token punctuation\">,</span><span class=\"token string\">\"AUC\"</span><span class=\"token punctuation\">:</span> auc_list<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>models<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span><span class=\"token string\">\"Accuracy\"</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Accuracy</th>\n      <th>AUC</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>RandomForestClassifier()</th>\n      <td>0.804714</td>\n      <td>0.790265</td>\n    </tr>\n    <tr>\n      <th>ExtraTreesClassifier()</th>\n      <td>0.791246</td>\n      <td>0.778233</td>\n    </tr>\n    <tr>\n      <th>DecisionTreeClassifier()</th>\n      <td>0.774411</td>\n      <td>0.757957</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>추가 트리 알고리즘의 성능도 RandomForest보다 나쁘지 않게 나온 것을 확인할 수 있다.</p>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p>[1] <a href=\"https://www.youtube.com/watch?v=Moz8i-tKurk&#x26;t=2015s\">https://www.youtube.com/watch?v=Moz8i-tKurk&#x26;t=2015s</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%B6%94%EA%B0%80-%ED%8A%B8%EB%A6%AC-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\">추가 트리 알고리즘</a></p>\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#%EB%9E%9C%EB%8D%A4%ED%8F%AC%EB%A0%88%EC%8A%A4%ED%8A%B8-%EC%B0%A8%EC%9D%B4%EC%A0%90\">랜덤포레스트 차이점</a></li>\n<li><a href=\"#%EC%9E%84%EA%B3%84%EC%A0%90-%EB%9E%9C%EB%8D%A4-%EC%84%A0%ED%83%9D\">임계점 랜덤 선택??</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%98%88%EC%A0%9C--%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89\">예제 : 타이타닉</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</div>","excerpt":"추가 트리 알고리즘 소개 엑스트라 트리 알고리즘은 랜덤포레스트와 마찬가지로 결정 트리 기반의 알고리즘 랜덤포레스트 차이점 [1] 부트스트랩 방식을 사용하지 않고 전체데이터를 사용한다. [2] 노드를 분할 하는 임계점을 랜덤하게 선택한다. -> 결정트리 방식의 임계점은 불순도를 가장 낮추는 방향으로 분리하지만 추가 트리 알고리즘은 그렇지 않다. 임계점 랜덤 선택?? 임계점을 랜덤으로 선택하면 모델의 성능이 떨어지는 것이 아닌가 할 수 있지만 추가 트리 알고리즘은 앙상블 모델로써 여러 트리 모형 중 가장 좋은 성능의 트리를 선택하여 이를 보완할 수 있다. 랜덤 포레스트와 결정 트리의 경우 최적의 임계값을 계산하는 과정에 시간이 소요되지만 추가 트리 알고리즘은 무작위로 선택하기 때문에 시간이 적게 걸리며 랜덤 포레스트에 비해 더 많은 트리 구조를 활용할 수 있다는 장점이 있다. 예제 : 타이타닉 타이타닉 데이터셋을 통해 랜덤포레스트와 엑스트라트리 알고리즘의 성능을 비교해보자 추가 트리 …","frontmatter":{"date":"October 28, 2022","title":"ExtraTrees","categories":"ML","author":"HwanHee Park","emoji":"📝"},"fields":{"slug":"/ML/[ML] ExtraTrees/"}},"next":{"id":"7d467ff8-6ac1-56fa-ba39-f6f36ed33bb5","html":"<h2 id=\"catboost\" style=\"position:relative;\"><a href=\"#catboost\" aria-label=\"catboost permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CatBoost</h2>\n<p>CatBoost는 Unbiased boosting with categorical features에 초점을 맞춰서 생성된 알고리즘. <strong>즉 범주형 변수에 초점을 두어 만들어진 Boosting 기반의 알고리즘.</strong></p>\n<h3 id=\"주요-알고리즘\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\" aria-label=\"주요 알고리즘 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 알고리즘</h3>\n<p>CatBoost는 앞서 2가지 이슈를 먼저 언급합니다.</p>\n<h4 id=\"target-leakage\" style=\"position:relative;\"><a href=\"#target-leakage\" aria-label=\"target leakage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Target Leakage</h4>\n<p>범주형 변수(categorical Feautres)를 수치형 변수로 변환할 때 target인 label에 대한 정보가 어느 정도 반영됨.즉 target의 정보가 유출</p>\n<p>이로인해 training dataset과 test dataset 간 확률 분포가 불일치</p>\n<h4 id=\"predict-shift\" style=\"position:relative;\"><a href=\"#predict-shift\" aria-label=\"predict shift permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Predict Shift</h4>\n<p>Target Leakage로 인해 Train dataset과 test dataset과는 다른 확률 분포를 가질 수 있다. 이 점을 Predict Shift로 정의</p>\n<p>위에 대한 해결방안으로</p>\n<p><strong>Target Leakage -> Ordered TS</strong> , <strong>Predict Shift -> Ordered Boosting</strong> 방법이 제시됨</p>\n<h3 id=\"ordered-ts\" style=\"position:relative;\"><a href=\"#ordered-ts\" aria-label=\"ordered ts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ordered TS</h3>\n<p>위의 TS는 Target Statistic 즉 범주형 변수가 변환 되는 값으로 CatBoost에서는 아래의 식을 통해 계산.</p>\n<p><img src=\"/2468078ea223442249902b699ac2f52b/cb_1.png\" alt=\"cb_1.PNG\"></p>\n<p>구하는 방식을 좀 더 자세히 보자면\n<img src=\"/d73c635671c1a335a7d549d8b9e4e857/cb_2.png\" alt=\"cb_2.PNG\"></p>\n<p>[출처] <a href=\"https://www.youtube.com/watch?v=2Yi_Jse_7JQ&#x26;list=WL&#x26;index=2&#x26;t=1817s\">https://www.youtube.com/watch?v=2Yi_Jse_7JQ&#x26;list=WL&#x26;index=2&#x26;t=1817s</a></p>\n<p>위 식에서 <em>a는 파라미터, p는 관측된 y의 평균</em>으로 <strong>기존 방식에서는 total y의 평균이 반영</strong>된 반면에 위 과정에서는 <strong>관측된 값에 대한 y 값만 다루기 때문에 Target Leakage가 감소</strong></p>\n<h3 id=\"ordered-boosting\" style=\"position:relative;\"><a href=\"#ordered-boosting\" aria-label=\"ordered boosting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ordered Boosting</h3>\n<p>Prediction Shift를 해결하기 위해 기존의 방식 <em>t번째 모형을 바로 잔차 계산에 사용하는 것</em>이 아닌  <strong>t-1번 째 모형을 통해 얻은 값을 잔차 계산에 사용.</strong></p>\n<p><img src=\"/8544d30867da9daa09ad5d48d0e80a50/cb_4.png\" alt=\"cb_4.PNG\"></p>\n<h3 id=\"진행과정\" style=\"position:relative;\"><a href=\"#%EC%A7%84%ED%96%89%EA%B3%BC%EC%A0%95\" aria-label=\"진행과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>진행과정</h3>\n<h4 id=\"1-training-dataset을-s1번-random-permutation\" style=\"position:relative;\"><a href=\"#1-training-dataset%EC%9D%84-s1%EB%B2%88-random-permutation\" aria-label=\"1 training dataset을 s1번 random permutation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Training Dataset을 s+1번 Random Permutation</h4>\n<h5 id=\"2-oblivious-tree-생성\" style=\"position:relative;\"><a href=\"#2-oblivious-tree-%EC%83%9D%EC%84%B1\" aria-label=\"2 oblivious tree 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Oblivious Tree 생성</h5>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVQoz2VSz2sTQRR+u4kxlAhppU1s2lJ/IKVWWixFL+pFkF5EELxI9agHoScLXoR66S3d2d3ZnZ15b2Y2P5rYTdNT/z/J5ocB4YM3vDcfvO/7HgCxcso3rtLVgall+kFmyykHYqD9CYiVLN+67tQyupeZ6oX8Nx2XbVQvtNlDrBjuzGhTOCaoa/GMaJ9oFeNRZzzKCzsSnVM1PBb9BfLBeO4cs6B9MM0tKX4nw7Nk+DJBMOeFMb+C4XNFTisE01y20Sldv0nsPL+o2dek943+uJaBbb433Z9JtoQhGAYFHdzBMJfBHmPy1rQPVVpT0XgxV/ubKv5I3Q/Y2ZRxTfJDbH3WvR0lizTVPMYjJZYp/IGDT7IDeuTKbQx+yasvonOkuifi8lj0vyf9dyI9S4ZrMoJ5V8CwA4W3bLhkoz2pwHhV5LuanqLaIdwnOiC9rdUu4hNLd5HDLA9Q54DeouIu+SUKFpGDZgsUNmTUkPG6jNZjvhHzhuQPpViTUXVCzpO8n9l6D10zUzEN0zAwrGD9lUtdz3S5FYL2wOQfnJxcacevbwavbgbVtgBizizJ/OFov2D8la6sXaiSDZ3cSGd2JI72iyYo2tA1Afx3JBOgN8Jc5y87qB1k8desAQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cb_3.png\"\n        title=\"cb_3.png\"\n        src=\"/static/f25ae1bdac9c314c9366110e549e8ef2/37523/cb_3.png\"\n        srcset=\"/static/f25ae1bdac9c314c9366110e549e8ef2/e9ff0/cb_3.png 180w,\n/static/f25ae1bdac9c314c9366110e549e8ef2/f21e7/cb_3.png 360w,\n/static/f25ae1bdac9c314c9366110e549e8ef2/37523/cb_3.png 720w,\n/static/f25ae1bdac9c314c9366110e549e8ef2/73b94/cb_3.png 1004w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n[출처] <a href=\"https://towardsdatascience.com/introduction-to-gradient-boosting-on-decision-trees-with-catboost-d511a9ccbd14\">https://towardsdatascience.com/introduction-to-gradient-boosting-on-decision-trees-with-catboost-d511a9ccbd14</a></p>\n<h4 id=\"3-ordered-ts-ordered-boosting-과정을-통해-손실-함수를-얻고-이를-최소화하는-학습을-시행\" style=\"position:relative;\"><a href=\"#3-ordered-ts-ordered-boosting-%EA%B3%BC%EC%A0%95%EC%9D%84-%ED%86%B5%ED%95%B4-%EC%86%90%EC%8B%A4-%ED%95%A8%EC%88%98%EB%A5%BC-%EC%96%BB%EA%B3%A0-%EC%9D%B4%EB%A5%BC-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%8A%94-%ED%95%99%EC%8A%B5%EC%9D%84-%EC%8B%9C%ED%96%89\" aria-label=\"3 ordered ts ordered boosting 과정을 통해 손실 함수를 얻고 이를 최소화하는 학습을 시행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Ordered TS, Ordered Boosting 과정을 통해 손실 함수를 얻고 이를 최소화하는 학습을 시행</h4>\n<h4 id=\"4-t번째-데이터를-t-1번째-모형으로-예측하고-잔차와-gradient를-update함-t--s\" style=\"position:relative;\"><a href=\"#4-t%EB%B2%88%EC%A7%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-t-1%EB%B2%88%EC%A7%B8-%EB%AA%A8%ED%98%95%EC%9C%BC%EB%A1%9C-%EC%98%88%EC%B8%A1%ED%95%98%EA%B3%A0-%EC%9E%94%EC%B0%A8%EC%99%80-gradient%EB%A5%BC-update%ED%95%A8-t--s\" aria-label=\"4 t번째 데이터를 t 1번째 모형으로 예측하고 잔차와 gradient를 update함 t  s permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. t번째 데이터를 t-1번째 모형으로 예측하고 잔차와 Gradient를 update함 (t &#x3C; s)</h4>\n<h4 id=\"5-s번째-예측이-완료되면-완료된-모형으로-남은-1번에-적용하여-leaf-value값을-얻음\" style=\"position:relative;\"><a href=\"#5-s%EB%B2%88%EC%A7%B8-%EC%98%88%EC%B8%A1%EC%9D%B4-%EC%99%84%EB%A3%8C%EB%90%98%EB%A9%B4-%EC%99%84%EB%A3%8C%EB%90%9C-%EB%AA%A8%ED%98%95%EC%9C%BC%EB%A1%9C-%EB%82%A8%EC%9D%80-1%EB%B2%88%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%98%EC%97%AC-leaf-value%EA%B0%92%EC%9D%84-%EC%96%BB%EC%9D%8C\" aria-label=\"5 s번째 예측이 완료되면 완료된 모형으로 남은 1번에 적용하여 leaf value값을 얻음 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. s번째 예측이 완료되면 완료된 모형으로 남은 1번에 적용하여 leaf value값을 얻음.</h4>\n<p>※Oblivious Tree를 사용하는 이유는 3~4과정을 기존의 트리 모형으로는 메모리 부족 issue가 발생. 따라서 Oblivious Tree 구조를 사용</p>\n<h3 id=\"장단점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EB%8B%A8%EC%A0%90\" aria-label=\"장단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장단점</h3>\n<h4 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h4>\n<ul>\n<li>\n<p>범수형 변수에 대한 인코딩 방식 제공함에 따라 일반적으로 범주형 변수가 많은 데이터셋의 예측력이 다른 부스팅 알고리즘에 비해 뛰어나다.</p>\n</li>\n<li>\n<p>다른 부스팅 계열 Xgboost, LightGBM에 비해 최적 하이퍼 파라미터 튜닝에 덜 민감하다. 파라미터 최적화가 잘 되어있다.</p>\n</li>\n</ul>\n<h4 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h4>\n<ul>\n<li>\n<p>LightGBM에서 언급한 Sparse Feature Space는 처리하지 못한다.</p>\n</li>\n<li>\n<p>수치형 변수가 많은 데이터셋의 경우 LightGBM에 비해 학습 속도가 느리다.</p>\n</li>\n</ul>\n<h3 id=\"hyper-parameter\" style=\"position:relative;\"><a href=\"#hyper-parameter\" aria-label=\"hyper parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hyper Parameter</h3>\n<p><strong>loss_function</strong></p>\n<blockquote>\n<p>훈련에 사용될 손실함수</p>\n</blockquote>\n<p><strong>eval_metric</strong></p>\n<blockquote>\n<p>최적의 모델 선택을 위한 함수. 선택적으로 파라미터를 입력</p>\n</blockquote>\n<p><strong>iterations</strong></p>\n<blockquote>\n<p>최대 트리의 수. default=1000</p>\n</blockquote>\n<p><strong>learning_rate</strong></p>\n<blockquote>\n<p>학습률. default=0.03</p>\n</blockquote>\n<p><strong>random_seed</strong></p>\n<blockquote>\n<p>random seed</p>\n</blockquote>\n<p><strong>l2_leaf_reg</strong></p>\n<blockquote>\n<p>비용 함수의 L2 정규화 계수. default=3.0</p>\n</blockquote>\n<p><strong>bootstrap_type</strong></p>\n<blockquote>\n<p>개체의 가중치를 샘플링하는 방법. 베이지안, 베르누이, MVS, 포아송 등</p>\n</blockquote>\n<p><strong>bagging_temperature</strong></p>\n<blockquote>\n<p>베이지안 부트스트랩 설정을 정의. 1로 설정된 경우 객체의 가중치는 지수 분포에서 샘플링. 0인 경우 모든 가중치는 1로 설정. default=1</p>\n</blockquote>\n<p><strong>subsample</strong></p>\n<blockquote>\n<p>배깅에 대한 샘플 비율. default는 데이터셋과 bootstrap 유형에 따라 결정. 0.66~1</p>\n</blockquote>\n<p><strong>sample_frequency</strong></p>\n<blockquote>\n<p>트리 구조를 만들 때 가중치와 객체의 샘플링 빈도. default는 PerTreeLevel</p>\n</blockquote>\n<p><strong>best_model_min_treees</strong></p>\n<blockquote>\n<p>최상의 모델이 가져야 하는 최소 트리 수</p>\n</blockquote>\n<p><strong>depth</strong>\n트리의 깊이. default= 16</p>\n<p><strong>min_data_in_leaf</strong></p>\n<blockquote>\n<p>leaf의 최소 훈련 샘플 수 지정된 값보다 적은 샘플 수가 있는 잎에서 분할 중지. default=1</p>\n</blockquote>\n<p><strong>max_leaves</strong></p>\n<blockquote>\n<p>결과 트리의 최대 리프의 수. default= 31</p>\n</blockquote>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p>[1] <a href=\"https://www.youtube.com/watch?v=2Yi_Jse_7JQ&#x26;list=WL&#x26;index=2&#x26;t=1817s\">https://www.youtube.com/watch?v=2Yi_Jse_7JQ&#x26;list=WL&#x26;index=2&#x26;t=1817s</a></p>\n<p>[2] <a href=\"https://gentlej90.tistory.com/100\">https://gentlej90.tistory.com/100</a></p>\n<p>[3] <a href=\"https://catboost.ai/en/docs/concepts/python-reference_catboost\">https://catboost.ai/en/docs/concepts/python-reference_catboost</a></p>\n<p>[4] <a href=\"https://catboost.ai/en/docs/references/training-parameters/common#eval_metric\">https://catboost.ai/en/docs/references/training-parameters/common#eval_metric</a></p>\n<p>[5] <a href=\"https://dailyheumsi.tistory.com/136\">https://dailyheumsi.tistory.com/136</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#catboost\">CatBoost</a></p>\n<ul>\n<li>\n<p><a href=\"#%EC%A3%BC%EC%9A%94-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\">주요 알고리즘</a></p>\n<ul>\n<li><a href=\"#target-leakage\">Target Leakage</a></li>\n<li><a href=\"#predict-shift\">Predict Shift</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ordered-ts\">Ordered TS</a></p>\n</li>\n<li>\n<p><a href=\"#ordered-boosting\">Ordered Boosting</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A7%84%ED%96%89%EA%B3%BC%EC%A0%95\">진행과정</a></p>\n<ul>\n<li>\n<p><a href=\"#1-training-dataset%EC%9D%84-s1%EB%B2%88-random-permutation\">1. Training Dataset을 s+1번 Random Permutation</a></p>\n<ul>\n<li><a href=\"#2-oblivious-tree-%EC%83%9D%EC%84%B1\">2. Oblivious Tree 생성</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-ordered-ts-ordered-boosting-%EA%B3%BC%EC%A0%95%EC%9D%84-%ED%86%B5%ED%95%B4-%EC%86%90%EC%8B%A4-%ED%95%A8%EC%88%98%EB%A5%BC-%EC%96%BB%EA%B3%A0-%EC%9D%B4%EB%A5%BC-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%8A%94-%ED%95%99%EC%8A%B5%EC%9D%84-%EC%8B%9C%ED%96%89\">3. Ordered TS, Ordered Boosting 과정을 통해 손실 함수를 얻고 이를 최소화하는 학습을 시행</a></p>\n</li>\n<li>\n<p><a href=\"#4-t%EB%B2%88%EC%A7%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-t-1%EB%B2%88%EC%A7%B8-%EB%AA%A8%ED%98%95%EC%9C%BC%EB%A1%9C-%EC%98%88%EC%B8%A1%ED%95%98%EA%B3%A0-%EC%9E%94%EC%B0%A8%EC%99%80-gradient%EB%A5%BC-update%ED%95%A8-t--s\">4. t번째 데이터를 t-1번째 모형으로 예측하고 잔차와 Gradient를 update함 (t &#x3C; s)</a></p>\n</li>\n<li>\n<p><a href=\"#5-s%EB%B2%88%EC%A7%B8-%EC%98%88%EC%B8%A1%EC%9D%B4-%EC%99%84%EB%A3%8C%EB%90%98%EB%A9%B4-%EC%99%84%EB%A3%8C%EB%90%9C-%EB%AA%A8%ED%98%95%EC%9C%BC%EB%A1%9C-%EB%82%A8%EC%9D%80-1%EB%B2%88%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%98%EC%97%AC-leaf-value%EA%B0%92%EC%9D%84-%EC%96%BB%EC%9D%8C\">5. s번째 예측이 완료되면 완료된 모형으로 남은 1번에 적용하여 leaf value값을 얻음.</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9E%A5%EB%8B%A8%EC%A0%90\">장단점</a></p>\n<ul>\n<li><a href=\"#%EC%9E%A5%EC%A0%90\">장점</a></li>\n<li><a href=\"#%EB%8B%A8%EC%A0%90\">단점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#hyper-parameter\">Hyper Parameter</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"October 16, 2022","title":"CatBoost","categories":"ML","author":"HwanHee Park","emoji":"📝"},"fields":{"slug":"/ML/[ML] CatBoost/"}},"prev":{"id":"421e62cb-df32-5ffe-adc6-b878fa069478","html":"<h2 id=\"데이터-저장-방식\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%80%EC%9E%A5-%EB%B0%A9%EC%8B%9D\" aria-label=\"데이터 저장 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 저장 방식</h2>\n<h3 id=\"유형\" style=\"position:relative;\"><a href=\"#%EC%9C%A0%ED%98%95\" aria-label=\"유형 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>유형</h3>\n<ul>\n<li>csv</li>\n</ul>\n<blockquote>\n<p>csv란 쉼표로 구분한 텍스트 기반의 저장 방식\n<img src=\"/e3629126f3c50b70081955eab51101b3/csv.png\" alt=\"csv.PNG\"></p>\n</blockquote>\n<ul>\n<li>json</li>\n</ul>\n<blockquote>\n<p>json은 자바스크립트 객체 표기법으로 key:value 형식으로 구성된 텍스트 기반의 저장 방식</p>\n</blockquote>\n<blockquote>\n<p><img src=\"/e2b268c666c75b249bccdb1d684254a7/json.png\" alt=\"json.PNG\"></p>\n</blockquote>\n<ul>\n<li>pickle</li>\n</ul>\n<blockquote>\n<p>pickle은 텍스트 형식으로 저장하는 것이 아닌 바이너리 형태로 저장하는 것으로 대용량 데이터라도 빠르게 호출이 가능하다.</p>\n</blockquote>\n<ul>\n<li>parquet</li>\n</ul>\n<blockquote>\n<p>parquet은 Hadoop기반 저장방식으로 column 기반의 압축방식으로 pickle보다 압축률이 뛰어나다는 장점이 있으나 pyarrow, fastparquet등의 추가적인 패키지 인스톨이 필요하다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> os\n\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">r\"C:/Users/USER/Project/everyday_python/data\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"df_uci_adult.csv\"</span><span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<h3 id=\"csv\" style=\"position:relative;\"><a href=\"#csv\" aria-label=\"csv permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>csv</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.csv\"</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"csv-불러오기\" style=\"position:relative;\"><a href=\"#csv-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"csv 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>csv 불러오기</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df1 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.csv\"</span><span class=\"token punctuation\">)</span>\n\ndf1<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<h3 id=\"json\" style=\"position:relative;\"><a href=\"#json\" aria-label=\"json permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>json</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>to_json<span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.json\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"json-불러오기\" style=\"position:relative;\"><a href=\"#json-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"json 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>json 불러오기</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df2 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_json<span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.json\"</span><span class=\"token punctuation\">)</span>\n\ndf2<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<h3 id=\"pickle\" style=\"position:relative;\"><a href=\"#pickle\" aria-label=\"pickle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pickle</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickle\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.pickle\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> w<span class=\"token punctuation\">:</span>\n    pickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span> </code></pre></div>\n<h4 id=\"pickle-불러오기\" style=\"position:relative;\"><a href=\"#pickle-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"pickle 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pickle 불러오기</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.pickle\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> r<span class=\"token punctuation\">:</span>\n    df3 <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span>\n    \ndf3<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<h3 id=\"parquet\" style=\"position:relative;\"><a href=\"#parquet\" aria-label=\"parquet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parquet</h3>\n<p>fastparquet 패키지 필요</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>to_parquet<span class=\"token punctuation\">(</span><span class=\"token string\">'sample.parquet'</span><span class=\"token punctuation\">,</span> compression<span class=\"token operator\">=</span><span class=\"token string\">'gzip'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"parquet-불러오기\" style=\"position:relative;\"><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"parquet 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>parquet 불러오기</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df4 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_parquet<span class=\"token punctuation\">(</span><span class=\"token string\">'sample.parquet'</span><span class=\"token punctuation\">)</span>\ndf4<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>특정 칼럼 지정해서 불러오기</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df5 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_parquet<span class=\"token punctuation\">(</span><span class=\"token string\">'sample.parquet'</span><span class=\"token punctuation\">,</span> columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'education'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\ndf5<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>education</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>2</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>4</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>8</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>2</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>5</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%80%EC%9E%A5-%EB%B0%A9%EC%8B%9D\">데이터 저장 방식</a></p>\n<ul>\n<li>\n<p><a href=\"#%EC%9C%A0%ED%98%95\">유형</a></p>\n</li>\n<li>\n<p><a href=\"#csv\">csv</a></p>\n<ul>\n<li><a href=\"#csv-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">csv 불러오기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#json\">json</a></p>\n<ul>\n<li><a href=\"#json-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">json 불러오기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#pickle\">pickle</a></p>\n<ul>\n<li><a href=\"#pickle-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">pickle 불러오기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#parquet\">Parquet</a></p>\n<ul>\n<li><a href=\"#parquet-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">parquet 불러오기</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"November 12, 2022","title":"데이터 저장방식","categories":"Python","author":"HwanHee Park","emoji":"💻"},"fields":{"slug":"/Python/[python] CSV,JSON,Pickle,Parquet/"}},"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/ML/[ML] ExtraTrees/","nextSlug":"/ML/[ML] CatBoost/","prevSlug":"/Python/[python] CSV,JSON,Pickle,Parquet/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}