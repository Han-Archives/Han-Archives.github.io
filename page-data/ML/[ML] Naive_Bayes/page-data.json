{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/ML/[ML] Naive_Bayes/",
    "result": {"data":{"cur":{"id":"ff193421-b6e2-575c-9d2a-4b47424d3d44","html":"<h2 id=\"naive-bayes\" style=\"position:relative;\"><a href=\"#naive-bayes\" aria-label=\"naive bayes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Naive Bayes</h2>\n<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>나이브 베이즈란 베이즈 정리를 기반으로 한 분류 알고리즘. 단순하고 빠르며 정확도도 갖춘 알고리즘이지만 변수들간의 독립성이라는 조건이 만족되어야 한다.</p>\n<h3 id=\"베이즈-정리\" style=\"position:relative;\"><a href=\"#%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%A0%95%EB%A6%AC\" aria-label=\"베이즈 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>베이즈 정리</h3>\n<p>데이터라는 조건이 주어졌을 때 조건부확률을 구하는 공식으로 새로운 정보로 인해 기존의 값이 어떻게 영향을 받는 지 알 수 있다.</p>\n<ul>\n<li>사전 확률</li>\n</ul>\n<blockquote>\n<p>P(A)</p>\n</blockquote>\n<ul>\n<li>조건부 확률 (사후 확률)</li>\n</ul>\n<blockquote>\n<p>${P(A|B)  = {P(A \\cap B) \\over P(B)} = {P(B|A)P(A) \\over P(B)}}$</p>\n</blockquote>\n<h4 id=\"예시--x켓몬-빵-구매\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%8B%9C--x%EC%BC%93%EB%AA%AC-%EB%B9%B5-%EA%B5%AC%EB%A7%A4\" aria-label=\"예시  x켓몬 빵 구매 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예시 : x켓몬 빵 구매</h4>\n<p>근처 편의점에 x켓몬 빵을 사러 갔을 때 구입 유무에 대한 표이다. 위 표를 근거로 점심에 편의점에 갔을 때 x켓몬 빵을 살 확률은?</p>\n<p><img src=\"/60deb62704eda7b302e0d82d9738fb2f/nb_1.png\" alt=\"nb_1.PNG\"></p>\n<h3 id=\"예제-라면사-분류\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%9C-%EB%9D%BC%EB%A9%B4%EC%82%AC-%EB%B6%84%EB%A5%98\" aria-label=\"예제 라면사 분류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예제: 라면사 분류</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> warnings\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score<span class=\"token punctuation\">,</span> roc_auc_score\n\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span>action<span class=\"token operator\">=</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 데이터 불러오기</span>\nramen <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'C:/Users/USER/Project/everyday_python/data/df_ramen.csv'</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'cp949'</span><span class=\"token punctuation\">)</span>\nramen<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'item'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'place'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'region'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MultiColumnLabelEncoder</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>columns <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> columns <span class=\"token comment\"># array of column names to encode</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">fit</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>X<span class=\"token punctuation\">,</span>y<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> self <span class=\"token comment\"># not relevant here</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">transform</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">'''\n        Transforms columns of X specified in self.columns using\n        LabelEncoder(). If no columns specified, transforms all\n        columns in X.\n        '''</span>\n        output <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>columns <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">:</span>\n                output<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">for</span> colname<span class=\"token punctuation\">,</span>col <span class=\"token keyword\">in</span> output<span class=\"token punctuation\">.</span>iteritems<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                output<span class=\"token punctuation\">[</span>colname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> output\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">fit_transform</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>X<span class=\"token punctuation\">,</span>y<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> MultiColumnLabelEncoder<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'item'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'place'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'region'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>ramen<span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n\nX <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'place'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'region'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'item'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split\n\nX_train<span class=\"token punctuation\">,</span> X_test<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> test_size<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>naive_bayes <span class=\"token keyword\">import</span> CategoricalNB\n\ncnb <span class=\"token operator\">=</span> CategoricalNB<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npred <span class=\"token operator\">=</span> cnb<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">acc <span class=\"token operator\">=</span> accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span> pred<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"예측 정확도 : {0:.3f}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">예측 정확도 : 0.768</code></pre></div>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p>[1] <a href=\"https://datascienceschool.net/02%20mathematics/06.06%20%EB%B2%A0%EC%9D%B4%EC%A6%88%20%EC%A0%95%EB%A6%AC.html\">https://datascienceschool.net/02%20mathematics/06.06%20%EB%B2%A0%EC%9D%B4%EC%A6%88%20%EC%A0%95%EB%A6%AC.html</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#naive-bayes\">Naive Bayes</a></p>\n<ul>\n<li>\n<p><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%A0%95%EB%A6%AC\">베이즈 정리</a></p>\n<ul>\n<li><a href=\"#%EC%98%88%EC%8B%9C--x%EC%BC%93%EB%AA%AC-%EB%B9%B5-%EA%B5%AC%EB%A7%A4\">예시 : x켓몬 빵 구매</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%98%88%EC%A0%9C-%EB%9D%BC%EB%A9%B4%EC%82%AC-%EB%B6%84%EB%A5%98\">예제: 라면사 분류</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"Naive Bayes 소개 나이브 베이즈란 베이즈 정리를 기반으로 한 분류 알고리즘. 단순하고 빠르며 정확도도 갖춘 알고리즘이지만 변수들간의 독립성이라는 조건이 만족되어야 한다. 베이즈 정리 데이터라는 조건이 주어졌을 때 조건부확률을 구하는 공식으로 새로운 정보로 인해 기존의 값이 어떻게 영향을 받는 지 알 수 있다. 사전 확률 P(A) 조건부 확률 (사후 확률) ${P(A|B)  = {P(A \\cap B) \\over P(B)} = {P(B|A)P(A) \\over P(B)}}$ 예시 : x켓몬 빵 구매 근처 편의점에 x켓몬 빵을 사러 갔을 때 구입 유무에 대한 표이다. 위 표를 근거로 점심에 편의점에 갔을 때 x켓몬 빵을 살 확률은? nb_1.PNG 예제: 라면사 분류 Reference [1] https://datascienceschool.net/02%20mathematics/06.06%20%EB%B2%A0%EC%9D%B4%EC%A6%88%20%EC%A0%95%EB%A6%AC.ht…","frontmatter":{"date":"September 17, 2022","title":"Naive_Bayes","categories":"ML","author":"HwanHee Park","emoji":"📝"},"fields":{"slug":"/ML/[ML] Naive_Bayes/"}},"next":{"id":"3d8213a9-81c8-51fb-b8d4-e1c46eebff19","html":"<h3 id=\"교차-검증\" style=\"position:relative;\"><a href=\"#%EA%B5%90%EC%B0%A8-%EA%B2%80%EC%A6%9D\" aria-label=\"교차 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>교차 검증</h3>\n<p>고정된 학습 데이터와 테스트 데이터로 평가를 하면 <strong>과적합의 문제가 발생</strong>한다. 이를 방지하기 위해 <strong>교차검증</strong>이라는 방식을 사용하여 과적합을 방지한다.</p>\n<h4 id=\"k-fold\" style=\"position:relative;\"><a href=\"#k-fold\" aria-label=\"k fold permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K-Fold</h4>\n<p>학습 데이터를 K 개의 Fold로 나누고 <strong>나누어진 폴드 중 하나를 검증용, 나머지를 학습용으로 선정</strong>한 뒤 위 그림처럼 검증용 폴드를 변경하면서 학습과 검증을 수행하는 것.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAADWUlEQVQ4y3WU61PbRhTF/f9/a/ulkzalmSaUZAhQGJpAmTaUxkB41DwMxjbGlrGFJe1KK1vWW7+OhHF49WrO3Kvd1dE9e+9uKcsy0jQlTbNHuB1LkpSkiL/6x3HOkVvuSyPPxxQSIe0prAmEdLhqt2heXiJtB0cNsR0X21FF7CgXS0hyjilh/oc4SR4ijgmjOF/C4kaT04ZFFI7RbwYIKZG2ja7rGKZJGEaFkikh9y3jiS1ttKnWbUgi9J6OY0tcx8EwDIRlkSXxlCy30kk8YD6ushzXWE5qLAZV3ug7vO6VeSsP+ECdlbTGclZjPdSYr8PMSciLbYOfDl1mzjI0lRRkaZ6h7nucjwUNX9IIJBdjwanUqco+58qgFTs0Q5tzT9D0HGpGwrEeUtEUle6IIz1hGKb3JOfxfeQuTAnHt1IGNx7j0SSDKC2kk6WQJoS+N92rW8UZpYyvT1qMZvhhjHbjEcYx385W2Tq8gSygo2lo3S6apjHyvGlW2eS73JXuBrJJTdLJ5saTyvWMEdINijhKkmI+edR7D/rwrprCHKBfd1BSoTU1HOHS7/SxDYEYiNvYUnRbXYQpiaLoCWFR5TAMi17a7wxZP1UcS4uyOON01KdsNdkXHQ5kp4hPVJ8ts86Z2SUc+w8I71DK+8m0LJYaBt/stljp67w432PVavNKL/PerLBgHfFzr8xHdcEP2t/8YzZIw5jnrKRUfowUW6M6i2qXP3qSmbJkre2yYB7x0aqzZtcK0k23xbvBPoeOhhI2hmkUDV4kZZrFuS4IlXLZUA1eG/tsjC751dhhTWh8X1bMHilW7Cpzco8Nt8Evgy/siBbBaEwQBnieh+/7BQrJlmUhhOCTrDN3vcvm8Iq59jaf3Cvedf9lVa/x/ljw8rPBn1aHOX2TPdEg8cPnJTuOjZQ2H9Q5L40dfh/WmdG3WR1e8MraZV4e8fa6xY/tGkuawXeVDn+1DZI4fZ5wPB4z9n1q3g27TouLwOSLuKQWmOw5bU5GPSpum215xkHPZu3YplLvEVtNxkYL1avjGy1iu0uWJo9um/+xLIgZCYVjDgg8F6mdEVV/wz5coPt5FreyQFRfJ40CSsOhW7SN7TjYjl14SwiEfXvvKVdN5/wgnJympzfd3ft/D42WbmqHnbMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cv_1.png\"\n        title=\"cv_1.png\"\n        src=\"/static/a7948edca84aa194bbaef25dd91c839c/37523/cv_1.png\"\n        srcset=\"/static/a7948edca84aa194bbaef25dd91c839c/e9ff0/cv_1.png 180w,\n/static/a7948edca84aa194bbaef25dd91c839c/f21e7/cv_1.png 360w,\n/static/a7948edca84aa194bbaef25dd91c839c/37523/cv_1.png 720w,\n/static/a7948edca84aa194bbaef25dd91c839c/6029f/cv_1.png 906w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h4 id=\"대표적인-클래스로-kfold-stratified-k-fold-cross_val_score가-있다\" style=\"position:relative;\"><a href=\"#%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A1%9C-kfold-stratified-k-fold-cross_val_score%EA%B0%80-%EC%9E%88%EB%8B%A4\" aria-label=\"대표적인 클래스로 kfold stratified k fold cross_val_score가 있다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대표적인 클래스로 KFold, Stratified k-fold, Cross_val_score가 있다.</h4>\n<h3 id=\"좋은-파라미터를-찾는-법\" style=\"position:relative;\"><a href=\"#%EC%A2%8B%EC%9D%80-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0%EB%A5%BC-%EC%B0%BE%EB%8A%94-%EB%B2%95\" aria-label=\"좋은 파라미터를 찾는 법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>좋은 파라미터를 찾는 법</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAC4gAAAuIAHVHB4bAAADYUlEQVQ4y42TT0wcZRjGn91ZaWrRFhPTSm8mmnhpY1PTmvRgSCpRi9VCrS0srBBYZofdZf7/Z9mBxbZWS6zQDYUUugssUHaHUlpaaFNoSjWkaXtbE73UGDRUjScPaj7zTfDgzTf5knnzPfPkfX/zDCRlnKjGZaLoU0RSc8ROXCXhSH/r572rSJ28wyyvED8hBMeOdzR2dt0gsjbh6QzbJaY9QyrfCR948hPBg8fEB1qKPrWuGdPrsjaxLqm5Nbtz7k+WS9f3nnsEu3OupDD7dwBAec1HRshJLf6hGtNrojK2ZtgzP3ckr/2y780PqgBsJYT4jlQrDPXcAmATgD2BQMlWAJsBBPx+BmbHFTipW1SzY+0p8bT79h/eVn1UK9+1u6IMQMmG/jm2LQ2WSwOtkf4mWZ0IHalRerjoQIsgZdn60MlX6JpNzWdrYu0XQ1Xvx7tbI+dDcWEkWBvs3t3U0ovaYNdeQRqtPVHnxI8eMzVJzdV+WC03gDKkLOzOOSJrk8RKzJKqw/FzAF7TzPxfmpn3eOlm3ju8mBk607sKRZucTHbfJLpVIFTjpBYJFx0gaIsNLkpKbqFduLTEi5kbojL+dbCh5z26Ni9l8oo+9Y0gZVdEZWxZUnMPw2xf1ErM0vUkzcyv8lJ2KRofuq9bhTsNjaeXYFgu4vwI5fNiNvcrdKuAMNvnfbBPT99Fwpmnjy9QBB3Ja17fly76+we+hZNaxEY9L6sTOHVmBeCiF1zNmM63RvrvCfKoK2uTC6Gmz96mBlz0wlnNzM+xXHpZkLKzij4138J+JfNSBryYCVBN+c5XS0tLy3ZSV5ZL+xHjh4lhuUS3XC+PlMnHJxIOgJdZLv0b7XWP44yXQbYtfUuQR1FXn3pmY7pnAbz076geC17MSDH+ohwXRoR24ZJVV5/aNTT8A70LCtKo1tj8RTISHdBEeUxvDn9Z9e4hDjR39H2/n9nyH0PDnkFXz20kuxc8JvS0xQYxOPzEl3Cug7KhU9D1it8TakR7GnYaYmq6yefz7aC59UrVLzPJrptMInmdSTj0zDMsd9739HeChk9OMYQQP4Dtb1UEOcN2fzQst6hbhaJuuUVRGf9u7xuHKgCU4f8WXY1OdbCyWTPtKx5LL5NWwfunX99TeZzeb0yOfwBqQrCI+l9H1QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cv_2.png\"\n        title=\"cv_2.png\"\n        src=\"/static/abe5e712ef7918c0abc358b70364a535/37523/cv_2.png\"\n        srcset=\"/static/abe5e712ef7918c0abc358b70364a535/e9ff0/cv_2.png 180w,\n/static/abe5e712ef7918c0abc358b70364a535/f21e7/cv_2.png 360w,\n/static/abe5e712ef7918c0abc358b70364a535/37523/cv_2.png 720w,\n/static/abe5e712ef7918c0abc358b70364a535/302a4/cv_2.png 1080w,\n/static/abe5e712ef7918c0abc358b70364a535/07a9c/cv_2.png 1440w,\n/static/abe5e712ef7918c0abc358b70364a535/ea941/cv_2.png 2031w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h3 id=\"예시-중산층-분류하기\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%8B%9C-%EC%A4%91%EC%82%B0%EC%B8%B5-%EB%B6%84%EB%A5%98%ED%95%98%EA%B8%B0\" aria-label=\"예시 중산층 분류하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예시: 중산층 분류하기</h3>\n<h4 id=\"데이터셋-준비\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%A4%80%EB%B9%84\" aria-label=\"데이터셋 준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터셋 준비</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> rcParams\nrcParams<span class=\"token punctuation\">[</span><span class=\"token string\">'figure.figsize'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> warnings\n\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span>action<span class=\"token operator\">=</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"./data/df_uci_adult.csv\"</span><span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>fnlwgt</th>\n      <th>education</th>\n      <th>marital.status</th>\n      <th>occupation</th>\n      <th>relationship</th>\n      <th>sex</th>\n      <th>capital_gain</th>\n      <th>capital_loss</th>\n      <th>hours-per-week</th>\n      <th>income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>50</td>\n      <td>83311</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>13</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>38</td>\n      <td>215646</td>\n      <td>4</td>\n      <td>2</td>\n      <td>5</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>53</td>\n      <td>234721</td>\n      <td>8</td>\n      <td>0</td>\n      <td>5</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>28</td>\n      <td>338409</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>37</td>\n      <td>284582</td>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>40</td>\n      <td>&lt;=50K</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder\ncategorical <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'education'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'marital.status'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'relationship'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sex'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span>\nlabel_encoder <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> categorical<span class=\"token punctuation\">:</span>\n    label_encoder<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> label_encoder<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split\n<span class=\"token comment\"># features</span>\nX <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'education'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'marital.status'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'relationship'</span><span class=\"token punctuation\">,</span>\n     <span class=\"token string\">'sex'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fnlwgt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'capital_gain'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'capital_loss'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hours-per-week'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># label</span>\ny <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h4 id=\"k-fold-1\" style=\"position:relative;\"><a href=\"#k-fold-1\" aria-label=\"k fold 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K-Fold</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> KFold\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">from</span> xgboost <span class=\"token keyword\">import</span> XGBClassifier\n\n<span class=\"token comment\"># 5개의 Fold</span>\nkfold <span class=\"token operator\">=</span> KFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># cv(split)별 정확도</span>\ncv_accuracy <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\nxgbclf <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 반복 횟수</span>\nn <span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> test_index <span class=\"token keyword\">in</span> kfold<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    X_train<span class=\"token punctuation\">,</span> X_test<span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span>y<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    \n    <span class=\"token comment\"># ML 학습 및 예측</span>\n    xgbclf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n    xgb_pred <span class=\"token operator\">=</span> xgbclf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n    \n    n <span class=\"token operator\">+=</span><span class=\"token number\">1</span>\n    <span class=\"token comment\"># 반복할 때마다 정확도 측정</span>\n    acc <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span> xgb_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    train_size <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    test_size <span class=\"token operator\">=</span> X_test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n#{0} 교차 검증 정확도 : {1}, 학습 데이터 크기: {2}, 검증 데이터 크기\" {3}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> acc<span class=\"token punctuation\">,</span> train_size<span class=\"token punctuation\">,</span> test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#{0} 검증 셋 인덱스:{1}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \n    cv_accuracy<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span>\n    \n<span class=\"token comment\"># 개별 iter별 정확도 평균 계산</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n 평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>cv_accuracy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[20:58:01] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#1 교차 검증 정확도 : 0.865, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#1 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:58:02] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#2 교차 검증 정확도 : 0.867, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#2 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:58:03] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#3 교차 검증 정확도 : 0.868, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#3 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:58:04] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#4 교차 검증 정확도 : 0.87, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#4 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:58:04] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#5 교차 검증 정확도 : 0.865, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#5 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n\n 평균 검증 정확도: 0.867</code></pre></div>\n<h4 id=\"stratified-k-fold\" style=\"position:relative;\"><a href=\"#stratified-k-fold\" aria-label=\"stratified k fold permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stratified k-fold</h4>\n<p>아래 그림과 같이 target값이 <strong>불균형한 분포를 가진 데이터 집합</strong>을 위한 방식으로 target 분포와 비슷한 비율 (예제의 경우 3:1)로 학습 데이터와 테스트 데이터셋에 분배한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 전체 데이터 중 목표값 비율</span>\nsns<span class=\"token punctuation\">.</span>set_style<span class=\"token punctuation\">(</span><span class=\"token string\">\"whitegrid\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'Income Distribution of Adults'</span><span class=\"token punctuation\">,</span> fontsize<span class=\"token operator\">=</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> fontweight<span class=\"token operator\">=</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">)</span>\neda_percentage <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span>normalize <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rename_axis<span class=\"token punctuation\">(</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reset_index<span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'Percentage'</span><span class=\"token punctuation\">)</span>\n\nax <span class=\"token operator\">=</span> sns<span class=\"token punctuation\">.</span>barplot<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">'Percentage'</span><span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> eda_percentage<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> palette<span class=\"token operator\">=</span><span class=\"token string\">'Greens_r'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> p <span class=\"token keyword\">in</span> ax<span class=\"token punctuation\">.</span>patches<span class=\"token punctuation\">:</span>\n    width <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>get_width<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    height <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>get_height<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>get_xy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n    ax<span class=\"token punctuation\">.</span>annotate<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>height<span class=\"token punctuation\">:</span><span class=\"token format-spec\">.0%</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> width<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> height<span class=\"token operator\">*</span><span class=\"token number\">1.02</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ha<span class=\"token operator\">=</span><span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span> fontweight<span class=\"token operator\">=</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB1ElEQVQoz5WS3WvTYBSH+yd54Y2K4lfV+YHo3GRbJyp4oV7ofyGCc7pOd+G82MU2XArqdJ0g65woelE71i8Et6TVkqbtEpt2FaFJHnnfltChVjzwcA7hzcPvzUkAoOk4WFtVzK3vWI0qumlQsU3Wv6pk1c+oeY2irmOaJoVCQXZRruv6eJ4newAPyrVNQlM3OTd5lf7H1+mbvCb74NQNTj+6wmL2jRR44nC7OiW/CQ27wpHxYfaN9rP/3nmfA/cH2Hn7FE8+vaB1k6b/8p9oCV0wqmVOTFzi0NggwXCIYHhIcnR8mN0jZ4kkotuE3Qh4jkeptsnxhxc5ODbA4fCQj0i9684ZX+i4zl/T+Qkb9QbluklPF6GSWPjPhHala0KlnVCk8Ktj7FyUXMq/ha2EmqWypifIlJKsFuKsfovLea2YYMP80rEUu8LJicttSYhgm2MPLrDnbq8v/JB/h5Kc5llG4WlmTiJmJTXDirokv3FAHDTssvxFRBohkIz0sne0jx23epiNz0vhx/x7IqkZnmcjUiQQcyQ1y1st1kroOg6Nnz94lV1hIR0jml7mZXKJaDrGYnqZ+eRr1ss5vKZLqW6gmRvkLY2cqZKzVDmLZ8WaLoW/AL4K1qMcCQxnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cv_3.png\"\n        title=\"cv_3.png\"\n        src=\"/static/334b3ced386e42d4afa8774ec5ca8c62/37523/cv_3.png\"\n        srcset=\"/static/334b3ced386e42d4afa8774ec5ca8c62/e9ff0/cv_3.png 180w,\n/static/334b3ced386e42d4afa8774ec5ca8c62/f21e7/cv_3.png 360w,\n/static/334b3ced386e42d4afa8774ec5ca8c62/37523/cv_3.png 720w,\n/static/334b3ced386e42d4afa8774ec5ca8c62/612f7/cv_3.png 773w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> StratifiedKFold\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">from</span> xgboost <span class=\"token keyword\">import</span> XGBClassifier\n\n<span class=\"token comment\"># 5개의 Fold</span>\nSkfold <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># cv(split)별 정확도</span>\ncv_accuracy <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\nxgbclf <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 반복 횟수</span>\nn <span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> test_index <span class=\"token keyword\">in</span> Skfold<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    X_train<span class=\"token punctuation\">,</span> X_test<span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span>y<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    \n    <span class=\"token comment\"># ML 학습 및 예측</span>\n    xgbclf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n    xgb_pred <span class=\"token operator\">=</span> xgbclf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n    \n    n <span class=\"token operator\">+=</span><span class=\"token number\">1</span>\n    <span class=\"token comment\"># 반복할 때마다 정확도 측정</span>\n    acc <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span> xgb_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    train_size <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    test_size <span class=\"token operator\">=</span> X_test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n#{0} 교차 검증 정확도 : {1}, 학습 데이터 크기: {2}, 검증 데이터 크기\" {3}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> acc<span class=\"token punctuation\">,</span> train_size<span class=\"token punctuation\">,</span> test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#{0} 검증 셋 인덱스:{1}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \n    cv_accuracy<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span>\n    \n<span class=\"token comment\"># 개별 iter별 정확도 평균 계산</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n 평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>cv_accuracy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[20:57:18] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#1 교차 검증 정확도 : 0.863, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#1 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:57:19] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#2 교차 검증 정확도 : 0.867, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#2 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:57:20] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#3 교차 검증 정확도 : 0.865, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#3 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:57:20] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#4 교차 검증 정확도 : 0.872, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#4 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n[20:57:21] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n#5 교차 검증 정확도 : 0.866, 학습 데이터 크기: 26048, 검증 데이터 크기\" [   0    1    2 ... 6509 6510 6511]\n#5 검증 셋 인덱스:[   0    1    2 ... 6509 6510 6511]\n\n 평균 검증 정확도: 0.867</code></pre></div>\n<h4 id=\"cross_val_score\" style=\"position:relative;\"><a href=\"#cross_val_score\" aria-label=\"cross_val_score permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cross_val_score</h4>\n<p>위의 KFold, StratifiedKFold와 같은 방식도 있지만 더 편하게 할 수 있는 방법이 corss_val_score()를 사용하는 방법</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cross_val_score<span class=\"token punctuation\">(</span>\n    estimator<span class=\"token punctuation\">,</span> <span class=\"token comment\"># 알고리즘 클래스 (clf)</span>\n    X<span class=\"token punctuation\">,</span> <span class=\"token comment\"># features</span>\n    y<span class=\"token punctuation\">,</span> <span class=\"token comment\"># label</span>\n    scoring<span class=\"token punctuation\">,</span> <span class=\"token comment\"># evaluation</span>\n    cv <span class=\"token comment\"># k-fold</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> cross_val_score\n\nscore <span class=\"token operator\">=</span>cross_val_score<span class=\"token punctuation\">(</span>xgbclf<span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> scoring<span class=\"token operator\">=</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n 평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[20:57:35] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n[20:57:36] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n[20:57:36] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n[20:57:37] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n[20:57:38] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n\n 평균 검증 정확도: 0.866</code></pre></div>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p>[1] <a href=\"https://scikit-learn.org/stable/modules/cross_validation.html\">https://scikit-learn.org/stable/modules/cross_validation.html</a></p>","frontmatter":{"date":"September 14, 2022","title":"Cross_Validation","categories":"ML","author":"HwanHee Park","emoji":"📝"},"fields":{"slug":"/ML/[ML] Cross_Validation/"}},"prev":{"id":"849eb3fd-8385-55b6-af45-ca82ffb6acc6","html":"<h2 id=\"svm\" style=\"position:relative;\"><a href=\"#svm\" aria-label=\"svm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVM</h2>\n<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>SVM (Support Vector Machine)은 지도학습 모델 중 하나로 분류 및 회귀 분석에 사용되는 머신 러닝 기법</p>\n<p><img src=\"/65d97514013db4043faee8610b9194ef/svm_1.png\" alt=\"svm_1.PNG\"></p>\n<h3 id=\"주요-용어\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%9A%A9%EC%96%B4\" aria-label=\"주요 용어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 용어</h3>\n<p><img src=\"/0c98c7f17fb14118f1649eac1d3d5562/svm_2.png\" alt=\"svm_2.PNG\"></p>\n<h3 id=\"경계선을-정하는-기준\" style=\"position:relative;\"><a href=\"#%EA%B2%BD%EA%B3%84%EC%84%A0%EC%9D%84-%EC%A0%95%ED%95%98%EB%8A%94-%EA%B8%B0%EC%A4%80\" aria-label=\"경계선을 정하는 기준 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>경계선을 정하는 기준</h3>\n<p>아래 그림처럼 다양한 경계선이 생성될 수 있다. 어떠한 경계선을 선택하는 것이 옳을까?\n<img src=\"/743f9331cc388008dedb5183b3f13bf9/svm_3.png\" alt=\"svm_3.PNG\"></p>\n<p>margin이 크다는 의미는 경계선의 폭이 크다는 의미로 새로운 데이터 값이 들어오는 경우에 margin의 클 수록 더 정확한 분류가 가능</p>\n<h3 id=\"커널-트릭\" style=\"position:relative;\"><a href=\"#%EC%BB%A4%EB%84%90-%ED%8A%B8%EB%A6%AD\" aria-label=\"커널 트릭 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>커널 트릭</h3>\n<p>커널 트릭이란 저차원 -> 고차원 공간으로 매핑하는 작업을 말한다. 아래 그림과 같이 경계선을 생성 불가능 할때 주로 사용.\n<img src=\"/d4392ce275cc5360e861fcfb920389b9/svm_4.png\" alt=\"svm_4.PNG\"></p>\n<h3 id=\"주요-파라미터\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0\" aria-label=\"주요 파라미터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 파라미터</h3>\n<ul>\n<li>C</li>\n</ul>\n<blockquote>\n<p>C는 오분류된 데이터의 허용 정도를 의미하며 이 값이 작을수록 많이 허용하고 높을 수록 적게 허용한다. 이로 인해 C값이 작으면 경계선 모양이 직선에 가까우며 높을 수록 여러겹의 굽은 선에 가깝다.</p>\n</blockquote>\n<ul>\n<li>Gamma</li>\n</ul>\n<blockquote>\n<p>각 데이터가 영향을 주는 정도를 나타내며 Gamma 값이 낮아지면 각 데이터의 영향력이 커져 큰 범위를 형성하는 반면 Gamma 값이 높아지면 각 데이터의 영향력이 적어져 좁은 범위를 형성한다.</p>\n</blockquote>\n<blockquote>\n<p><img src=\"/d672f117b8c19f50c199f1fba85721c4/svm_5.png\" alt=\"svm_5.PNG\"></p>\n</blockquote>\n<p>출처 : <a href=\"https://scikit-learn.org/stable/auto_examples/svm/plot_rbf_parameters.html\">https://scikit-learn.org/stable/auto_examples/svm/plot_rbf_parameters.html</a></p>\n<ul>\n<li>Kernel 함수</li>\n</ul>\n<blockquote>\n<p>커널 함수는 데이터를 필요한 형식으로 변환하는 함수로 SVM에서는 선형, 비선형, RBF, 시그모이드 등의 여러 커널 함수가 사용된다. 주로 사용되는 커널 함수는 RBF(가우스 방사형 기저함수)로 데이터에 대한 사전 지식없이 사용 가능하며 앞서 언급한 Kernel 트릭에서 커널 함수로 매핑한 데이터를 분류하는데 사용.</p>\n</blockquote>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<p>[1] <a href=\"https://www.youtube.com/watch?v=efR1C6CvhmE\">https://www.youtube.com/watch?v=efR1C6CvhmE</a></p>\n<p>[2] <a href=\"https://scikit-learn.org/stable/modules/svm.html\">https://scikit-learn.org/stable/modules/svm.html</a></p>\n<p>[3] <a href=\"https://bskyvision.com/entry/%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0SVM%EC%9D%98-%EC%82%AC%EC%9A%A9%EC%9E%90%EB%A1%9C%EC%84%9C-%EA%BC%AD-%EC%95%8C%EC%95%84%EC%95%BC%ED%95%A0-%EA%B2%83%EB%93%A4-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-C%EC%99%80-gamma\">https://bskyvision.com/entry/%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0SVM%EC%9D%98-%EC%82%AC%EC%9A%A9%EC%9E%90%EB%A1%9C%EC%84%9C-%EA%BC%AD-%EC%95%8C%EC%95%84%EC%95%BC%ED%95%A0-%EA%B2%83%EB%93%A4-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-C%EC%99%80-gamma</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#svm\">SVM</a></p>\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#%EC%A3%BC%EC%9A%94-%EC%9A%A9%EC%96%B4\">주요 용어</a></li>\n<li><a href=\"#%EA%B2%BD%EA%B3%84%EC%84%A0%EC%9D%84-%EC%A0%95%ED%95%98%EB%8A%94-%EA%B8%B0%EC%A4%80\">경계선을 정하는 기준</a></li>\n<li><a href=\"#%EC%BB%A4%EB%84%90-%ED%8A%B8%EB%A6%AD\">커널 트릭</a></li>\n<li><a href=\"#%EC%A3%BC%EC%9A%94-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0\">주요 파라미터</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"September 17, 2022","title":"SVM","categories":"ML","author":"HwanHee Park","emoji":"📝"},"fields":{"slug":"/ML/[ML] SVM/"}},"site":{"siteMetadata":{"siteUrl":"https://han-archives.github.io","comments":{"utterances":{"repo":"Han-Archives/han-archives.github.io"}}}}},"pageContext":{"slug":"/ML/[ML] Naive_Bayes/","nextSlug":"/ML/[ML] Cross_Validation/","prevSlug":"/ML/[ML] SVM/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}